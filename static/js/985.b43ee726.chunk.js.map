{"version":3,"file":"static/js/985.b43ee726.chunk.js","mappings":"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,mBACA,mBACA,mBACA,qBACA,qBACA,sBAEF,GAAI,CACF,iBACA,kBACA,kBACA,mBACA,oBACA,sBAEF,GAAI,CACF,mBACA,mBACA,oBACA,qBACA,qBACA,sBAEF,GAAI,CAAC,kBAAmB,mBAAoB,mBAAoB,mBAAoB,oBACpFD,KAAM,CACJ,kBACA,mBACA,mBACA,mBACA,mBACA,oBAEF,IAAK,CACH,kBACA,mBACA,mBACA,oBACA,qBACA,sBAEFxF,EAAG,CACD,mBACA,oBACA,oBACA,oBACA,qBACA,qBACA,qBACA,sBAEFyF,EAAG,CACD,mBACA,kBACA,mBACA,gBACA,mBACA,oBACA,qBACA,qBACA,qBAEFC,IAAK,CACH,iBACA,kBACA,kBACA,mBACA,oBACA,qBAEF,IAAK,CACH,iBACA,mBACA,mBACA,mBACA,oBACA,qBAEF,IAAK,CACH,kBACA,kBACA,kBACA,mBACA,mBACA,mBACA,qBAEF,KAAM,CACJ,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,oBACA,qBACA,qBACA,sBAEF,KAAM,CACJ,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,qBACA,qBACA,oBACA,sBAEF,OAAQ,CACN,iBACA,kBACA,kBACA,mBACA,oBACA,sBAEFC,GAAI,CACF,mBACA,kBACA,mBACA,gBACA,mBACA,mBACA,oBACA,qBACA,qBACA,qBAEFC,GAAI,CACF,mBACA,oBACA,oBACA,oBACA,qBACA,qBACA,qBACA,sBAEF,KAAM,CACJ,kBACA,mBACA,mBACA,mBACA,kBACA,mBACA,oBACA,qBACA,qBACA,sBAEF,MAAO,CACL,kBACA,mBACA,mBACA,mBACA,kBACA,mBACA,oBACA,qBACA,qBACA,sBAEF,QAAS,CACP,iBACA,mBACA,mBACA,mBACA,oBACA,qBACA,qBACA,sBAEF,QAAS,CACP,iBACA,mBACA,mBACA,mBACA,mBACA,qBACA,sBAEF,OAAQ,CAAC,mBAAoB,mBAAoB,oBAAqB,qBAAsB,sBAC5F,KAAM,CACJ,iBACA,iBACA,mBACA,kBACA,mBACA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","sources":["../node_modules/chord-voicings/src/tokenizeChord.ts","../node_modules/chord-voicings/src/voicingsInRange.ts","../node_modules/@strudel/tonal/dist/index.mjs","../node_modules/chord-voicings/src/getBestVoicing.ts","../node_modules/chord-voicings/src/index.ts","../node_modules/chord-voicings/src/minTopNoteDiff.ts","../node_modules/@tonaljs/pitch-distance/node_modules/@tonaljs/pitch/index.ts","../node_modules/@tonaljs/pitch-distance/node_modules/@tonaljs/pitch-interval/index.ts","../node_modules/@tonaljs/pitch-note/node_modules/@tonaljs/pitch/index.ts","../node_modules/@tonaljs/pitch-note/index.ts","../node_modules/@tonaljs/pitch-distance/index.ts","../node_modules/@tonaljs/abc-notation/index.ts","../node_modules/@tonaljs/array/index.ts","../node_modules/@tonaljs/collection/index.ts","../node_modules/@tonaljs/pcset/node_modules/@tonaljs/pitch/index.ts","../node_modules/@tonaljs/pcset/node_modules/@tonaljs/pitch-interval/index.ts","../node_modules/@tonaljs/pcset/index.ts","../node_modules/@tonaljs/chord-detect/node_modules/@tonaljs/chord-type/data.ts","../node_modules/@tonaljs/chord-detect/node_modules/@tonaljs/chord-type/index.ts","../node_modules/@tonaljs/chord-detect/index.ts","../node_modules/@tonaljs/pitch/index.ts","../node_modules/@tonaljs/pitch-interval/index.ts","../node_modules/@tonaljs/core/node_modules/@tonaljs/pitch-note/index.ts","../node_modules/@tonaljs/core/node_modules/@tonaljs/pitch-distance/index.ts","../node_modules/@tonaljs/core/index.ts","../node_modules/@tonaljs/chord-type/data.ts","../node_modules/@tonaljs/chord-type/index.ts","../node_modules/@tonaljs/scale-type/data.ts","../node_modules/@tonaljs/scale-type/index.ts","../node_modules/@tonaljs/chord/index.ts","../node_modules/@tonaljs/duration-value/index.ts","../node_modules/@tonaljs/duration-value/data.ts","../node_modules/@tonaljs/interval/index.ts","../node_modules/@tonaljs/midi/index.ts","../node_modules/@tonaljs/note/index.ts","../node_modules/@tonaljs/roman-numeral/node_modules/@tonaljs/pitch/index.ts","../node_modules/@tonaljs/roman-numeral/node_modules/@tonaljs/pitch-interval/index.ts","../node_modules/@tonaljs/roman-numeral/index.ts","../node_modules/@tonaljs/key/index.ts","../node_modules/@tonaljs/mode/node_modules/@tonaljs/pitch/index.ts","../node_modules/@tonaljs/mode/node_modules/@tonaljs/pitch-interval/index.ts","../node_modules/@tonaljs/mode/node_modules/@tonaljs/interval/index.ts","../node_modules/@tonaljs/mode/index.ts","../node_modules/@tonaljs/progression/node_modules/@tonaljs/chord-type/data.ts","../node_modules/@tonaljs/progression/node_modules/@tonaljs/chord-type/index.ts","../node_modules/@tonaljs/progression/node_modules/@tonaljs/pitch/index.ts","../node_modules/@tonaljs/progression/node_modules/@tonaljs/pitch-interval/index.ts","../node_modules/@tonaljs/progression/node_modules/@tonaljs/interval/index.ts","../node_modules/@tonaljs/progression/node_modules/@tonaljs/chord/index.ts","../node_modules/@tonaljs/progression/index.ts","../node_modules/@tonaljs/range/index.ts","../node_modules/@tonaljs/scale/node_modules/@tonaljs/chord-type/data.ts","../node_modules/@tonaljs/scale/node_modules/@tonaljs/chord-type/index.ts","../node_modules/@tonaljs/scale/index.ts","../node_modules/@tonaljs/time-signature/index.ts","../node_modules/@tonaljs/tonal/index.ts","../node_modules/chord-voicings/src/dictionaryVoicing.ts"],"sourcesContent":["export function tokenizeChord(chord) {\n  const match = (chord || '').match(/^([A-G][b#]*)([^\\/]*)[\\/]?([A-G][b#]*)?$/);\n  if (!match) {\n    // console.warn('could not tokenize chord', chord);\n    return [];\n  }\n  return match.slice(1);\n}","import { Chord, Interval, Note, Range } from '@tonaljs/tonal';\nimport { lefthand } from './dictionaryVoicing';\nimport { tokenizeChord } from './tokenizeChord';\nimport { NoteRange } from './types';\n\nexport function voicingsInRange(chord, dictionary = lefthand, range: NoteRange = ['D3', 'A4']): string[][] {\n  const [tonic, symbol] = tokenizeChord(chord);\n  if (!dictionary[symbol]) {\n    return [];\n  }\n  // resolve array of interval arrays for the wanted symbol\n  const voicings = dictionary[symbol].map((intervals) => intervals.split(' '));\n  const notesInRange = Range.chromatic(range); // gives array of notes inside range\n  return voicings.reduce((voiced: string[][], voicing: string[]) => {\n    // transpose intervals relative to first interval (e.g. 3m 5P > 1P 3M)\n    const relativeIntervals = voicing.map((interval) => Interval.substract(interval, voicing[0]));\n    // get enharmonic correct pitch class the bottom note\n    const bottomPitchClass = Note.transpose(tonic, voicing[0]);\n    // get all possible start notes for voicing\n    const starts = notesInRange\n      // only get the start notes:\n      .filter((note) => Note.chroma(note) === Note.chroma(bottomPitchClass))\n      // filter out start notes that will overshoot the top end of the range\n      .filter(\n        (note) =>\n          Note.midi(Note.transpose(note, relativeIntervals[relativeIntervals.length - 1])) <= Note.midi(range[1])\n      )\n      // replace Range.chromatic notes with the correct enharmonic equivalents\n      .map((note) => Note.enharmonic(note, bottomPitchClass));\n    // render one voicing for each start note\n    const notes = starts.map((start) => relativeIntervals.map((interval) => Note.transpose(start, interval)));\n    return voiced.concat(notes);\n  }, []);\n}\n","import { Scale as w, Interval as y, Note as f } from \"@tonaljs/tonal\";\nimport { _mod as b, noteToMidi as _, register as p, isNote as T, logger as V, pure as B, silence as v, stack as R } from \"@strudel/core\";\nimport H from \"chord-voicings\";\nconst X = [\"C\", \"Db\", \"D\", \"Eb\", \"E\", \"F\", \"Gb\", \"G\", \"Ab\", \"A\", \"Bb\", \"B\"], Y = [\"c\", \"db\", \"d\", \"eb\", \"e\", \"f\", \"gb\", \"g\", \"ab\", \"a\", \"bb\", \"b\"], Z = [\"C\", \"C#\", \"D\", \"D#\", \"E\", \"F\", \"F#\", \"G\", \"G#\", \"A\", \"A#\", \"B\"], m1 = { b: -1, \"#\": 1 }, M1 = (m) => {\n  const [P, ...M] = m.split(\"\");\n  return Y.indexOf(P.toLowerCase()) + M.reduce((e, t) => e + m1[t], 0);\n};\nfunction P1(m) {\n  const P = (m || \"\").match(/^([A-G][b#]*)([^/]*)[/]?([A-G][b#]*)?$/);\n  return P ? P.slice(1) : [];\n}\nconst j = (m) => m % 12, S = (m) => {\n  let P = Number(m);\n  return isNaN(P) ? y.semitones(m) : P;\n}, I = (m, P) => {\n  if (typeof m == \"number\")\n    return m;\n  if (typeof m == \"string\")\n    return _(m, P);\n}, t1 = (m, P = !1) => {\n  const M = Math.floor(m / 12) - 1;\n  return (P ? Z : X)[m % 12] + M;\n};\nfunction e1(m, P, M = 1) {\n  m = m.map((t) => typeof t == \"string\" ? _(t) : t);\n  const e = Math.floor(P / m.length) * M * 12;\n  return P = b(P, m.length), m[P] + e;\n}\nfunction n1(m, P, M) {\n  let e = 0, t = 1 / 0;\n  return P.forEach((n, d) => {\n    const o = Math.abs(n - m);\n    (o < t || M) && (e = d, t = o);\n  }), e;\n}\nlet k = {};\nfunction o1(m, P, M, e) {\n  let [t, n] = w.tokenize(P);\n  const d = I(t), o = j(d);\n  if (!k[n]) {\n    let { intervals: s } = w.get(`C ${n}`);\n    k[n] = s.map(S);\n  }\n  const r = k[n];\n  if (!r)\n    return null;\n  let i = d;\n  if (M) {\n    M = I(M, 3);\n    const s = j(M), l = b(s - o, 12), $ = n1(l, r, e);\n    m = m + $, i = M - l;\n  }\n  const c = Math.floor(m / r.length) * 12;\n  return m = b(m, r.length), r[m] + i + c;\n}\nlet J = {\n  below: (m) => m.slice(-1)[0],\n  duck: (m) => m.slice(-1)[0],\n  above: (m) => m[0],\n  root: (m) => m[0]\n};\nfunction d1({ chord: m, dictionary: P, offset: M = 0, n: e, mode: t = \"below\", anchor: n = \"c5\", octaves: d = 1 }) {\n  const [o, r] = P1(m), i = M1(o);\n  n = I(n?.note || n, 4);\n  const c = j(n), a = P[r].map(\n    (u) => (typeof u == \"string\" ? u.split(\" \") : u).map(S)\n  );\n  let s, l, $ = a.map((u, D) => {\n    const U = J[t](u), E = b(c - U - i, 12);\n    return (s === void 0 || E < s) && (s = E, l = D), E;\n  });\n  t === \"root\" && (l = 0);\n  const q = Math.ceil(M / a.length) * 12, G = b(l + M, a.length), F = a[G], K = J[t](F), Q = n - $[G] + q, z = F.map((u) => Q - K + u);\n  let N = z.map((u) => t1(u));\n  return t === \"duck\" && (N = N.filter((u, D) => z[D] !== n)), e !== void 0 ? [e1(N, e, d)] : N;\n}\nconst r1 = (m) => (m <= 0 ? -1 : 1) + m * 7 + \"P\";\nfunction s1(m, P) {\n  P = P.replaceAll(\":\", \" \"), m = Math.ceil(m);\n  let { intervals: M, tonic: e, empty: t } = w.get(P);\n  if (t && T(P) || t && !e)\n    throw new Error('incomplete scale. Make sure to use \":\" instead of spaces, example: .scale(\"C:major\")');\n  if (t)\n    throw new Error(`invalid scale \"${P}\"`);\n  e = e || \"C\";\n  const { pc: n, oct: d = 3 } = f.get(e), o = Math.floor(m / M.length), r = b(m, M.length), i = y.add(M[r], r1(o));\n  return f.transpose(n + d, i);\n}\nfunction O(m, P, M) {\n  let [e, t] = w.tokenize(m), { notes: n } = w.get(`${e} ${t}`);\n  if (n = n.map((l) => f.get(l).pc), P = Number(P), isNaN(P))\n    throw new Error(`scale offset \"${P}\" not a number`);\n  const { pc: d, oct: o = 3 } = f.get(M), r = n.indexOf(d);\n  if (r === -1)\n    throw new Error(`note \"${M}\" is not in scale \"${m}\"`);\n  let i = r, c = o, a = d;\n  const s = Math.sign(P);\n  for (; Math.abs(i - r) < Math.abs(P); ) {\n    i += s;\n    const l = b(i, n.length);\n    s < 0 && a[0] === \"C\" && (c += s), a = n[l], s > 0 && a[0] === \"C\" && (c += s);\n  }\n  return a + c;\n}\nconst { transpose: A1, trans: N1 } = p([\"transpose\", \"trans\"], function(P, M) {\n  return M.withHap((e) => {\n    const t = e.value.note ?? e.value;\n    if (typeof t == \"number\") {\n      let o;\n      typeof P == \"number\" ? o = P : typeof P == \"string\" && (o = y.semitones(P) || 0);\n      const r = t + o;\n      return typeof e.value == \"object\" ? e.withValue(() => ({ ...e.value, note: r })) : e.withValue(() => r);\n    }\n    if (typeof t != \"string\" || !T(t))\n      return V(`[tonal] transpose: not a note \"${t}\"`, \"warning\"), e;\n    const n = isNaN(Number(P)) ? String(P) : y.fromSemitones(P), d = f.simplify(f.transpose(t, n));\n    return typeof e.value == \"object\" ? e.withValue(() => ({ ...e.value, note: d })) : e.withValue(() => d);\n  });\n}), { scaleTranspose: x1, scaleTrans: C1, strans: V1 } = p(\n  [\"scaleTranspose\", \"scaleTrans\", \"strans\"],\n  function(m, P) {\n    return P.withHap((M) => {\n      if (!M.context.scale)\n        throw new Error(\"can only use scaleTranspose after .scale\");\n      if (typeof M.value == \"object\")\n        return M.withValue(() => ({\n          ...M.value,\n          note: O(M.context.scale, Number(m), M.value.note)\n        }));\n      if (typeof M.value != \"string\")\n        throw new Error(\"can only use scaleTranspose with notes\");\n      return M.withValue(() => O(M.context.scale, Number(m), M.value));\n    });\n  }\n), $1 = p(\n  \"scale\",\n  function(m, P) {\n    return Array.isArray(m) && (m = m.flat().join(\" \")), P.fmap((M) => {\n      const e = typeof M == \"object\";\n      let t = e ? M.n : M;\n      if (e && delete M.n, T(t))\n        return B(t);\n      let n = Number(t), d = 0;\n      if (isNaN(n)) {\n        if (t = String(t), !/^[-+]?\\d+(#*|b*){1}$/.test(t))\n          return V(\n            `[tonal] invalid scale step \"${t}\", expected number or integer with optional # b suffixes`,\n            \"error\"\n          ), v;\n        const o = t.indexOf(\"#\");\n        if (o >= 0)\n          n = Number(t.substring(0, o)), d = t.length - o;\n        else {\n          const r = t.indexOf(\"b\");\n          n = Number(t.substring(0, r)), d = r - t.length;\n        }\n      }\n      try {\n        let o;\n        e && M.anchor ? o = o1(n, m, M.anchor) : o = s1(n, m), d != 0 && (o = f.transpose(o, y.fromSemitones(d))), M = B(e ? { ...M, note: o } : o);\n      } catch (o) {\n        V(`[tonal] ${o.message}`, \"error\"), M = v;\n      }\n      return M;\n    }).outerJoin().withHap((M) => M.setContext({ ...M.context, scale: m }));\n  },\n  !0,\n  !0\n  // preserve step count\n), g = {\n  2: [\"1P 5P 8P 9M\", \"1P 5P 8P 9M 12P\", \"5P 8P 9M 12P\"],\n  5: [\"1P 5P 8P 12P\", \"5P 8P 12P 15P\"],\n  6: [\"1P 5P 6M 8P 10M\", \"1P 5P 8P 10M 13M\", \"3M 5P 8P 10M 13M\", \"5P 8P 10M 12P 13M\"],\n  7: [\n    \"1P 5P 7m 8P 10M\",\n    \"1P 7m 8P 10M 12P\",\n    \"3M 7m 8P 10M 12P\",\n    \"3M 7m 8P 10M 14m\",\n    \"3M 7m 10M 12P 15P\",\n    \"7m 10M 12P 14m 15P\",\n    \"7m 10M 12P 15P 17M\"\n  ],\n  9: [\n    \"1P 5P 7m 9M 10M\",\n    \"1P 7m 9M 10M 12P\",\n    \"3M 7m 8P 9M 12P\",\n    \"7m 9M 10M 14m 15P\",\n    \"3M 7m 8P 12P 16M\",\n    \"7m 10M 12P 15P 16M\"\n  ],\n  11: [\"1P 5P 7m 9M 11P\", \"5P 7m 8P 9M 11P\", \"7m 8P 9M 11P 12P\", \"7m 8P 11P 12P 16M\"],\n  13: [\"1P 6M 7m 9M 10M\", \"1P 7m 9M 10M 13M\", \"3M 7m 8P 9M 13M\", \"7m 8P 9M 10M 13M\", \"7m 9M 10M 13M 15P\"],\n  69: [\"1P 5P 6M 9M 10M\", \"1P 5P 9M 10M 13M\", \"3M 5P 8P 9M 13M\", \"5P 8P 9M 10M 13M\"],\n  add9: [\"1P 5P 8P 9M 10M\", \"1P 5P 9M 10M 12P\", \"3M 8P 9M 10M 12P\", \"3M 8P 9M 12P 15P\", \"5P 8P 9M 12P 17M\"],\n  \"+\": [\n    \"1P 3M 6m 8P 10M\",\n    \"1P 6m 8P 10M 13m\",\n    \"3M 6m 8P 10M 13m\",\n    \"3M 8P 10M 13m 15P\",\n    \"6m 8P 10M 13m 15P\",\n    \"6m 10M 13m 15P 17M\"\n  ],\n  o: [\"1P 5d 8P 10m 12d\", \"3m 8P 10m 12d 15P\", \"5d 8P 10m 12d 15P\"],\n  h: [\n    \"3m 5d 7m 8P 10m\",\n    \"1P 5d 7m 10m 12d\",\n    \"3m 7m 8P 10m 12d\",\n    \"3m 7m 8P 12d 14m\",\n    \"5d 7m 8P 10m 14m\",\n    \"5d 8P 10m 12d 14m\",\n    \"7m 10m 12d 14m 15P\",\n    \"5d 8P 10m 14m 17m\"\n  ],\n  sus: [\"1P 4P 5P 8P\", \"1P 4P 5P 8P 11P\", \"5P 8P 11P 12P\", \"5P 8P 11P 12P 15P\"],\n  \"^\": [\"1P 5P 8P 10M\", \"1P 5P 8P 10M 12P\", \"3M 5P 8P 10M 12P\", \"3M 8P 10M 12P 15P\", \"5P 8P 10M 12P 15P\"],\n  \"-\": [\"1P 3m 5P 8P 10m\", \"1P 5P 8P 10m 12P\", \"3m 5P 8P 10m 12P\", \"5P 8P 10m 12P 15P\"],\n  \"^7\": [\"1P 5P 7M 10M 12P\", \"1P 10M 12P 14M\", \"3M 8P 10M 12P 14M\", \"5P 8P 10M 12P 14M\", \"5P 8P 10M 14M 17M\"],\n  \"-7\": [\n    \"1P 3m 5P 7m 10m\",\n    \"1P 5P 7m 10m 12P\",\n    \"3m 7m 8P 10m 12P\",\n    \"3m 7m 8P 10m 14m\",\n    \"5P 7m 8P 10m 14m\",\n    \"7m 10m 12P 14m 15P\",\n    \"5P 8P 10m 14m 17m\",\n    \"7m 10m 12P 15P 17m\"\n  ],\n  \"7sus\": [\"1P 5P 7m 8P 11P\", \"5P 8P 11P 12P 14m\", \"7m 8P 11P 12P 14m\", \"7m 11P 12P 14m 18P\"],\n  h7: [\n    \"3m 5d 7m 8P 10m\",\n    \"1P 5d 7m 10m 12d\",\n    \"1P 7m 10m 12d\",\n    \"3m 7m 8P 10m 12d\",\n    \"3m 7m 8P 12d 14m\",\n    \"5d 7m 8P 10m 14m\",\n    \"5d 8P 10m 12d 14m\",\n    \"7m 10m 12d 14m 15P\",\n    \"5d 8P 10m 14m 17m\"\n  ],\n  o7: [\n    \"1P 6M 8P 10m 12d\",\n    \"1P 6M 10m 12d 13M\",\n    \"3m 8P 10m 12d 13M\",\n    \"3m 8P 12d 13M 15P\",\n    \"5d 10m 12d 13M 15P\",\n    \"5d 10m 13M 15P 17m\",\n    \"6M 12d 13M 15P 17m\",\n    \"6M 12d 15P 17m 19d\"\n  ],\n  \"^9\": [\n    \"1P 5P 7M 9M 10M\",\n    \"1P 7M 9M 10M 12P\",\n    \"3M 7M 8P 9M 12P\",\n    \"3M 7M 8P 12P 16M\",\n    \"5P 8P 10M 14M 16M\",\n    \"7M 8P 10M 12P 16M\"\n  ],\n  \"^13\": [\"1P 6M 7M 9M 10M\", \"1P 7M 9M 10M 13M\", \"3M 7M 8P 9M 13M\", \"3M 7M 8P 13M 16M\", \"7M 8P 10M 13M 16M\"],\n  \"^7#11\": [\"1P 5P 7M 10M 12d\", \"3M 7M 8P 10M 12d\", \"1P 7M 10M 12d 14M\", \"3M 7M 8P 12d 14M\", \"5P 8P 10M 12d 14M\"],\n  \"^9#11\": [\"1P 3M 5d 7M 9M\", \"1P 7M 9M 10M 12d\", \"3M 7M 8P 9M 12d\", \"3M 8P 9M 12d 14M\"],\n  \"^7#5\": [\"1P 6m 7M 10M 13m\", \"3M 7M 8P 10M 13m\", \"6m 7M 8P 10M 13m\"],\n  \"-6\": [\n    \"1P 3m 5P 6M 8P\",\n    \"1P 5P 6M 8P 10m\",\n    \"3m 5P 6M 8P 10m\",\n    \"1P 5P 8P 10m 13M\",\n    \"3m 5P 8P 10m 13M\",\n    \"5P 8P 10m 12P 13M\",\n    \"5P 8P 10m 13M 15P\"\n  ],\n  \"-69\": [\n    \"1P 3m 5P 6M 9M\",\n    \"3m 5P 6M 8P 9M\",\n    \"3m 6M 9M 10m 12P\",\n    \"1P 5P 9M 10m 13M\",\n    \"3m 5P 8P 9M 13M\",\n    \"5P 8P 9M 10m 13M\",\n    \"5P 8P 10m 13M 16M\"\n  ],\n  \"-^7\": [\"1P 3m 5P 7M 10m\", \"1P 5P 7M 10m 12P\", \"3m 7M 8P 10m 12P\", \"5P 7M 8P 10m 14M\", \"5P 8P 10m 14M 17m\"],\n  \"-^9\": [\"1P 3m 5P 7M 9M\", \"1P 7M 9M 10m 12P\", \"3m 7M 8P 9M 12P\", \"5P 8P 9M 10m 14M\"],\n  \"-9\": [\n    \"1P 3m 5P 7m 9M\",\n    \"3m 5P 7m 8P 9M\",\n    \"3m 7m 8P 9M 12P\",\n    \"5P 8P 9M 10m 14m\",\n    \"3m 7m 9M 12P 15P\",\n    \"7m 10m 12P 15P 16M\"\n  ],\n  \"-add9\": [\"1P 2M 3m 5P 8P\", \"1P 3m 5P 9M\", \"3m 5P 8P 9M 12P\", \"5P 8P 9M 10m 12P\"],\n  \"-11\": [\n    \"1P 3m 7m 9M 11P\",\n    \"3m 7m 8P 9M 11P\",\n    \"1P 4P 7m 10m 12P\",\n    \"5P 8P 11P 14m\",\n    \"3m 7m 9M 11P 15P\",\n    \"5P 8P 11P 14m 16M\",\n    \"7m 10m 12P 15P 18P\"\n  ],\n  \"-7b5\": [\n    \"3m 5d 7m 8P 10m\",\n    \"1P 7m 10m 12d\",\n    \"1P 5d 7m 10m 12d\",\n    \"3m 7m 8P 10m 12d\",\n    \"3m 7m 8P 12d 14m\",\n    \"5d 7m 8P 10m 14m\",\n    \"5d 8P 10m 12d 14m\",\n    \"7m 10m 12d 14m 15P\",\n    \"5d 8P 10m 14m 17m\"\n  ],\n  h9: [\"1P 7m 9M 10m 12d\", \"3m 7m 8P 9M 12d\", \"5d 8P 9M 10m 14m\", \"7m 10m 12d 15P 16M\"],\n  \"-b6\": [\"1P 5P 6m 8P 10m\", \"1P 5P 8P 10m 13m\", \"3m 5P 8P 10m 13m\", \"5P 8P 10m 13m\", \"5P 8P 10m 13m 15P\"],\n  \"-#5\": [\"1P 6m 8P 10m 13m\", \"3m 6m 8P 10m 13m\", \"6m 8P 10m 13m 15P\"],\n  \"7b9\": [\"1P 3M 7m 9m 10M\", \"3M 7m 8P 9m 10M\", \"3M 7m 8P 9m 14m\", \"7m 9m 10M 14m 15P\"],\n  \"7#9\": [\"1P 3M 7m 10m\", \"3M 7m 8P 10m 14m\", \"7m 10m 10M 14m 15P\"],\n  \"7#11\": [\"1P 3M 7m 10M 12d\", \"3M 7m 8P 10M 12d\", \"7m 10M 12d 14m 15P\"],\n  \"7b5\": [\"1P 3M 7m 10M 12d\", \"3M 7m 8P 10M 12d\", \"7m 10M 12d 14m 15P\"],\n  \"7#5\": [\"1P 3M 7m 10M 13m\", \"3M 7m 8P 10M 13m\", \"3M 7m 8P 13m 14m\", \"7m 10M 13m 14m 15P\"],\n  \"9#11\": [\"1P 7m 9M 10M 12d\", \"3M 7m 8P 9M 12d\", \"7m 10M 12d 15P 16M\"],\n  \"9b5\": [\"1P 7m 9M 10M 12d\", \"3M 7m 8P 9M 12d\", \"7m 10M 12d 15P 16M\"],\n  \"9#5\": [\"1P 7m 9M 10M 13m\", \"3M 7m 9M 10M 13m\", \"3M 7m 9M 13m 14m\", \"7m 10M 13m 14m 16M\", \"7m 10M 13m 16M 17M\"],\n  \"7b13\": [\"1P 3M 7m 10M 13m\", \"3M 7m 8P 10M 13m\", \"3M 7m 8P 13m 14m\", \"7m 10M 13m 14m 15P\"],\n  \"7#9#5\": [\"1P 3M 7m 10m 13m\", \"3M 7m 10m 13m 15P\", \"7m 10M 13m 15P 17m\"],\n  \"7#9b5\": [\"1P 3M 7m 10m 12d\", \"3M 7m 10m 12d 15P\", \"7m 10M 12d 15P 17m\"],\n  \"7#9#11\": [\"1P 3M 7m 10m 12d\", \"3M 7m 10m 12d 15P\", \"7m 10M 12d 15P 17m\"],\n  \"7b9#11\": [\"1P 7m 9m 10M 12d\", \"3M 7m 8P 9m 12d\", \"7m 8P 10M 12d 16m\"],\n  \"7b9b5\": [\"1P 7m 9m 10M 12d\", \"3M 7m 8P 9m 12d\", \"7m 8P 10M 12d 16m\"],\n  \"7b9#5\": [\"1P 7m 9m 10M 13m\", \"3M 7m 8P 9m 13m\", \"7m 9m 10M 13m 15P\"],\n  \"7b9#9\": [\"1P 3M 7m 9m 10m\", \"3M 7m 8P 9m 10m\", \"7m 8P 10M 16m 17m\"],\n  \"7b9b13\": [\"1P 7m 9m 10M 13m\", \"3M 7m 8P 9m 13m\", \"7m 9m 10M 13m 15P\"],\n  \"7alt\": [\n    \"3M 7m 8P 9m 12d\",\n    \"1P 7m 10m 10M 13m\",\n    \"3M 7m 8P 10m 13m\",\n    \"3M 7m 9m 12d 15P\",\n    \"3M 7m 10m 13m 15P\",\n    \"7m 10M 12d 15P 17m\",\n    \"7m 10M 13m 15P 17m\"\n  ],\n  \"13#11\": [\"1P 6M 7m 10M 12d\", \"3M 7m 9M 12d 13M\", \"7m 10M 12d 13M 16M\"],\n  \"13b9\": [\"1P 3M 6M 7m 9m\", \"1P 6M 7m 9m 10M\", \"3M 7m 9m 10M 13M\", \"3M 7m 10M 13M 16m\", \"7m 10M 13M 16m 17M\"],\n  \"13#9\": [\"1P 3M 6M 7m 10m\", \"3M 7m 8P 10m 13M\", \"7m 10M 13M 14m 17m\"],\n  \"7b9sus\": [\"1P 5P 7m 9m 11P\", \"5P 7m 8P 9m 11P\", \"7m 8P 11P 14m 16m\"],\n  \"7susadd3\": [\"1P 4P 5P 7m 10M\", \"5P 8P 10M 11P 14m\", \"7m 11P 12P 15P 17M\"],\n  \"9sus\": [\"1P 5P 7m 9M 11P\", \"5P 7m 8P 9M 11P\", \"7m 8P 9M 11P 12P\", \"7m 8P 11P 12P 16M\"],\n  \"13sus\": [\"1P 4P 6M 7m 9M\", \"1P 7m 9M 11P 13M\", \"5P 7m 9M 11P 13M\", \"7m 9M 11P 13M 15P\"],\n  \"7b13sus\": [\"1P 5P 7m 11P 13m\", \"5P 7m 8P 11P 13m\", \"7m 11P 13m 14m 15P\"]\n}, h = {\n  2: [\"1P 5P 6M 8P 9M\", \"1P 5P 8P 9M 12P\", \"5P 8P 9M 12P 13M\", \"5P 8P 9M 12P 15P\"],\n  5: [\"1P 5P 8P 12P\", \"1P 5P 8P 9M 12P\", \"5P 8P 12P 15P\", \"5P 8P 12P 15P 16M\"],\n  6: [\"1P 5P 6M 9M 10M\", \"1P 5P 9M 10M 13M\", \"3M 5P 9M 10M 13M\", \"5P 8P 9M 10M 13M\", \"3M 6M 9M 12P 15P\"],\n  7: [\n    \"1P 5P 7m 8P 10M\",\n    \"1P 7m 8P 10M 12P\",\n    \"3M 7m 8P 10M 12P\",\n    \"3M 7m 8P 10M 14m\",\n    \"3M 7m 10M 12P 15P\",\n    \"7m 10M 12P 14m 15P\",\n    \"7m 10M 12P 15P 17M\",\n    \"7m 10M 14m 17M 19P\"\n  ],\n  9: [\n    \"1P 6M 7m 9M 10M\",\n    \"3M 7m 9M 10M 12P\",\n    \"1P 7m 9M 10M 13M\",\n    \"3M 7m 9M 10M 13M\",\n    \"3M 7m 9M 12P 15P\",\n    \"7m 10M 12P 13M 16M\",\n    \"7m 10M 13M 16M 17M\",\n    \"7m 10M 13M 16M 19P\"\n  ],\n  11: [\n    \"1P 4P 6M 7m 9M\",\n    \"1P 5P 7m 9M 11P\",\n    \"4P 6M 7m 9M 11P\",\n    \"5P 8P 9M 11P 14m\",\n    \"7m 9M 11P 13M 15P\",\n    \"7m 11P 12P 14m 18P\"\n  ],\n  13: [\n    \"3M 7m 9M 10M 13M\",\n    \"3M 7m 9M 13M 15P\",\n    \"3M 7m 10M 13M 16M\",\n    \"7m 10M 12P 13M 16M\",\n    \"7m 10M 13M 16M 17M\",\n    \"7m 10M 13M 16M 19P\"\n  ],\n  69: [\"1P 5P 6M 9M 10M\", \"1P 5P 9M 10M 13M\", \"3M 5P 9M 10M 13M\", \"5P 8P 9M 10M 13M\", \"3M 6M 9M 12P 15P\"],\n  add9: [\n    \"1P 5P 8P 9M 10M\",\n    \"1P 5P 9M 10M 12P\",\n    \"3M 8P 9M 10M 12P\",\n    \"3M 8P 9M 12P 15P\",\n    \"5P 8P 9M 10M 15P\",\n    \"5P 8P 9M 12P 17M\"\n  ],\n  \"+\": [\n    \"1P 6m 8P 9M 10M\",\n    \"1P 6m 8P 10M 13m\",\n    \"3M 8P 9M 10M 13m\",\n    \"3M 8P 10M 13m 15P\",\n    \"6m 10M 13m 15P 16M\",\n    \"6m 10M 13m 15P 17M\"\n  ],\n  o: [\n    \"1P 6M 8P 10m 12d\",\n    \"1P 6M 10m 12d 13M\",\n    \"3m 8P 10m 12d 13M\",\n    \"3m 8P 12d 13M 15P\",\n    \"5d 10m 12d 13M 15P\",\n    \"5d 10m 13M 15P 17m\",\n    \"6M 12d 13M 15P 17m\",\n    \"6M 12d 15P 17m 19d\"\n  ],\n  h: [\n    \"1P 5d 7m 10m 11P\",\n    \"3m 5d 7m 8P 11P\",\n    \"5d 7m 8P 10m 11P\",\n    \"1P 7m 10m 12d\",\n    \"3m 7m 8P 12d 14m\",\n    \"5d 8P 10m 11P 14m\",\n    \"7m 10m 11P 12d 14m\",\n    \"7m 10m 12d 14m 15P\",\n    \"5d 8P 10m 14m 17m\"\n  ],\n  sus: [\n    \"1P 4P 5P 8P 9M\",\n    \"1P 4P 5P 8P 11P\",\n    \"1P 5P 8P 9M 11P\",\n    \"5P 8P 9M 11P 12P\",\n    \"5P 8P 11P 12P 13M\",\n    \"5P 8P 11P 13M 15P\"\n  ],\n  \"^\": [\n    \"1P 3M 5P 6M 9M\",\n    \"1P 5P 8P 10M 12P\",\n    \"3M 5P 9M 10M 12P\",\n    \"1P 5P 8P 10M 13M\",\n    \"3M 8P 10M 13M 15P\",\n    \"5P 9M 10M 12P 15P\"\n  ],\n  \"-\": [\n    \"1P 3m 5P 8P 10m\",\n    \"1P 3m 5P 9M 11P\",\n    \"3m 5P 8P 9M 11P\",\n    \"5P 8P 9M 10m 11P\",\n    \"1P 5P 9M 10m 12P\",\n    \"3m 5P 8P 10m 12P\",\n    \"5P 8P 10m 12P 15P\"\n  ],\n  \"^7\": [\n    \"1P 6M 7M 9M 10M\",\n    \"3M 7M 9M 10M 12P\",\n    \"1P 7M 9M 10M 13M\",\n    \"3M 7M 9M 10M 13M\",\n    \"3M 7M 9M 12P 13M\",\n    \"3M 7M 9M 13M 14M\",\n    \"3M 7M 10M 13M 16M\",\n    \"7M 10M 13M 14M 16M\",\n    \"7M 10M 13M 16M 17M\",\n    \"7M 10M 13M 16M 19P\"\n  ],\n  \"-7\": [\n    \"1P 3m 5P 7m 9M\",\n    \"1P 3m 5P 7m 10m\",\n    \"1P 5P 7m 10m 11P\",\n    \"3m 7m 8P 10m 11P\",\n    \"1P 5P 7m 10m 12P\",\n    \"3m 7m 9M 10m 12P\",\n    \"3m 7m 8P 10m 14m\",\n    \"5P 7m 9M 10m 14m\",\n    \"7m 10m 11P 14m 15P\",\n    \"7m 10m 12P 15P 16M\",\n    \"5P 8P 11P 14m 17m\",\n    \"7m 10m 12P 15P 17m\"\n  ],\n  \"7sus\": [\n    \"1P 4P 6M 7m 9M\",\n    \"1P 5P 7m 9M 11P\",\n    \"4P 6M 7m 9M 11P\",\n    \"5P 8P 9M 11P 14m\",\n    \"7m 9M 11P 13M 15P\",\n    \"7m 11P 12P 14m 18P\"\n  ],\n  h7: [\n    \"1P 5d 7m 10m 11P\",\n    \"3m 5d 7m 8P 11P\",\n    \"5d 7m 8P 10m 11P\",\n    \"1P 7m 10m 12d\",\n    \"3m 7m 8P 10m 12d\",\n    \"3m 7m 8P 12d 14m\",\n    \"5d 8P 10m 11P 14m\",\n    \"7m 10m 11P 12d 14m\",\n    \"7m 10m 12d 14m 15P\",\n    \"5d 8P 10m 14m 17m\"\n  ],\n  o7: [\n    \"1P 6M 8P 10m 12d\",\n    \"1P 6M 10m 12d 13M\",\n    \"3m 8P 10m 12d 13M\",\n    \"3m 8P 12d 13M 15P\",\n    \"5d 10m 12d 13M 15P\",\n    \"5d 10m 13M 15P 17m\",\n    \"6M 12d 13M 15P 17m\",\n    \"6M 12d 15P 17m 19d\"\n  ],\n  \"^9\": [\n    \"1P 6M 7M 9M 10M\",\n    \"1P 7M 9M 10M 13M\",\n    \"3M 7M 9M 10M 13M\",\n    \"3M 7M 9M 12P 13M\",\n    \"3M 7M 8P 9M 13M\",\n    \"3M 7M 9M 13M 14M\",\n    \"3M 7M 10M 13M 16M\",\n    \"7M 10M 13M 14M 16M\",\n    \"7M 10M 13M 16M 17M\",\n    \"7M 10M 13M 16M 19P\"\n  ],\n  \"^13\": [\n    \"1P 6M 7M 9M 10M\",\n    \"1P 7M 9M 10M 13M\",\n    \"3M 7M 9M 12P 13M\",\n    \"3M 7M 9M 10M 13M\",\n    \"3M 7M 8P 9M 13M\",\n    \"3M 7M 9M 13M 14M\",\n    \"3M 7M 10M 13M 16M\",\n    \"7M 10M 13M 14M 16M\",\n    \"7M 10M 13M 16M 17M\",\n    \"7M 10M 13M 16M 19P\"\n  ],\n  \"^7#11\": [\n    \"1P 3M 5d 7M 9M\",\n    \"1P 7M 9M 10M 12d\",\n    \"3M 7M 9M 10M 12d\",\n    \"3M 7M 9M 12d 13M\",\n    \"3M 7M 10M 12d 14M\",\n    \"7M 10M 12d 13M 14M\",\n    \"7M 10M 12d 13M 16M\",\n    \"7M 10M 12d 14M 17M\"\n  ],\n  \"^9#11\": [\n    \"1P 3M 5d 7M 9M\",\n    \"1P 7M 9M 10M 12d\",\n    \"3M 7M 9M 10M 12d\",\n    \"3M 7M 9M 12d 13M\",\n    \"3M 7M 9M 12d 14M\",\n    \"7M 10M 12d 14M 16M\",\n    \"7M 10M 12d 13M 16M\"\n  ],\n  \"^7#5\": [\"1P 6m 7M 10M 13m\", \"3M 7M 9M 10M 13m\", \"3M 7M 10M 13m 14M\", \"7M 10M 13m 14M 16M\", \"7M 10M 13m 14M 17M\"],\n  \"-6\": [\n    \"1P 3m 5P 6M 9M\",\n    \"3m 5P 6M 8P 9M\",\n    \"1P 5P 6M 10m 11P\",\n    \"3m 5P 6M 8P 11P\",\n    \"1P 5P 9M 10m 13M\",\n    \"3m 5P 8P 9M 13M\",\n    \"5P 8P 10m 11P 13M\",\n    \"5P 8P 10m 13M 16M\"\n  ],\n  \"-69\": [\n    \"1P 3m 5P 6M 9M\",\n    \"3m 5P 6M 8P 9M\",\n    \"3m 6M 9M 10m 12P\",\n    \"1P 5P 9M 10m 13M\",\n    \"3m 5P 8P 9M 13M\",\n    \"5P 8P 9M 10m 13M\",\n    \"5P 8P 10m 13M 16M\"\n  ],\n  \"-^7\": [\n    \"1P 3m 5P 7M 9M\",\n    \"1P 5P 7M 10m 11P\",\n    \"3m 7M 9M 10m 11P\",\n    \"3m 7M 9M 10m 12P\",\n    \"3m 7M 9M 12P 14M\",\n    \"7M 10m 11P 12P 14M\",\n    \"7M 10m 12P 14M 16M\"\n  ],\n  \"-^9\": [\n    \"1P 3m 5P 7M 9M\",\n    \"1P 5P 7M 10m 11P\",\n    \"3m 7M 9M 10m 11P\",\n    \"3m 7M 9M 10m 12P\",\n    \"3m 7M 9M 12P 14M\",\n    \"7M 10m 11P 12P 14M\",\n    \"7M 10m 12P 14M 16M\"\n  ],\n  \"-9\": [\n    \"1P 3m 5P 7m 9M\",\n    \"1P 3m 7m 9M 11P\",\n    \"3m 7m 9M 10m 11P\",\n    \"3m 7m 9M 10m 12P\",\n    \"3m 7m 9M 10m 14m\",\n    \"3m 7m 9M 12P 15P\",\n    \"7m 10m 11P 14m 16M\",\n    \"7m 10m 12P 16M 18P\"\n  ],\n  \"-add9\": [\"1P 2M 3m 5P 8P\", \"1P 3m 5P 9M\", \"3m 5P 8P 9M 12P\", \"5P 8P 9M 10m 12P\"],\n  \"-11\": [\n    \"3m 5P 7m 9M 11P\",\n    \"7m 9M 10m 11P\",\n    \"1P 4P 7m 10m 12P\",\n    \"3m 7m 9M 11P 12P\",\n    \"7m 9M 10m 11P 12P\",\n    \"3m 7m 9M 11P 14m\",\n    \"4P 10m 12P 14m\",\n    \"5P 8P 11P 14m\",\n    \"5P 8P 11P 14m 16M\",\n    \"7m 10m 12P 16M 18P\",\n    \"7m 10m 11P 16M 21m\"\n  ],\n  \"-7b5\": [\n    \"1P 5d 7m 10m 11P\",\n    \"3m 5d 7m 8P 11P\",\n    \"5d 7m 8P 10m 11P\",\n    \"1P 7m 10m 12d\",\n    \"3m 7m 8P 10m 12d\",\n    \"3m 7m 8P 12d 14m\",\n    \"5d 8P 10m 11P 14m\",\n    \"7m 10m 11P 12d 14m\",\n    \"7m 10m 12d 14m 15P\",\n    \"5d 8P 10m 14m 17m\"\n  ],\n  h9: [\n    \"3m 5d 7m 9M 11P\",\n    \"1P 7m 9M 10m 12d\",\n    \"3m 7m 9M 12d 14m\",\n    \"5d 8P 9M 10m 14m\",\n    \"7m 10m 11P 12d 14m\",\n    \"7m 10m 12d 14m 16M\"\n  ],\n  \"-b6\": [\"1P 3m 5P 6m 8P\", \"3m 5P 8P 11P 13m\", \"5P 8P 10m 11P 13m\"],\n  \"-#5\": [\"1P 6m 8P 10m 13m\", \"3m 6m 8P 11P 13m\", \"6m 8P 10m 13m 15P\"],\n  \"7b9\": [\"1P 3M 7m 9m 10M\", \"3M 7m 8P 9m 10M\", \"3M 7m 8P 9m 14m\", \"7m 9m 10M 14m 15P\"],\n  \"7#9\": [\"1P 3M 7m 10m\", \"3M 7m 10m 10M 12P\", \"3M 7m 10m 12P 14m\", \"7m 10M 12P 14m 17m\"],\n  \"7#11\": [\"1P 3M 7m 9M 12d\", \"3M 7m 9M 12d 13M\", \"7m 10M 12d 13M 16M\"],\n  \"7b5\": [\"1P 3M 7m 9M 12d\", \"3M 7m 9M 12d 13M\", \"7m 10M 12d 13M 16M\"],\n  \"7#5\": [\"1P 3M 7m 10M 13m\", \"3M 7m 8P 10M 13m\", \"3M 7m 8P 13m 14m\", \"7m 10M 13m 14m 15P\", \"7m 10M 13m 14m 17M\"],\n  \"9#11\": [\"1P 7m 9M 10M 12d\", \"3M 7m 8P 9M 12d\", \"7m 10M 12d 15P 16M\"],\n  \"9b5\": [\"1P 7m 9M 10M 12d\", \"3M 7m 8P 9M 12d\", \"7m 10M 12d 15P 16M\"],\n  \"9#5\": [\"1P 7m 9M 10M 13m\", \"3M 7m 9M 10M 13m\", \"3M 7m 9M 13m 14m\", \"7m 10M 13m 14m 16M\", \"7m 10M 13m 16M 17M\"],\n  \"7b13\": [\"1P 3M 7m 10M 13m\", \"3M 7m 8P 10M 13m\", \"3M 7m 8P 13m 14m\", \"7m 10M 13m 14m 15P\", \"7m 10M 13m 14m 17M\"],\n  \"7#9#5\": [\"3M 7m 10m 10M 13m\", \"3M 7m 10m 13m 14m\", \"7m 10M 13m 14m 17m\"],\n  \"7#9b5\": [\"3M 7m 10m 10M 12d\", \"3M 7m 10m 12d 14m\", \"7m 10M 12d 14m 17m\"],\n  \"7#9#11\": [\"3M 7m 10m 10M 12d\", \"3M 7m 10m 12d 14m\", \"7m 10M 12d 14m 17m\"],\n  \"7b9#11\": [\"3M 7m 9m 10M 12d\", \"3M 7m 9m 12d 14m\", \"7m 8P 10M 12d 16m\", \"7m 10M 12d 14m 16m\"],\n  \"7b9b5\": [\"3M 7m 9m 10M 12d\", \"3M 7m 9m 12d 14m\", \"7m 8P 10M 12d 16m\", \"7m 10M 12d 14m 16m\"],\n  \"7b9#5\": [\"1P 7m 9m 10M 13m\", \"3M 7m 9m 10M 13m\", \"3M 7m 10M 13m 16m\", \"7m 10M 13m 14m 16m\", \"7m 10M 13m 16m 17M\"],\n  \"7b9#9\": [\"1P 3M 7m 9m 10m\", \"3M 7m 10m 13m 16m\", \"7m 10M 13m 16m 17m\"],\n  \"7b9b13\": [\"1P 7m 9m 10M 13m\", \"3M 7m 9m 10M 13m\", \"3M 7m 10M 13m 16m\", \"7m 10M 13m 14m 16m\", \"7m 10M 13m 16m 17M\"],\n  \"7alt\": [\n    \"3M 7m 8P 10m 13m\",\n    \"3M 7m 9m 12d 13m\",\n    \"3M 7m 9m 10m 13m\",\n    \"3M 7m 10m 13m 14m\",\n    \"3M 7m 9m 12d 14m\",\n    \"3M 7m 10m 13m 15P\",\n    \"3M 7m 10m 13m 16m\",\n    \"7m 10M 12d 14m 16m\",\n    \"7m 10M 12d 13m 16m\",\n    \"7m 10M 13m 15P 17m\",\n    \"7m 10M 13m 16m 17m\",\n    \"7m 10M 13m 16m 19d\"\n  ],\n  \"13#11\": [\"3M 7m 9M 12d 13M\", \"7m 10M 12d 13M 16M\"],\n  \"13b9\": [\"3M 7m 9m 10M 13M\", \"3M 7m 10M 13M 16m\", \"7m 10M 13M 16m 17M\"],\n  \"13#9\": [\"3M 7m 10m 10M 13M\", \"7m 10M 13M 14m 17m\"],\n  \"7b9sus\": [\"1P 5P 7m 9m 11P\", \"5P 7m 8P 9m 11P\", \"7m 8P 11P 14m 16m\"],\n  \"7susadd3\": [\"1P 4P 5P 7m 10M\", \"5P 8P 10M 11P 14m\", \"7m 11P 12P 15P 17M\"],\n  \"9sus\": [\n    \"1P 4P 6M 7m 9M\",\n    \"1P 5P 7m 9M 11P\",\n    \"4P 6M 7m 9M 11P\",\n    \"5P 8P 9M 11P 14m\",\n    \"7m 9M 11P 13M 15P\",\n    \"7m 11P 12P 14m 18P\"\n  ],\n  \"13sus\": [\n    \"1P 4P 6M 7m 9M\",\n    \"1P 7m 9M 11P 13M\",\n    \"4P 7m 9M 11P 13M\",\n    \"7m 9M 11P 13M 15P\",\n    \"7m 11P 13M 14m 16M\",\n    \"7m 11P 13M 16M 18P\"\n  ],\n  \"7b13sus\": [\"1P 5P 7m 11P 13m\", \"5P 7m 8P 11P 13m\", \"7m 11P 13m 14m 15P\"]\n}, { dictionaryVoicing: i1, minTopNoteDiff: c1 } = H.default || H, a1 = {\n  m7: [\"3m 5P 7m 9M\", \"7m 9M 10m 12P\"],\n  7: [\"3M 6M 7m 9M\", \"7m 9M 10M 13M\"],\n  \"^7\": [\"3M 5P 7M 9M\", \"7M 9M 10M 12P\"],\n  69: [\"3M 5P 6A 9M\"],\n  m7b5: [\"3m 5d 7m 8P\", \"7m 8P 10m 12d\"],\n  \"7b9\": [\"3M 6m 7m 9m\", \"7m 9m 10M 13m\"],\n  \"7b13\": [\"3M 6m 7m 9m\", \"7m 9m 10M 13m\"],\n  o7: [\"1P 3m 5d 6M\", \"5d 6M 8P 10m\"],\n  \"7#11\": [\"7m 9M 11A 13A\"],\n  \"7#9\": [\"3M 7m 9A\"],\n  mM7: [\"3m 5P 7M 9M\", \"7M 9M 10m 12P\"],\n  m6: [\"3m 5P 6M 9M\", \"6M 9M 10m 12P\"]\n}, l1 = {\n  m7: [\"3m 7m\", \"7m 10m\"],\n  m9: [\"3m 7m\", \"7m 10m\"],\n  7: [\"3M 7m\", \"7m 10M\"],\n  \"^7\": [\"3M 7M\", \"7M 10M\"],\n  \"^9\": [\"3M 7M\", \"7M 10M\"],\n  69: [\"3M 6M\"],\n  6: [\"3M 6M\", \"6M 10M\"],\n  m7b5: [\"3m 7m\", \"7m 10m\"],\n  \"7b9\": [\"3M 7m\", \"7m 10M\"],\n  \"7b13\": [\"3M 7m\", \"7m 10M\"],\n  o7: [\"3m 6M\", \"6M 10m\"],\n  \"7#11\": [\"3M 7m\", \"7m 10M\"],\n  \"7#9\": [\"3M 7m\", \"7m 10M\"],\n  mM7: [\"3m 7M\", \"7M 10m\"],\n  m6: [\"3m 6M\", \"6M 10m\"]\n}, u1 = {\n  \"\": [\"1P 3M 5P\", \"3M 5P 8P\", \"5P 8P 10M\"],\n  M: [\"1P 3M 5P\", \"3M 5P 8P\", \"5P 8P 10M\"],\n  m: [\"1P 3m 5P\", \"3m 5P 8P\", \"5P 8P 10m\"],\n  o: [\"1P 3m 5d\", \"3m 5d 8P\", \"5d 8P 10m\"],\n  aug: [\"1P 3m 5A\", \"3m 5A 8P\", \"5A 8P 10m\"]\n}, f1 = {\n  // triads\n  \"\": [\"1P 3M 5P\", \"3M 5P 8P\", \"5P 8P 10M\"],\n  M: [\"1P 3M 5P\", \"3M 5P 8P\", \"5P 8P 10M\"],\n  m: [\"1P 3m 5P\", \"3m 5P 8P\", \"5P 8P 10m\"],\n  o: [\"1P 3m 5d\", \"3m 5d 8P\", \"5d 8P 10m\"],\n  aug: [\"1P 3m 5A\", \"3m 5A 8P\", \"5A 8P 10m\"],\n  // sevenths chords\n  m7: [\"3m 5P 7m 9M\", \"7m 9M 10m 12P\"],\n  7: [\"3M 6M 7m 9M\", \"7m 9M 10M 13M\"],\n  \"^7\": [\"3M 5P 7M 9M\", \"7M 9M 10M 12P\"],\n  69: [\"3M 5P 6A 9M\"],\n  m7b5: [\"3m 5d 7m 8P\", \"7m 8P 10m 12d\"],\n  \"7b9\": [\"3M 6m 7m 9m\", \"7m 9m 10M 13m\"],\n  \"7b13\": [\"3M 6m 7m 9m\", \"7m 9m 10M 13m\"],\n  o7: [\"1P 3m 5d 6M\", \"5d 6M 8P 10m\"],\n  \"7#11\": [\"7m 9M 11A 13A\"],\n  \"7#9\": [\"3M 7m 9A\"],\n  mM7: [\"3m 5P 7M 9M\", \"7M 9M 10m 12P\"],\n  m6: [\"3m 5P 6M 9M\", \"6M 9M 10m 12P\"]\n}, A = {\n  lefthand: { dictionary: a1, range: [\"F3\", \"A4\"], mode: \"below\", anchor: \"a4\" },\n  triads: { dictionary: u1, mode: \"below\", anchor: \"a4\" },\n  guidetones: { dictionary: l1, mode: \"above\", anchor: \"a4\" },\n  legacy: { dictionary: f1, mode: \"below\", anchor: \"a4\" }\n};\nlet L = \"ireal\";\nconst b1 = (m) => L = m, D1 = (m, P) => g1(m, A[m].dictionary, P), g1 = (m, P, M = [\"F3\", \"A4\"]) => {\n  Object.assign(A, { [m]: { dictionary: P, range: M } });\n}, W = (m, P, M = {}) => {\n  Object.assign(A, { [m]: { dictionary: P, ...M } });\n}, p1 = (m, P, M) => {\n  const { dictionary: e, range: t } = A[P];\n  return i1({\n    chord: m,\n    dictionary: e,\n    range: t,\n    picker: c1,\n    lastVoicing: M\n  });\n};\nlet x;\nconst E1 = p(\"voicings\", function(m, P) {\n  return P.fmap((M) => (x = p1(M, m, x), R(...x))).outerJoin();\n}), k1 = p(\"rootNotes\", function(m, P) {\n  return P.fmap((M) => {\n    const n = (M.chord || M).match(/^([a-gA-G][b#]?).*$/)[1] + m;\n    return M.chord ? { note: n } : n;\n  });\n}), v1 = p(\"voicing\", function(m) {\n  return m.fmap((P) => {\n    P = typeof P == \"string\" ? { chord: P } : P;\n    let { dictionary: M = L, chord: e, anchor: t, offset: n, mode: d, n: o, octaves: r, ...i } = P;\n    M = typeof M == \"string\" ? A[M] : { dictionary: M, mode: \"below\", anchor: \"c5\" };\n    try {\n      let c = d1({ ...M, chord: e, anchor: t, offset: n, mode: d, n: o, octaves: r });\n      return R(...c).note().set(i);\n    } catch {\n      return V(`[voicing]: unknown chord \"${e}\"`), v;\n    }\n  }).outerJoin();\n});\nfunction C(m, P, M) {\n  M = Array.isArray(M) ? M : [M], M.forEach((e) => {\n    e[P] = e[m];\n  });\n}\nC(\"^\", \"\", [g, h]);\nObject.keys(g).forEach((m) => {\n  if (m.includes(\"-\")) {\n    let P = m.replace(\"-\", \"m\");\n    C(m, P, [h, g]);\n  }\n  if (m.includes(\"^\")) {\n    let P = m.replace(\"^\", \"M\");\n    C(m, P, [h, g]);\n  }\n  if (m.includes(\"+\")) {\n    let P = m.replace(\"+\", \"aug\");\n    C(m, P, [h, g]);\n  }\n});\nW(\"ireal\", g);\nW(\"ireal-ext\", h);\nfunction j1() {\n  x = void 0, b1(\"ireal\");\n}\nconst I1 = \"@strudel/tonal\";\nexport {\n  g1 as addVoicings,\n  I1 as packageName,\n  W as registerVoicings,\n  j1 as resetVoicings,\n  k1 as rootNotes,\n  $1 as scale,\n  C1 as scaleTrans,\n  x1 as scaleTranspose,\n  b1 as setDefaultVoicings,\n  D1 as setVoicingRange,\n  V1 as strans,\n  N1 as trans,\n  A1 as transpose,\n  v1 as voicing,\n  C as voicingAlias,\n  A as voicingRegistry,\n  E1 as voicings\n};\n","import { Voicing, VoicingOptions } from './types';\n\nexport function getBestVoicing(voicingOptions: VoicingOptions): Voicing {\n  const { chord, range, finder, picker, lastVoicing } = voicingOptions;\n  let voicings = finder(chord, range);\n  if (!voicings.length) {\n    return [];\n  }\n  return picker(voicings, lastVoicing);\n}\n","import { dictionaryVoicing, dictionaryVoicingFinder, lefthand, guidetones, triads } from './dictionaryVoicing';\nimport { minTopNoteDiff } from './minTopNoteDiff';\nimport { getBestVoicing } from './getBestVoicing';\nimport { tokenizeChord } from './tokenizeChord';\n\nexport default {\n  tokenizeChord,\n  getBestVoicing,\n  dictionaryVoicing,\n  dictionaryVoicingFinder,\n  lefthand,\n  guidetones,\n  triads,\n  minTopNoteDiff,\n};\n","import { Note } from '@tonaljs/tonal';\n\nexport function minTopNoteDiff(voicings, lastVoicing) {\n  if (!lastVoicing) {\n    return voicings[0];\n  }\n  const diff = (voicing) =>\n    Math.abs(Note.midi(lastVoicing[lastVoicing.length - 1]) - Note.midi(voicing[voicing.length - 1]));\n  return voicings.reduce((best, current) => (diff(current) < diff(best) ? current : best), voicings[0]);\n}\n","export interface NamedPitch {\n  readonly name: string;\n}\n\n/*** @deprecated use NamedPitch */\nexport interface Named {\n  readonly name: string;\n}\n\nexport interface NotFound extends NamedPitch {\n  readonly empty: true;\n  readonly name: \"\";\n}\n\nexport function isNamedPitch(src: unknown): src is NamedPitch {\n  return src !== null &&\n    typeof src === \"object\" &&\n    \"name\" in src &&\n    typeof src.name === \"string\"\n    ? true\n    : false;\n}\n\ntype Fifths = number;\ntype Octaves = number;\nexport type Direction = 1 | -1;\n\nexport type PitchClassCoordinates = [Fifths];\nexport type NoteCoordinates = [Fifths, Octaves];\nexport type IntervalCoordinates = [Fifths, Octaves, Direction];\nexport type PitchCoordinates =\n  | PitchClassCoordinates\n  | NoteCoordinates\n  | IntervalCoordinates;\n\n/**\n * Pitch properties\n *\n * - {number} step - The step number: 0 = C, 1 = D, ... 6 = B\n * - {number} alt - Number of alterations: -2 = 'bb', -1 = 'b', 0 = '', 1 = '#', ...\n * - {number} [oct] = The octave (undefined when is a coord class)\n * - {number} [dir] = Interval direction (undefined when is not an interval)\n */\nexport interface Pitch {\n  readonly step: number;\n  readonly alt: number;\n  readonly oct?: number; // undefined for pitch classes\n  readonly dir?: Direction; // undefined for notes\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nexport const chroma = ({ step, alt }: Pitch) => (SIZES[step] + alt + 120) % 12;\n\nexport const height = ({ step, alt, oct, dir = 1 }: Pitch) =>\n  dir * (SIZES[step] + alt + 12 * (oct === undefined ? -100 : oct));\n\nexport const midi = (pitch: Pitch) => {\n  const h = height(pitch);\n  return pitch.oct !== undefined && h >= -12 && h <= 115 ? h + 12 : null;\n};\n\nexport function isPitch(pitch: unknown): pitch is Pitch {\n  return pitch !== null &&\n    typeof pitch === \"object\" &&\n    \"step\" in pitch &&\n    typeof pitch.step === \"number\" &&\n    \"alt\" in pitch &&\n    typeof pitch.alt === \"number\" &&\n    !isNaN(pitch.step) &&\n    !isNaN(pitch.alt)\n    ? true\n    : false;\n}\n\n// The number of fifths of [C, D, E, F, G, A, B]\nconst FIFTHS = [0, 2, 4, -1, 1, 3, 5];\n// The number of octaves it span each step\nconst STEPS_TO_OCTS = FIFTHS.map((fifths: number) =>\n  Math.floor((fifths * 7) / 12),\n);\n\n/**\n * Get coordinates from pitch object\n */\nexport function coordinates(pitch: Pitch): PitchCoordinates {\n  const { step, alt, oct, dir = 1 } = pitch;\n  const f = FIFTHS[step] + 7 * alt;\n  if (oct === undefined) {\n    return [dir * f];\n  }\n  const o = oct - STEPS_TO_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n}\n\n// We need to get the steps from fifths\n// Fifths for CDEFGAB are [ 0, 2, 4, -1, 1, 3, 5 ]\n// We add 1 to fifths to avoid negative numbers, so:\n// for [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\"] we have:\nconst FIFTHS_TO_STEPS = [3, 0, 4, 1, 5, 2, 6];\n\n/**\n * Get pitch from coordinate objects\n */\nexport function pitch(coord: PitchCoordinates): Pitch {\n  const [f, o, dir] = coord;\n  const step = FIFTHS_TO_STEPS[unaltered(f)];\n  const alt = Math.floor((f + 1) / 7);\n  if (o === undefined) {\n    return { step, alt, dir };\n  }\n  const oct = o + 4 * alt + STEPS_TO_OCTS[step];\n  return { step, alt, oct, dir };\n}\n\n// Return the number of fifths as if it were unaltered\nfunction unaltered(f: number): number {\n  const i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\n","import {\n  coordinates,\n  Direction,\n  IntervalCoordinates,\n  isNamedPitch,\n  isPitch,\n  NamedPitch,\n  Pitch,\n  pitch,\n  PitchCoordinates,\n} from \"@tonaljs/pitch\";\n\nconst fillStr = (s: string, n: number) => Array(Math.abs(n) + 1).join(s);\n\nexport type IntervalName = string;\nexport type IntervalLiteral = IntervalName | Pitch | NamedPitch;\n\ntype Quality =\n  | \"dddd\"\n  | \"ddd\"\n  | \"dd\"\n  | \"d\"\n  | \"m\"\n  | \"M\"\n  | \"P\"\n  | \"A\"\n  | \"AA\"\n  | \"AAA\"\n  | \"AAAA\";\ntype Type = \"perfectable\" | \"majorable\";\n\nexport interface Interval extends Pitch, NamedPitch {\n  readonly empty: boolean;\n  readonly name: IntervalName;\n  readonly num: number;\n  readonly q: Quality;\n  readonly type: Type;\n  readonly step: number;\n  readonly alt: number;\n  readonly dir: Direction;\n  readonly simple: number;\n  readonly semitones: number;\n  readonly chroma: number;\n  readonly coord: IntervalCoordinates;\n  readonly oct: number;\n}\n\nexport type IntervalType = Interval;\n\nconst NoInterval: Interval = Object.freeze({\n  empty: true,\n  name: \"\",\n  num: NaN,\n  q: \"\" as Quality,\n  type: \"\" as Type,\n  step: NaN,\n  alt: NaN,\n  dir: NaN as Direction,\n  simple: NaN,\n  semitones: NaN,\n  chroma: NaN,\n  coord: [] as unknown as IntervalCoordinates,\n  oct: NaN,\n});\n\n// shorthand tonal notation (with quality after number)\nconst INTERVAL_TONAL_REGEX = \"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\";\n// standard shorthand notation (with quality before number)\nconst INTERVAL_SHORTHAND_REGEX = \"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\";\nconst REGEX = new RegExp(\n  \"^\" + INTERVAL_TONAL_REGEX + \"|\" + INTERVAL_SHORTHAND_REGEX + \"$\",\n);\n\ntype IntervalTokens = [string, string];\n\n/**\n * @private\n */\nexport function tokenizeInterval(str?: IntervalName): IntervalTokens {\n  const m = REGEX.exec(`${str}`);\n  if (m === null) {\n    return [\"\", \"\"];\n  }\n  return m[1] ? [m[1], m[2]] : [m[4], m[3]];\n}\n\nconst cache: { [key in string]: Interval } = {};\n\n/**\n * Get interval properties. It returns an object with:\n *\n * - name: the interval name\n * - num: the interval number\n * - type: 'perfectable' or 'majorable'\n * - q: the interval quality (d, m, M, A)\n * - dir: interval direction (1 ascending, -1 descending)\n * - simple: the simplified number\n * - semitones: the size in semitones\n * - chroma: the interval chroma\n *\n * @param {string} interval - the interval name\n * @return {Object} the interval properties\n *\n * @example\n * import { interval } from '@tonaljs/core'\n * interval('P5').semitones // => 7\n * interval('m3').type // => 'majorable'\n */\nexport function interval(src: IntervalLiteral): Interval {\n  return typeof src === \"string\"\n    ? cache[src] || (cache[src] = parse(src))\n    : isPitch(src)\n      ? interval(pitchName(src))\n      : isNamedPitch(src)\n        ? interval(src.name)\n        : NoInterval;\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nconst TYPES = \"PMMPPMM\";\nfunction parse(str?: string): Interval {\n  const tokens = tokenizeInterval(str);\n  if (tokens[0] === \"\") {\n    return NoInterval;\n  }\n  const num = +tokens[0];\n  const q = tokens[1] as Quality;\n  const step = (Math.abs(num) - 1) % 7;\n  const t = TYPES[step];\n  if (t === \"M\" && q === \"P\") {\n    return NoInterval;\n  }\n  const type = t === \"M\" ? \"majorable\" : \"perfectable\";\n\n  const name = \"\" + num + q;\n  const dir = num < 0 ? -1 : 1;\n  const simple = num === 8 || num === -8 ? num : dir * (step + 1);\n  const alt = qToAlt(type, q);\n  const oct = Math.floor((Math.abs(num) - 1) / 7);\n  const semitones = dir * (SIZES[step] + alt + 12 * oct);\n  const chroma = (((dir * (SIZES[step] + alt)) % 12) + 12) % 12;\n  const coord = coordinates({ step, alt, oct, dir }) as IntervalCoordinates;\n  return {\n    empty: false,\n    name,\n    num,\n    q,\n    step,\n    alt,\n    dir,\n    type,\n    simple,\n    semitones,\n    chroma,\n    coord,\n    oct,\n  };\n}\n\n/**\n * @private\n *\n * forceDescending is used in the case of unison (#243)\n */\nexport function coordToInterval(\n  coord: PitchCoordinates,\n  forceDescending?: boolean,\n): Interval {\n  const [f, o = 0] = coord;\n  const isDescending = f * 7 + o * 12 < 0;\n  const ivl: IntervalCoordinates =\n    forceDescending || isDescending ? [-f, -o, -1] : [f, o, 1];\n  return interval(pitch(ivl)) as Interval;\n}\n\nfunction qToAlt(type: Type, q: string): number {\n  return (q === \"M\" && type === \"majorable\") ||\n    (q === \"P\" && type === \"perfectable\")\n    ? 0\n    : q === \"m\" && type === \"majorable\"\n      ? -1\n      : /^A+$/.test(q)\n        ? q.length\n        : /^d+$/.test(q)\n          ? -1 * (type === \"perfectable\" ? q.length : q.length + 1)\n          : 0;\n}\n\n// return the interval name of a pitch\nfunction pitchName(props: Pitch): string {\n  const { step, alt, oct = 0, dir } = props;\n  if (!dir) {\n    return \"\";\n  }\n  const calcNum = step + 1 + 7 * oct;\n  // this is an edge case: descending pitch class unison (see #243)\n  const num = calcNum === 0 ? step + 1 : calcNum;\n  const d = dir < 0 ? \"-\" : \"\";\n  const type = TYPES[step] === \"M\" ? \"majorable\" : \"perfectable\";\n  const name = d + num + altToQ(type, alt);\n  return name;\n}\n\nfunction altToQ(type: Type, alt: number): Quality {\n  if (alt === 0) {\n    return type === \"majorable\" ? \"M\" : \"P\";\n  } else if (alt === -1 && type === \"majorable\") {\n    return \"m\";\n  } else if (alt > 0) {\n    return fillStr(\"A\", alt) as Quality;\n  } else {\n    return fillStr(\"d\", type === \"perfectable\" ? alt : alt + 1) as Quality;\n  }\n}\n","export interface NamedPitch {\n  readonly name: string;\n}\n\n/*** @deprecated use NamedPitch */\nexport interface Named {\n  readonly name: string;\n}\n\nexport interface NotFound extends NamedPitch {\n  readonly empty: true;\n  readonly name: \"\";\n}\n\nexport function isNamedPitch(src: unknown): src is NamedPitch {\n  return src !== null &&\n    typeof src === \"object\" &&\n    \"name\" in src &&\n    typeof src.name === \"string\"\n    ? true\n    : false;\n}\n\ntype Fifths = number;\ntype Octaves = number;\nexport type Direction = 1 | -1;\n\nexport type PitchClassCoordinates = [Fifths];\nexport type NoteCoordinates = [Fifths, Octaves];\nexport type IntervalCoordinates = [Fifths, Octaves, Direction];\nexport type PitchCoordinates =\n  | PitchClassCoordinates\n  | NoteCoordinates\n  | IntervalCoordinates;\n\n/**\n * Pitch properties\n *\n * - {number} step - The step number: 0 = C, 1 = D, ... 6 = B\n * - {number} alt - Number of alterations: -2 = 'bb', -1 = 'b', 0 = '', 1 = '#', ...\n * - {number} [oct] = The octave (undefined when is a coord class)\n * - {number} [dir] = Interval direction (undefined when is not an interval)\n */\nexport interface Pitch {\n  readonly step: number;\n  readonly alt: number;\n  readonly oct?: number; // undefined for pitch classes\n  readonly dir?: Direction; // undefined for notes\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nexport const chroma = ({ step, alt }: Pitch) => (SIZES[step] + alt + 120) % 12;\n\nexport const height = ({ step, alt, oct, dir = 1 }: Pitch) =>\n  dir * (SIZES[step] + alt + 12 * (oct === undefined ? -100 : oct));\n\nexport const midi = (pitch: Pitch) => {\n  const h = height(pitch);\n  return pitch.oct !== undefined && h >= -12 && h <= 115 ? h + 12 : null;\n};\n\nexport function isPitch(pitch: unknown): pitch is Pitch {\n  return pitch !== null &&\n    typeof pitch === \"object\" &&\n    \"step\" in pitch &&\n    typeof pitch.step === \"number\" &&\n    \"alt\" in pitch &&\n    typeof pitch.alt === \"number\" &&\n    !isNaN(pitch.step) &&\n    !isNaN(pitch.alt)\n    ? true\n    : false;\n}\n\n// The number of fifths of [C, D, E, F, G, A, B]\nconst FIFTHS = [0, 2, 4, -1, 1, 3, 5];\n// The number of octaves it span each step\nconst STEPS_TO_OCTS = FIFTHS.map((fifths: number) =>\n  Math.floor((fifths * 7) / 12),\n);\n\n/**\n * Get coordinates from pitch object\n */\nexport function coordinates(pitch: Pitch): PitchCoordinates {\n  const { step, alt, oct, dir = 1 } = pitch;\n  const f = FIFTHS[step] + 7 * alt;\n  if (oct === undefined) {\n    return [dir * f];\n  }\n  const o = oct - STEPS_TO_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n}\n\n// We need to get the steps from fifths\n// Fifths for CDEFGAB are [ 0, 2, 4, -1, 1, 3, 5 ]\n// We add 1 to fifths to avoid negative numbers, so:\n// for [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\"] we have:\nconst FIFTHS_TO_STEPS = [3, 0, 4, 1, 5, 2, 6];\n\n/**\n * Get pitch from coordinate objects\n */\nexport function pitch(coord: PitchCoordinates): Pitch {\n  const [f, o, dir] = coord;\n  const step = FIFTHS_TO_STEPS[unaltered(f)];\n  const alt = Math.floor((f + 1) / 7);\n  if (o === undefined) {\n    return { step, alt, dir };\n  }\n  const oct = o + 4 * alt + STEPS_TO_OCTS[step];\n  return { step, alt, oct, dir };\n}\n\n// Return the number of fifths as if it were unaltered\nfunction unaltered(f: number): number {\n  const i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\n","import {\n  coordinates,\n  isNamedPitch,\n  isPitch,\n  NamedPitch,\n  Pitch,\n  pitch,\n  PitchCoordinates,\n} from \"@tonaljs/pitch\";\n\nconst fillStr = (s: string, n: number) => Array(Math.abs(n) + 1).join(s);\n\nexport type NoteWithOctave = string;\nexport type PcName = string;\nexport type NoteName = NoteWithOctave | PcName;\nexport type NoteLiteral = NoteName | Pitch | NamedPitch;\n\nexport interface Note extends Pitch, NamedPitch {\n  readonly empty: boolean;\n  readonly name: NoteName;\n  readonly letter: string;\n  readonly acc: string;\n  readonly pc: PcName;\n  readonly chroma: number;\n  readonly height: number;\n  readonly coord: PitchCoordinates;\n  readonly midi: number | null;\n  readonly freq: number | null;\n}\n\nexport type NoteType = Note;\n\nconst NoNote: Note = Object.freeze({\n  empty: true,\n  name: \"\",\n  letter: \"\",\n  acc: \"\",\n  pc: \"\",\n  step: NaN,\n  alt: NaN,\n  chroma: NaN,\n  height: NaN,\n  coord: [] as unknown as PitchCoordinates,\n  midi: null,\n  freq: null,\n});\n\nconst cache: Map<NoteLiteral | undefined, Note> = new Map();\n\nexport const stepToLetter = (step: number) => \"CDEFGAB\".charAt(step);\nexport const altToAcc = (alt: number): string =>\n  alt < 0 ? fillStr(\"b\", -alt) : fillStr(\"#\", alt);\nexport const accToAlt = (acc: string): number =>\n  acc[0] === \"b\" ? -acc.length : acc.length;\n\n/**\n * Given a note literal (a note name or a note object), returns the Note object\n * @example\n * note('Bb4') // => { name: \"Bb4\", midi: 70, chroma: 10, ... }\n */\nexport function note(src: NoteLiteral): Note {\n  const stringSrc = JSON.stringify(src);\n\n  const cached = cache.get(stringSrc);\n  if (cached) {\n    return cached;\n  }\n\n  const value =\n    typeof src === \"string\"\n      ? parse(src)\n      : isPitch(src)\n        ? note(pitchName(src))\n        : isNamedPitch(src)\n          ? note(src.name)\n          : NoNote;\n  cache.set(stringSrc, value);\n  return value;\n}\n\ntype NoteTokens = [string, string, string, string];\n\nconst REGEX = /^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\\d*)\\s*(.*)$/;\n\n/**\n * @private\n */\nexport function tokenizeNote(str: string): NoteTokens {\n  const m = REGEX.exec(str) as string[];\n  return m\n    ? [m[1].toUpperCase(), m[2].replace(/x/g, \"##\"), m[3], m[4]]\n    : [\"\", \"\", \"\", \"\"];\n}\n\n/**\n * @private\n */\nexport function coordToNote(noteCoord: PitchCoordinates): Note {\n  return note(pitch(noteCoord)) as Note;\n}\n\nconst mod = (n: number, m: number) => ((n % m) + m) % m;\n\nconst SEMI = [0, 2, 4, 5, 7, 9, 11];\nfunction parse(noteName: NoteName): Note {\n  const tokens = tokenizeNote(noteName);\n  if (tokens[0] === \"\" || tokens[3] !== \"\") {\n    return NoNote;\n  }\n\n  const letter = tokens[0];\n  const acc = tokens[1];\n  const octStr = tokens[2];\n\n  const step = (letter.charCodeAt(0) + 3) % 7;\n  const alt = accToAlt(acc);\n  const oct = octStr.length ? +octStr : undefined;\n  const coord = coordinates({ step, alt, oct });\n\n  const name = letter + acc + octStr;\n  const pc = letter + acc;\n  const chroma = (SEMI[step] + alt + 120) % 12;\n  const height =\n    oct === undefined\n      ? mod(SEMI[step] + alt, 12) - 12 * 99\n      : SEMI[step] + alt + 12 * (oct + 1);\n  const midi = height >= 0 && height <= 127 ? height : null;\n  const freq = oct === undefined ? null : Math.pow(2, (height - 69) / 12) * 440;\n\n  return {\n    empty: false,\n    acc,\n    alt,\n    chroma,\n    coord,\n    freq,\n    height,\n    letter,\n    midi,\n    name,\n    oct,\n    pc,\n    step,\n  };\n}\n\nfunction pitchName(props: Pitch): NoteName {\n  const { step, alt, oct } = props;\n  const letter = stepToLetter(step);\n  if (!letter) {\n    return \"\";\n  }\n\n  const pc = letter + altToAcc(alt);\n  return oct || oct === 0 ? pc + oct : pc;\n}\n","import { PitchCoordinates } from \"@tonaljs/pitch\";\nimport {\n  IntervalLiteral,\n  IntervalName,\n  interval as asInterval,\n  coordToInterval,\n} from \"@tonaljs/pitch-interval\";\nimport {\n  NoteLiteral,\n  NoteName,\n  note as asNote,\n  coordToNote,\n} from \"@tonaljs/pitch-note\";\n\n/**\n * Transpose a note by an interval.\n *\n * @param {string} note - the note or note name\n * @param {string} interval - the interval or interval name\n * @return {string} the transposed note name or empty string if not valid notes\n * @example\n * import { transpose } from \"@tonaljs/core\"\n * transpose(\"d3\", \"3M\") // => \"F#3\"\n * transpose(\"D\", \"3M\") // => \"F#\"\n * [\"C\", \"D\", \"E\", \"F\", \"G\"].map(pc => transpose(pc, \"M3)) // => [\"E\", \"F#\", \"G#\", \"A\", \"B\"]\n */\nexport function transpose(\n  noteName: NoteLiteral,\n  intervalName: IntervalLiteral | [number, number],\n): NoteName {\n  const note = asNote(noteName);\n  const intervalCoord = Array.isArray(intervalName)\n    ? intervalName\n    : asInterval(intervalName).coord;\n  if (note.empty || !intervalCoord || intervalCoord.length < 2) {\n    return \"\";\n  }\n  const noteCoord = note.coord;\n  const tr: PitchCoordinates =\n    noteCoord.length === 1\n      ? [noteCoord[0] + intervalCoord[0]]\n      : [noteCoord[0] + intervalCoord[0], noteCoord[1] + intervalCoord[1]];\n  return coordToNote(tr).name;\n}\n\n// Private\nexport function tonicIntervalsTransposer(\n  intervals: string[],\n  tonic: string | undefined | null,\n) {\n  const len = intervals.length;\n  return (normalized: number) => {\n    if (!tonic) return \"\";\n    const index =\n      normalized < 0 ? (len - (-normalized % len)) % len : normalized % len;\n    const octaves = Math.floor(normalized / len);\n    const root = transpose(tonic, [0, octaves]);\n    return transpose(root, intervals[index]);\n  };\n}\n\n/**\n * Find the interval distance between two notes or coord classes.\n *\n * To find distance between coord classes, both notes must be coord classes and\n * the interval is always ascending\n *\n * @param {Note|string} from - the note or note name to calculate distance from\n * @param {Note|string} to - the note or note name to calculate distance to\n * @return {string} the interval name or empty string if not valid notes\n *\n */\nexport function distance(\n  fromNote: NoteLiteral,\n  toNote: NoteLiteral,\n): IntervalName {\n  const from = asNote(fromNote);\n  const to = asNote(toNote);\n  if (from.empty || to.empty) {\n    return \"\";\n  }\n\n  const fcoord = from.coord;\n  const tcoord = to.coord;\n  const fifths = tcoord[0] - fcoord[0];\n  const octs =\n    fcoord.length === 2 && tcoord.length === 2\n      ? tcoord[1] - fcoord[1]\n      : -Math.floor((fifths * 7) / 12);\n\n  // If it's unison, not pitch class, and in the same octave\n  // it can be descending interval (see #243 & #428)\n  const forceDescending =\n    to.height === from.height &&\n    to.midi !== null &&\n    from.oct === to.oct &&\n    from.step > to.step;\n  return coordToInterval([fifths, octs], forceDescending).name;\n}\n","import { distance as dist, transpose as tr } from \"@tonaljs/pitch-distance\";\nimport { note } from \"@tonaljs/pitch-note\";\n\nconst fillStr = (character: string, times: number) =>\n  Array(times + 1).join(character);\n\nconst REGEX = /^(_{1,}|=|\\^{1,}|)([abcdefgABCDEFG])([,']*)$/;\n\ntype AbcTokens = [string, string, string];\n\nexport function tokenize(str: string): AbcTokens {\n  const m = REGEX.exec(str);\n  if (!m) {\n    return [\"\", \"\", \"\"];\n  }\n  return [m[1], m[2], m[3]];\n}\n\n/**\n * Convert a (string) note in ABC notation into a (string) note in scientific notation\n *\n * @example\n * abcToScientificNotation(\"c\") // => \"C5\"\n */\nexport function abcToScientificNotation(str: string): string {\n  const [acc, letter, oct] = tokenize(str);\n  if (letter === \"\") {\n    return \"\";\n  }\n  let o = 4;\n  for (let i = 0; i < oct.length; i++) {\n    o += oct.charAt(i) === \",\" ? -1 : 1;\n  }\n  const a =\n    acc[0] === \"_\"\n      ? acc.replace(/_/g, \"b\")\n      : acc[0] === \"^\"\n        ? acc.replace(/\\^/g, \"#\")\n        : \"\";\n  return letter.charCodeAt(0) > 96\n    ? letter.toUpperCase() + a + (o + 1)\n    : letter + a + o;\n}\n\n/**\n * Convert a (string) note in scientific notation into a (string) note in ABC notation\n *\n * @example\n * scientificToAbcNotation(\"C#4\") // => \"^C\"\n */\nexport function scientificToAbcNotation(str: string): string {\n  const n = note(str);\n  if (n.empty || (!n.oct && n.oct !== 0)) {\n    return \"\";\n  }\n  const { letter, acc, oct } = n;\n  const a = acc[0] === \"b\" ? acc.replace(/b/g, \"_\") : acc.replace(/#/g, \"^\");\n  const l = oct > 4 ? letter.toLowerCase() : letter;\n  const o =\n    oct === 5 ? \"\" : oct > 4 ? fillStr(\"'\", oct - 5) : fillStr(\",\", 4 - oct);\n  return a + l + o;\n}\n\nexport function transpose(note: string, interval: string): string {\n  return scientificToAbcNotation(tr(abcToScientificNotation(note), interval));\n}\n\nexport function distance(from: string, to: string): string {\n  return dist(abcToScientificNotation(from), abcToScientificNotation(to));\n}\n\n/** @deprecated */\nexport default {\n  abcToScientificNotation,\n  scientificToAbcNotation,\n  tokenize,\n  transpose,\n  distance,\n};\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { note, Note } from \"@tonaljs/pitch-note\";\n\n// ascending range\nfunction ascR(b: number, n: number) {\n  const a = [];\n  // tslint:disable-next-line:curly\n  for (; n--; a[n] = n + b);\n  return a;\n}\n// descending range\nfunction descR(b: number, n: number) {\n  const a = [];\n  // tslint:disable-next-line:curly\n  for (; n--; a[n] = b - n);\n  return a;\n}\n\n/**\n * Creates a numeric range\n *\n * @param {number} from\n * @param {number} to\n * @return {Array<number>}\n *\n * @example\n * range(-2, 2) // => [-2, -1, 0, 1, 2]\n * range(2, -2) // => [2, 1, 0, -1, -2]\n */\nexport function range(from: number, to: number): number[] {\n  return from < to ? ascR(from, to - from + 1) : descR(from, from - to + 1);\n}\n\n/**\n * Rotates a list a number of times. It's completely agnostic about the\n * contents of the list.\n *\n * @param {Integer} times - the number of rotations\n * @param {Array} array\n * @return {Array} the rotated array\n *\n * @example\n * rotate(1, [1, 2, 3]) // => [2, 3, 1]\n */\nexport function rotate<T>(times: number, arr: T[]): T[] {\n  const len = arr.length;\n  const n = ((times % len) + len) % len;\n  return arr.slice(n, len).concat(arr.slice(0, n));\n}\n\n/**\n * Return a copy of the array with the null values removed\n * @function\n * @param {Array} array\n * @return {Array}\n *\n * @example\n * compact([\"a\", \"b\", null, \"c\"]) // => [\"a\", \"b\", \"c\"]\n */\nexport function compact(arr: any[]): any[] {\n  return arr.filter((n) => n === 0 || n);\n}\n\n/**\n * Sort an array of notes in ascending order. Pitch classes are listed\n * before notes. Any string that is not a note is removed.\n *\n * @param {string[]} notes\n * @return {string[]} sorted array of notes\n *\n * @example\n * sortedNoteNames(['c2', 'c5', 'c1', 'c0', 'c6', 'c'])\n * // => ['C', 'C0', 'C1', 'C2', 'C5', 'C6']\n * sortedNoteNames(['c', 'F', 'G', 'a', 'b', 'h', 'J'])\n * // => ['C', 'F', 'G', 'A', 'B']\n */\nexport function sortedNoteNames(notes: string[]): string[] {\n  const valid = notes.map((n) => note(n)).filter((n) => !n.empty) as Note[];\n  return valid.sort((a, b) => a.height - b.height).map((n) => n.name);\n}\n\n/**\n * Get sorted notes with duplicates removed. Pitch classes are listed\n * before notes.\n *\n * @function\n * @param {string[]} array\n * @return {string[]} unique sorted notes\n *\n * @example\n * Array.sortedUniqNoteNames(['a', 'b', 'c2', '1p', 'p2', 'c2', 'b', 'c', 'c3' ])\n * // => [ 'C', 'A', 'B', 'C2', 'C3' ]\n */\nexport function sortedUniqNoteNames(arr: string[]): string[] {\n  return sortedNoteNames(arr).filter((n, i, a) => i === 0 || n !== a[i - 1]);\n}\n\n/**\n * Randomizes the order of the specified array in-place, using the FisherYates shuffle.\n *\n * @function\n * @param {Array} array\n * @return {Array} the array shuffled\n *\n * @example\n * shuffle([\"C\", \"D\", \"E\", \"F\"]) // => [...]\n */\nexport function shuffle(arr: any[], rnd = Math.random): any[] {\n  let i: number;\n  let t: any;\n  let m: number = arr.length;\n  while (m) {\n    i = Math.floor(rnd() * m--);\n    t = arr[m];\n    arr[m] = arr[i];\n    arr[i] = t;\n  }\n  return arr;\n}\n\n/**\n * Get all permutations of an array\n *\n * @param {Array} array - the array\n * @return {Array<Array>} an array with all the permutations\n * @example\n * permutations([\"a\", \"b\", \"c\"])) // =>\n * [\n *   [\"a\", \"b\", \"c\"],\n *   [\"b\", \"a\", \"c\"],\n *   [\"b\", \"c\", \"a\"],\n *   [\"a\", \"c\", \"b\"],\n *   [\"c\", \"a\", \"b\"],\n *   [\"c\", \"b\", \"a\"]\n * ]\n */\nexport function permutations(arr: any[]): any[] {\n  if (arr.length === 0) {\n    return [[]];\n  }\n  return permutations(arr.slice(1)).reduce((acc, perm) => {\n    return acc.concat(\n      arr.map((e, pos) => {\n        const newPerm = perm.slice();\n        newPerm.splice(pos, 0, arr[0]);\n        return newPerm;\n      }),\n    );\n  }, []);\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n// ascending range\nfunction ascR(b: number, n: number) {\n  const a = [];\n  // tslint:disable-next-line:curly\n  for (; n--; a[n] = n + b);\n  return a;\n}\n// descending range\nfunction descR(b: number, n: number) {\n  const a = [];\n  // tslint:disable-next-line:curly\n  for (; n--; a[n] = b - n);\n  return a;\n}\n\n/**\n * Creates a numeric range\n *\n * @param {number} from\n * @param {number} to\n * @return {Array<number>}\n *\n * @example\n * range(-2, 2) // => [-2, -1, 0, 1, 2]\n * range(2, -2) // => [2, 1, 0, -1, -2]\n */\nexport function range(from: number, to: number): number[] {\n  return from < to ? ascR(from, to - from + 1) : descR(from, from - to + 1);\n}\n\n/**\n * Rotates a list a number of times. It\"s completly agnostic about the\n * contents of the list.\n *\n * @param {Integer} times - the number of rotations\n * @param {Array} collection\n * @return {Array} the rotated collection\n *\n * @example\n * rotate(1, [1, 2, 3]) // => [2, 3, 1]\n */\nexport function rotate<T>(times: number, arr: T[]): T[] {\n  const len = arr.length;\n  const n = ((times % len) + len) % len;\n  return arr.slice(n, len).concat(arr.slice(0, n));\n}\n\n/**\n * Return a copy of the collection with the null values removed\n * @function\n * @param {Array} collection\n * @return {Array}\n *\n * @example\n * compact([\"a\", \"b\", null, \"c\"]) // => [\"a\", \"b\", \"c\"]\n */\nexport function compact(arr: any[]): any[] {\n  return arr.filter((n) => n === 0 || n);\n}\n\n/**\n * Randomizes the order of the specified collection in-place, using the FisherYates shuffle.\n *\n * @function\n * @param {Array} collection\n * @return {Array} the collection shuffled\n *\n * @example\n * shuffle([\"C\", \"D\", \"E\", \"F\"]) // => [...]\n */\nexport function shuffle(arr: any[], rnd = Math.random): any[] {\n  let i: number;\n  let t: any;\n  let m: number = arr.length;\n  while (m) {\n    i = Math.floor(rnd() * m--);\n    t = arr[m];\n    arr[m] = arr[i];\n    arr[i] = t;\n  }\n  return arr;\n}\n\n/**\n * Get all permutations of an collection\n *\n * @param {Array} collection - the collection\n * @return {Array<Array>} an collection with all the permutations\n * @example\n * permutations([\"a\", \"b\", \"c\"])) // =>\n * [\n *   [\"a\", \"b\", \"c\"],\n *   [\"b\", \"a\", \"c\"],\n *   [\"b\", \"c\", \"a\"],\n *   [\"a\", \"c\", \"b\"],\n *   [\"c\", \"a\", \"b\"],\n *   [\"c\", \"b\", \"a\"]\n * ]\n */\nexport function permutations(arr: any[]): any[] {\n  if (arr.length === 0) {\n    return [[]];\n  }\n  return permutations(arr.slice(1)).reduce((acc, perm) => {\n    return acc.concat(\n      arr.map((e, pos) => {\n        const newPerm = perm.slice();\n        newPerm.splice(pos, 0, arr[0]);\n        return newPerm;\n      }),\n    );\n  }, []);\n}\n\n/** @deprecated */\nexport default {\n  compact,\n  permutations,\n  range,\n  rotate,\n  shuffle,\n};\n","export interface NamedPitch {\n  readonly name: string;\n}\n\n/*** @deprecated use NamedPitch */\nexport interface Named {\n  readonly name: string;\n}\n\nexport interface NotFound extends NamedPitch {\n  readonly empty: true;\n  readonly name: \"\";\n}\n\nexport function isNamedPitch(src: unknown): src is NamedPitch {\n  return src !== null &&\n    typeof src === \"object\" &&\n    \"name\" in src &&\n    typeof src.name === \"string\"\n    ? true\n    : false;\n}\n\ntype Fifths = number;\ntype Octaves = number;\nexport type Direction = 1 | -1;\n\nexport type PitchClassCoordinates = [Fifths];\nexport type NoteCoordinates = [Fifths, Octaves];\nexport type IntervalCoordinates = [Fifths, Octaves, Direction];\nexport type PitchCoordinates =\n  | PitchClassCoordinates\n  | NoteCoordinates\n  | IntervalCoordinates;\n\n/**\n * Pitch properties\n *\n * - {number} step - The step number: 0 = C, 1 = D, ... 6 = B\n * - {number} alt - Number of alterations: -2 = 'bb', -1 = 'b', 0 = '', 1 = '#', ...\n * - {number} [oct] = The octave (undefined when is a coord class)\n * - {number} [dir] = Interval direction (undefined when is not an interval)\n */\nexport interface Pitch {\n  readonly step: number;\n  readonly alt: number;\n  readonly oct?: number; // undefined for pitch classes\n  readonly dir?: Direction; // undefined for notes\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nexport const chroma = ({ step, alt }: Pitch) => (SIZES[step] + alt + 120) % 12;\n\nexport const height = ({ step, alt, oct, dir = 1 }: Pitch) =>\n  dir * (SIZES[step] + alt + 12 * (oct === undefined ? -100 : oct));\n\nexport const midi = (pitch: Pitch) => {\n  const h = height(pitch);\n  return pitch.oct !== undefined && h >= -12 && h <= 115 ? h + 12 : null;\n};\n\nexport function isPitch(pitch: unknown): pitch is Pitch {\n  return pitch !== null &&\n    typeof pitch === \"object\" &&\n    \"step\" in pitch &&\n    typeof pitch.step === \"number\" &&\n    \"alt\" in pitch &&\n    typeof pitch.alt === \"number\" &&\n    !isNaN(pitch.step) &&\n    !isNaN(pitch.alt)\n    ? true\n    : false;\n}\n\n// The number of fifths of [C, D, E, F, G, A, B]\nconst FIFTHS = [0, 2, 4, -1, 1, 3, 5];\n// The number of octaves it span each step\nconst STEPS_TO_OCTS = FIFTHS.map((fifths: number) =>\n  Math.floor((fifths * 7) / 12),\n);\n\n/**\n * Get coordinates from pitch object\n */\nexport function coordinates(pitch: Pitch): PitchCoordinates {\n  const { step, alt, oct, dir = 1 } = pitch;\n  const f = FIFTHS[step] + 7 * alt;\n  if (oct === undefined) {\n    return [dir * f];\n  }\n  const o = oct - STEPS_TO_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n}\n\n// We need to get the steps from fifths\n// Fifths for CDEFGAB are [ 0, 2, 4, -1, 1, 3, 5 ]\n// We add 1 to fifths to avoid negative numbers, so:\n// for [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\"] we have:\nconst FIFTHS_TO_STEPS = [3, 0, 4, 1, 5, 2, 6];\n\n/**\n * Get pitch from coordinate objects\n */\nexport function pitch(coord: PitchCoordinates): Pitch {\n  const [f, o, dir] = coord;\n  const step = FIFTHS_TO_STEPS[unaltered(f)];\n  const alt = Math.floor((f + 1) / 7);\n  if (o === undefined) {\n    return { step, alt, dir };\n  }\n  const oct = o + 4 * alt + STEPS_TO_OCTS[step];\n  return { step, alt, oct, dir };\n}\n\n// Return the number of fifths as if it were unaltered\nfunction unaltered(f: number): number {\n  const i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\n","import {\n  coordinates,\n  Direction,\n  IntervalCoordinates,\n  isNamedPitch,\n  isPitch,\n  NamedPitch,\n  Pitch,\n  pitch,\n  PitchCoordinates,\n} from \"@tonaljs/pitch\";\n\nconst fillStr = (s: string, n: number) => Array(Math.abs(n) + 1).join(s);\n\nexport type IntervalName = string;\nexport type IntervalLiteral = IntervalName | Pitch | NamedPitch;\n\ntype Quality =\n  | \"dddd\"\n  | \"ddd\"\n  | \"dd\"\n  | \"d\"\n  | \"m\"\n  | \"M\"\n  | \"P\"\n  | \"A\"\n  | \"AA\"\n  | \"AAA\"\n  | \"AAAA\";\ntype Type = \"perfectable\" | \"majorable\";\n\nexport interface Interval extends Pitch, NamedPitch {\n  readonly empty: boolean;\n  readonly name: IntervalName;\n  readonly num: number;\n  readonly q: Quality;\n  readonly type: Type;\n  readonly step: number;\n  readonly alt: number;\n  readonly dir: Direction;\n  readonly simple: number;\n  readonly semitones: number;\n  readonly chroma: number;\n  readonly coord: IntervalCoordinates;\n  readonly oct: number;\n}\n\nexport type IntervalType = Interval;\n\nconst NoInterval: Interval = Object.freeze({\n  empty: true,\n  name: \"\",\n  num: NaN,\n  q: \"\" as Quality,\n  type: \"\" as Type,\n  step: NaN,\n  alt: NaN,\n  dir: NaN as Direction,\n  simple: NaN,\n  semitones: NaN,\n  chroma: NaN,\n  coord: [] as unknown as IntervalCoordinates,\n  oct: NaN,\n});\n\n// shorthand tonal notation (with quality after number)\nconst INTERVAL_TONAL_REGEX = \"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\";\n// standard shorthand notation (with quality before number)\nconst INTERVAL_SHORTHAND_REGEX = \"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\";\nconst REGEX = new RegExp(\n  \"^\" + INTERVAL_TONAL_REGEX + \"|\" + INTERVAL_SHORTHAND_REGEX + \"$\",\n);\n\ntype IntervalTokens = [string, string];\n\n/**\n * @private\n */\nexport function tokenizeInterval(str?: IntervalName): IntervalTokens {\n  const m = REGEX.exec(`${str}`);\n  if (m === null) {\n    return [\"\", \"\"];\n  }\n  return m[1] ? [m[1], m[2]] : [m[4], m[3]];\n}\n\nconst cache: { [key in string]: Interval } = {};\n\n/**\n * Get interval properties. It returns an object with:\n *\n * - name: the interval name\n * - num: the interval number\n * - type: 'perfectable' or 'majorable'\n * - q: the interval quality (d, m, M, A)\n * - dir: interval direction (1 ascending, -1 descending)\n * - simple: the simplified number\n * - semitones: the size in semitones\n * - chroma: the interval chroma\n *\n * @param {string} interval - the interval name\n * @return {Object} the interval properties\n *\n * @example\n * import { interval } from '@tonaljs/core'\n * interval('P5').semitones // => 7\n * interval('m3').type // => 'majorable'\n */\nexport function interval(src: IntervalLiteral): Interval {\n  return typeof src === \"string\"\n    ? cache[src] || (cache[src] = parse(src))\n    : isPitch(src)\n      ? interval(pitchName(src))\n      : isNamedPitch(src)\n        ? interval(src.name)\n        : NoInterval;\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nconst TYPES = \"PMMPPMM\";\nfunction parse(str?: string): Interval {\n  const tokens = tokenizeInterval(str);\n  if (tokens[0] === \"\") {\n    return NoInterval;\n  }\n  const num = +tokens[0];\n  const q = tokens[1] as Quality;\n  const step = (Math.abs(num) - 1) % 7;\n  const t = TYPES[step];\n  if (t === \"M\" && q === \"P\") {\n    return NoInterval;\n  }\n  const type = t === \"M\" ? \"majorable\" : \"perfectable\";\n\n  const name = \"\" + num + q;\n  const dir = num < 0 ? -1 : 1;\n  const simple = num === 8 || num === -8 ? num : dir * (step + 1);\n  const alt = qToAlt(type, q);\n  const oct = Math.floor((Math.abs(num) - 1) / 7);\n  const semitones = dir * (SIZES[step] + alt + 12 * oct);\n  const chroma = (((dir * (SIZES[step] + alt)) % 12) + 12) % 12;\n  const coord = coordinates({ step, alt, oct, dir }) as IntervalCoordinates;\n  return {\n    empty: false,\n    name,\n    num,\n    q,\n    step,\n    alt,\n    dir,\n    type,\n    simple,\n    semitones,\n    chroma,\n    coord,\n    oct,\n  };\n}\n\n/**\n * @private\n *\n * forceDescending is used in the case of unison (#243)\n */\nexport function coordToInterval(\n  coord: PitchCoordinates,\n  forceDescending?: boolean,\n): Interval {\n  const [f, o = 0] = coord;\n  const isDescending = f * 7 + o * 12 < 0;\n  const ivl: IntervalCoordinates =\n    forceDescending || isDescending ? [-f, -o, -1] : [f, o, 1];\n  return interval(pitch(ivl)) as Interval;\n}\n\nfunction qToAlt(type: Type, q: string): number {\n  return (q === \"M\" && type === \"majorable\") ||\n    (q === \"P\" && type === \"perfectable\")\n    ? 0\n    : q === \"m\" && type === \"majorable\"\n      ? -1\n      : /^A+$/.test(q)\n        ? q.length\n        : /^d+$/.test(q)\n          ? -1 * (type === \"perfectable\" ? q.length : q.length + 1)\n          : 0;\n}\n\n// return the interval name of a pitch\nfunction pitchName(props: Pitch): string {\n  const { step, alt, oct = 0, dir } = props;\n  if (!dir) {\n    return \"\";\n  }\n  const calcNum = step + 1 + 7 * oct;\n  // this is an edge case: descending pitch class unison (see #243)\n  const num = calcNum === 0 ? step + 1 : calcNum;\n  const d = dir < 0 ? \"-\" : \"\";\n  const type = TYPES[step] === \"M\" ? \"majorable\" : \"perfectable\";\n  const name = d + num + altToQ(type, alt);\n  return name;\n}\n\nfunction altToQ(type: Type, alt: number): Quality {\n  if (alt === 0) {\n    return type === \"majorable\" ? \"M\" : \"P\";\n  } else if (alt === -1 && type === \"majorable\") {\n    return \"m\";\n  } else if (alt > 0) {\n    return fillStr(\"A\", alt) as Quality;\n  } else {\n    return fillStr(\"d\", type === \"perfectable\" ? alt : alt + 1) as Quality;\n  }\n}\n","import { compact, range, rotate } from \"@tonaljs/collection\";\nimport { NotFound } from \"@tonaljs/pitch\";\nimport { transpose } from \"@tonaljs/pitch-distance\";\nimport { Interval, IntervalName, interval } from \"@tonaljs/pitch-interval\";\nimport { Note, NoteName, note } from \"@tonaljs/pitch-note\";\n\n/**\n * The properties of a pitch class set\n * @param {number} num - a number between 1 and 4095 (both included) that\n * uniquely identifies the set. It's the decimal number of the chroma.\n * @param {string} chroma - a string representation of the set: a 12-char string\n * with either \"1\" or \"0\" as characters, representing a pitch class or not\n * for the given position in the octave. For example, a \"1\" at index 0 means 'C',\n * a \"1\" at index 2 means 'D', and so on...\n * @param {string} normalized - the chroma but shifted to the first 1\n * @param {number} length - the number of notes of the pitch class set\n * @param {IntervalName[]} intervals - the intervals of the pitch class set\n * *starting from C*\n */\nexport interface Pcset {\n  readonly name: string;\n  readonly empty: boolean;\n  readonly setNum: number;\n  readonly chroma: PcsetChroma;\n  readonly normalized: PcsetChroma;\n  readonly intervals: IntervalName[];\n}\n\nexport const EmptyPcset: Pcset = {\n  empty: true,\n  name: \"\",\n  setNum: 0,\n  chroma: \"000000000000\",\n  normalized: \"000000000000\",\n  intervals: [],\n};\n\nexport type PcsetChroma = string;\nexport type PcsetNum = number;\n\n// UTILITIES\nconst setNumToChroma = (num: number): string =>\n  Number(num).toString(2).padStart(12, \"0\");\nconst chromaToNumber = (chroma: string): number => parseInt(chroma, 2);\nconst REGEX = /^[01]{12}$/;\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function isChroma(set: any): set is PcsetChroma {\n  return REGEX.test(set);\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst isPcsetNum = (set: any): set is PcsetNum =>\n  typeof set === \"number\" && set >= 0 && set <= 4095;\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst isPcset = (set: any): set is Pcset => set && isChroma(set.chroma);\n\nconst cache: { [key in string]: Pcset } = { [EmptyPcset.chroma]: EmptyPcset };\n\n/**\n * A definition of a pitch class set. It could be:\n * - The pitch class set chroma (a 12-length string with only 1s or 0s)\n * - The pitch class set number (an integer between 1 and 4095)\n * - An array of note names\n * - An array of interval names\n */\nexport type Set =\n  | Partial<Pcset>\n  | PcsetChroma\n  | PcsetNum\n  | NoteName[]\n  | IntervalName[];\n\n/**\n * Get the pitch class set of a collection of notes or set number or chroma\n */\nexport function get(src: Set): Pcset {\n  const chroma: PcsetChroma = isChroma(src)\n    ? src\n    : isPcsetNum(src)\n      ? setNumToChroma(src)\n      : Array.isArray(src)\n        ? listToChroma(src)\n        : isPcset(src)\n          ? src.chroma\n          : EmptyPcset.chroma;\n\n  return (cache[chroma] = cache[chroma] || chromaToPcset(chroma));\n}\n\n/**\n * @use Pcset.get\n * @deprecated\n */\nexport const pcset = get;\n\n/**\n * Get pitch class set chroma\n * @function\n * @example\n * Pcset.chroma([\"c\", \"d\", \"e\"]); //=> \"101010000000\"\n */\nexport const chroma = (set: Set) => get(set).chroma;\n\n/**\n * Get intervals (from C) of a set\n * @function\n * @example\n * Pcset.intervals([\"c\", \"d\", \"e\"]); //=>\n */\nexport const intervals = (set: Set) => get(set).intervals;\n\n/**\n * Get pitch class set number\n * @function\n * @example\n * Pcset.num([\"c\", \"d\", \"e\"]); //=> 2192\n */\nexport const num = (set: Set) => get(set).setNum;\n\nconst IVLS = [\n  \"1P\",\n  \"2m\",\n  \"2M\",\n  \"3m\",\n  \"3M\",\n  \"4P\",\n  \"5d\",\n  \"5P\",\n  \"6m\",\n  \"6M\",\n  \"7m\",\n  \"7M\",\n];\n\n/**\n * Get the intervals of a pcset *starting from C*\n * @private\n * @param {Set} set - the pitch class set\n * @return {IntervalName[]} an array of interval names or an empty array\n * if not a valid pitch class set\n */\nfunction chromaToIntervals(chroma: PcsetChroma): IntervalName[] {\n  const intervals = [];\n  for (let i = 0; i < 12; i++) {\n    // tslint:disable-next-line:curly\n    if (chroma.charAt(i) === \"1\") intervals.push(IVLS[i]);\n  }\n  return intervals;\n}\n\nexport function notes(set: Set): NoteName[] {\n  return get(set).intervals.map((ivl) => transpose(\"C\", ivl));\n}\n\n/**\n * Get a list of all possible pitch class sets (all possible chromas) *having\n * C as root*. There are 2048 different chromas. If you want them with another\n * note you have to transpose it\n *\n * @see http://allthescales.org/\n * @return {Array<PcsetChroma>} an array of possible chromas from '10000000000' to '11111111111'\n */\nexport function chromas(): PcsetChroma[] {\n  return range(2048, 4095).map(setNumToChroma);\n}\n\n/**\n * Given a a list of notes or a pcset chroma, produce the rotations\n * of the chroma discarding the ones that starts with \"0\"\n *\n * This is used, for example, to get all the modes of a scale.\n *\n * @param {Array|string} set - the list of notes or pitchChr of the set\n * @param {boolean} normalize - (Optional, true by default) remove all\n * the rotations that starts with \"0\"\n * @return {Array<string>} an array with all the modes of the chroma\n *\n * @example\n * Pcset.modes([\"C\", \"D\", \"E\"]).map(Pcset.intervals)\n */\nexport function modes(set: Set, normalize = true): PcsetChroma[] {\n  const pcs = get(set);\n\n  const binary = pcs.chroma.split(\"\");\n  return compact(\n    binary.map((_, i) => {\n      const r = rotate(i, binary);\n      return normalize && r[0] === \"0\" ? null : r.join(\"\");\n    }),\n  );\n}\n\n/**\n * Test if two pitch class sets are equal\n *\n * @param {Array|string} set1 - one of the pitch class sets\n * @param {Array|string} set2 - the other pitch class set\n * @return {boolean} true if they are equal\n * @example\n * Pcset.isEqual([\"c2\", \"d3\"], [\"c5\", \"d2\"]) // => true\n */\nexport function isEqual(s1: Set, s2: Set) {\n  return get(s1).setNum === get(s2).setNum;\n}\n\n/**\n * Create a function that test if a collection of notes is a\n * subset of a given set\n *\n * The function is curried.\n *\n * @param {PcsetChroma|NoteName[]} set - the superset to test against (chroma or\n * list of notes)\n * @return{function(PcsetChroma|NoteNames[]): boolean} a function accepting a set\n * to test against (chroma or list of notes)\n * @example\n * const inCMajor = Pcset.isSubsetOf([\"C\", \"E\", \"G\"])\n * inCMajor([\"e6\", \"c4\"]) // => true\n * inCMajor([\"e6\", \"c4\", \"d3\"]) // => false\n */\nexport function isSubsetOf(set: Set) {\n  const s = get(set).setNum;\n\n  return (notes: Set | Pcset) => {\n    const o = get(notes).setNum;\n    // tslint:disable-next-line: no-bitwise\n    return s && s !== o && (o & s) === o;\n  };\n}\n\n/**\n * Create a function that test if a collection of notes is a\n * superset of a given set (it contains all notes and at least one more)\n *\n * @param {Set} set - an array of notes or a chroma set string to test against\n * @return {(subset: Set): boolean} a function that given a set\n * returns true if is a subset of the first one\n * @example\n * const extendsCMajor = Pcset.isSupersetOf([\"C\", \"E\", \"G\"])\n * extendsCMajor([\"e6\", \"a\", \"c4\", \"g2\"]) // => true\n * extendsCMajor([\"c6\", \"e4\", \"g3\"]) // => false\n */\nexport function isSupersetOf(set: Set) {\n  const s = get(set).setNum;\n  return (notes: Set) => {\n    const o = get(notes).setNum;\n    // tslint:disable-next-line: no-bitwise\n    return s && s !== o && (o | s) === o;\n  };\n}\n\n/**\n * Test if a given pitch class set includes a note\n *\n * @param {Array<string>} set - the base set to test against\n * @param {string} note - the note to test\n * @return {boolean} true if the note is included in the pcset\n *\n * Can be partially applied\n *\n * @example\n * const isNoteInCMajor = isNoteIncludedIn(['C', 'E', 'G'])\n * isNoteInCMajor('C4') // => true\n * isNoteInCMajor('C#4') // => false\n */\nexport function isNoteIncludedIn(set: Set) {\n  const s = get(set);\n\n  return (noteName: NoteName): boolean => {\n    const n = note(noteName);\n    return s && !n.empty && s.chroma.charAt(n.chroma) === \"1\";\n  };\n}\n\n/** @deprecated use: isNoteIncludedIn */\nexport const includes = isNoteIncludedIn;\n\n/**\n * Filter a list with a pitch class set\n *\n * @param {Array|string} set - the pitch class set notes\n * @param {Array|string} notes - the note list to be filtered\n * @return {Array} the filtered notes\n *\n * @example\n * Pcset.filter([\"C\", \"D\", \"E\"], [\"c2\", \"c#2\", \"d2\", \"c3\", \"c#3\", \"d3\"]) // => [ \"c2\", \"d2\", \"c3\", \"d3\" ])\n * Pcset.filter([\"C2\"], [\"c2\", \"c#2\", \"d2\", \"c3\", \"c#3\", \"d3\"]) // => [ \"c2\", \"c3\" ])\n */\nexport function filter(set: Set) {\n  const isIncluded = isNoteIncludedIn(set);\n  return (notes: NoteName[]) => {\n    return notes.filter(isIncluded);\n  };\n}\n\n/** @deprecated */\nexport default {\n  get,\n  chroma,\n  num,\n  intervals,\n  chromas,\n  isSupersetOf,\n  isSubsetOf,\n  isNoteIncludedIn,\n  isEqual,\n  filter,\n  modes,\n  notes,\n  // deprecated\n  pcset,\n};\n\n//// PRIVATE ////\n\nfunction chromaRotations(chroma: string): string[] {\n  const binary = chroma.split(\"\");\n  return binary.map((_, i) => rotate(i, binary).join(\"\"));\n}\n\nfunction chromaToPcset(chroma: PcsetChroma): Pcset {\n  const setNum = chromaToNumber(chroma);\n  const normalizedNum = chromaRotations(chroma)\n    .map(chromaToNumber)\n    .filter((n) => n >= 2048)\n    .sort()[0];\n  const normalized = setNumToChroma(normalizedNum);\n\n  const intervals = chromaToIntervals(chroma);\n\n  return {\n    empty: false,\n    name: \"\",\n    setNum,\n    chroma,\n    normalized,\n    intervals,\n  };\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction listToChroma(set: any[]): PcsetChroma {\n  if (set.length === 0) {\n    return EmptyPcset.chroma;\n  }\n\n  let pitch: Note | Interval | NotFound;\n  const binary = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n  // tslint:disable-next-line:prefer-for-of\n  for (let i = 0; i < set.length; i++) {\n    pitch = note(set[i]);\n    // tslint:disable-next-line: curly\n    if (pitch.empty) pitch = interval(set[i]);\n    // tslint:disable-next-line: curly\n    if (!pitch.empty) binary[pitch.chroma] = 1;\n  }\n  return binary.join(\"\");\n}\n","/**\n * @private\n * Chord List\n * Source: https://en.wikibooks.org/wiki/Music_Theory/Complete_List_of_Chord_Patterns\n * Format: [\"intervals\", \"full name\", \"abrv1 abrv2\"]\n */\nconst CHORDS: string[][] = [\n  // ==Major==\n  [\"1P 3M 5P\", \"major\", \"M ^  maj\"],\n  [\"1P 3M 5P 7M\", \"major seventh\", \"maj7  ma7 M7 Maj7 ^7\"],\n  [\"1P 3M 5P 7M 9M\", \"major ninth\", \"maj9 9 ^9\"],\n  [\"1P 3M 5P 7M 9M 13M\", \"major thirteenth\", \"maj13 Maj13 ^13\"],\n  [\"1P 3M 5P 6M\", \"sixth\", \"6 add6 add13 M6\"],\n  [\"1P 3M 5P 6M 9M\", \"sixth added ninth\", \"6add9 6/9 69 M69\"],\n  [\"1P 3M 6m 7M\", \"major seventh flat sixth\", \"M7b6 ^7b6\"],\n  [\n    \"1P 3M 5P 7M 11A\",\n    \"major seventh sharp eleventh\",\n    \"maj#4 #4 #11 M7#11 ^7#11 maj7#11\",\n  ],\n  // ==Minor==\n  // '''Normal'''\n  [\"1P 3m 5P\", \"minor\", \"m min -\"],\n  [\"1P 3m 5P 7m\", \"minor seventh\", \"m7 min7 mi7 -7\"],\n  [\n    \"1P 3m 5P 7M\",\n    \"minor/major seventh\",\n    \"m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7\",\n  ],\n  [\"1P 3m 5P 6M\", \"minor sixth\", \"m6 -6\"],\n  [\"1P 3m 5P 7m 9M\", \"minor ninth\", \"m9 -9\"],\n  [\"1P 3m 5P 7M 9M\", \"minor/major ninth\", \"mM9 mMaj9 -^9\"],\n  [\"1P 3m 5P 7m 9M 11P\", \"minor eleventh\", \"m11 -11\"],\n  [\"1P 3m 5P 7m 9M 13M\", \"minor thirteenth\", \"m13 -13\"],\n  // '''Diminished'''\n  [\"1P 3m 5d\", \"diminished\", \"dim  o\"],\n  [\"1P 3m 5d 7d\", \"diminished seventh\", \"dim7 7 o7\"],\n  [\"1P 3m 5d 7m\", \"half-diminished\", \"m7b5  -7b5 h7 h\"],\n  // ==Dominant/Seventh==\n  // '''Normal'''\n  [\"1P 3M 5P 7m\", \"dominant seventh\", \"7 dom\"],\n  [\"1P 3M 5P 7m 9M\", \"dominant ninth\", \"9\"],\n  [\"1P 3M 5P 7m 9M 13M\", \"dominant thirteenth\", \"13\"],\n  [\"1P 3M 5P 7m 11A\", \"lydian dominant seventh\", \"7#11 7#4\"],\n  // '''Altered'''\n  [\"1P 3M 5P 7m 9m\", \"dominant flat ninth\", \"7b9\"],\n  [\"1P 3M 5P 7m 9A\", \"dominant sharp ninth\", \"7#9\"],\n  [\"1P 3M 7m 9m\", \"altered\", \"alt7\"],\n  // '''Suspended'''\n  [\"1P 4P 5P\", \"suspended fourth\", \"sus4 sus\"],\n  [\"1P 2M 5P\", \"suspended second\", \"sus2\"],\n  [\"1P 4P 5P 7m\", \"suspended fourth seventh\", \"7sus4 7sus\"],\n  [\"1P 5P 7m 9M 11P\", \"eleventh\", \"11\"],\n  [\n    \"1P 4P 5P 7m 9m\",\n    \"suspended fourth flat ninth\",\n    \"b9sus phryg 7b9sus 7b9sus4\",\n  ],\n  // ==Other==\n  [\"1P 5P\", \"fifth\", \"5\"],\n  [\"1P 3M 5A\", \"augmented\", \"aug + +5 ^#5\"],\n  [\"1P 3m 5A\", \"minor augmented\", \"m#5 -#5 m+\"],\n  [\"1P 3M 5A 7M\", \"augmented seventh\", \"maj7#5 maj7+5 +maj7 ^7#5\"],\n  [\n    \"1P 3M 5P 7M 9M 11A\",\n    \"major sharp eleventh (lydian)\",\n    \"maj9#11 9#11 ^9#11\",\n  ],\n  // ==Legacy==\n  [\"1P 2M 4P 5P\", \"\", \"sus24 sus4add9\"],\n  [\"1P 3M 5A 7M 9M\", \"\", \"maj9#5 Maj9#5\"],\n  [\"1P 3M 5A 7m\", \"\", \"7#5 +7 7+ 7aug aug7\"],\n  [\"1P 3M 5A 7m 9A\", \"\", \"7#5#9 7#9#5 7alt\"],\n  [\"1P 3M 5A 7m 9M\", \"\", \"9#5 9+\"],\n  [\"1P 3M 5A 7m 9M 11A\", \"\", \"9#5#11\"],\n  [\"1P 3M 5A 7m 9m\", \"\", \"7#5b9 7b9#5\"],\n  [\"1P 3M 5A 7m 9m 11A\", \"\", \"7#5b9#11\"],\n  [\"1P 3M 5A 9A\", \"\", \"+add#9\"],\n  [\"1P 3M 5A 9M\", \"\", \"M#5add9 +add9\"],\n  [\"1P 3M 5P 6M 11A\", \"\", \"M6#11 M6b5 6#11 6b5\"],\n  [\"1P 3M 5P 6M 7M 9M\", \"\", \"M7add13\"],\n  [\"1P 3M 5P 6M 9M 11A\", \"\", \"69#11\"],\n  [\"1P 3m 5P 6M 9M\", \"\", \"m69 -69\"],\n  [\"1P 3M 5P 6m 7m\", \"\", \"7b6\"],\n  [\"1P 3M 5P 7M 9A 11A\", \"\", \"maj7#9#11\"],\n  [\"1P 3M 5P 7M 9M 11A 13M\", \"\", \"M13#11 maj13#11 M13+4 M13#4\"],\n  [\"1P 3M 5P 7M 9m\", \"\", \"M7b9\"],\n  [\"1P 3M 5P 7m 11A 13m\", \"\", \"7#11b13 7b5b13\"],\n  [\"1P 3M 5P 7m 13M\", \"\", \"7add6 67 7add13\"],\n  [\"1P 3M 5P 7m 9A 11A\", \"\", \"7#9#11 7b5#9 7#9b5\"],\n  [\"1P 3M 5P 7m 9A 11A 13M\", \"\", \"13#9#11\"],\n  [\"1P 3M 5P 7m 9A 11A 13m\", \"\", \"7#9#11b13\"],\n  [\"1P 3M 5P 7m 9A 13M\", \"\", \"13#9\"],\n  [\"1P 3M 5P 7m 9A 13m\", \"\", \"7#9b13\"],\n  [\"1P 3M 5P 7m 9M 11A\", \"\", \"9#11 9+4 9#4\"],\n  [\"1P 3M 5P 7m 9M 11A 13M\", \"\", \"13#11 13+4 13#4\"],\n  [\"1P 3M 5P 7m 9M 11A 13m\", \"\", \"9#11b13 9b5b13\"],\n  [\"1P 3M 5P 7m 9m 11A\", \"\", \"7b9#11 7b5b9 7b9b5\"],\n  [\"1P 3M 5P 7m 9m 11A 13M\", \"\", \"13b9#11\"],\n  [\"1P 3M 5P 7m 9m 11A 13m\", \"\", \"7b9b13#11 7b9#11b13 7b5b9b13\"],\n  [\"1P 3M 5P 7m 9m 13M\", \"\", \"13b9\"],\n  [\"1P 3M 5P 7m 9m 13m\", \"\", \"7b9b13\"],\n  [\"1P 3M 5P 7m 9m 9A\", \"\", \"7b9#9\"],\n  [\"1P 3M 5P 9M\", \"\", \"Madd9 2 add9 add2\"],\n  [\"1P 3M 5P 9m\", \"\", \"Maddb9\"],\n  [\"1P 3M 5d\", \"\", \"Mb5\"],\n  [\"1P 3M 5d 6M 7m 9M\", \"\", \"13b5\"],\n  [\"1P 3M 5d 7M\", \"\", \"M7b5\"],\n  [\"1P 3M 5d 7M 9M\", \"\", \"M9b5\"],\n  [\"1P 3M 5d 7m\", \"\", \"7b5\"],\n  [\"1P 3M 5d 7m 9M\", \"\", \"9b5\"],\n  [\"1P 3M 7m\", \"\", \"7no5\"],\n  [\"1P 3M 7m 13m\", \"\", \"7b13\"],\n  [\"1P 3M 7m 9M\", \"\", \"9no5\"],\n  [\"1P 3M 7m 9M 13M\", \"\", \"13no5\"],\n  [\"1P 3M 7m 9M 13m\", \"\", \"9b13\"],\n  [\"1P 3m 4P 5P\", \"\", \"madd4\"],\n  [\"1P 3m 5P 6m 7M\", \"\", \"mMaj7b6\"],\n  [\"1P 3m 5P 6m 7M 9M\", \"\", \"mMaj9b6\"],\n  [\"1P 3m 5P 7m 11P\", \"\", \"m7add11 m7add4\"],\n  [\"1P 3m 5P 9M\", \"\", \"madd9\"],\n  [\"1P 3m 5d 6M 7M\", \"\", \"o7M7\"],\n  [\"1P 3m 5d 7M\", \"\", \"oM7\"],\n  [\"1P 3m 6m 7M\", \"\", \"mb6M7\"],\n  [\"1P 3m 6m 7m\", \"\", \"m7#5\"],\n  [\"1P 3m 6m 7m 9M\", \"\", \"m9#5\"],\n  [\"1P 3m 5A 7m 9M 11P\", \"\", \"m11A\"],\n  [\"1P 3m 6m 9m\", \"\", \"mb6b9\"],\n  [\"1P 2M 3m 5d 7m\", \"\", \"m9b5\"],\n  [\"1P 4P 5A 7M\", \"\", \"M7#5sus4\"],\n  [\"1P 4P 5A 7M 9M\", \"\", \"M9#5sus4\"],\n  [\"1P 4P 5A 7m\", \"\", \"7#5sus4\"],\n  [\"1P 4P 5P 7M\", \"\", \"M7sus4\"],\n  [\"1P 4P 5P 7M 9M\", \"\", \"M9sus4\"],\n  [\"1P 4P 5P 7m 9M\", \"\", \"9sus4 9sus\"],\n  [\"1P 4P 5P 7m 9M 13M\", \"\", \"13sus4 13sus\"],\n  [\"1P 4P 5P 7m 9m 13m\", \"\", \"7sus4b9b13 7b9b13sus4\"],\n  [\"1P 4P 7m 10m\", \"\", \"4 quartal\"],\n  [\"1P 5P 7m 9m 11P\", \"\", \"11b9\"],\n];\n\nexport default CHORDS;\n","import {\n  EmptyPcset,\n  get as pcset,\n  Pcset,\n  PcsetChroma,\n  PcsetNum,\n} from \"@tonaljs/pcset\";\nimport data from \"./data\";\n\nexport type ChordQuality =\n  | \"Major\"\n  | \"Minor\"\n  | \"Augmented\"\n  | \"Diminished\"\n  | \"Unknown\";\n\nexport interface ChordType extends Pcset {\n  name: string;\n  quality: ChordQuality;\n  aliases: string[];\n}\nconst NoChordType: ChordType = {\n  ...EmptyPcset,\n  name: \"\",\n  quality: \"Unknown\",\n  intervals: [],\n  aliases: [],\n};\n\ntype ChordTypeName = string | PcsetChroma | PcsetNum;\n\nlet dictionary: ChordType[] = [];\nlet index: Record<ChordTypeName, ChordType> = {};\n\n/**\n * Given a chord name or chroma, return the chord properties\n * @param {string} source - chord name or pitch class set chroma\n * @example\n * import { get } from 'tonaljs/chord-type'\n * get('major') // => { name: 'major', ... }\n */\nexport function get(type: ChordTypeName): ChordType {\n  return index[type] || NoChordType;\n}\n\n/** @deprecated */\nexport const chordType = get;\n\n/**\n * Get all chord (long) names\n */\nexport function names() {\n  return dictionary.map((chord) => chord.name).filter((x) => x);\n}\n\n/**\n * Get all chord symbols\n */\nexport function symbols() {\n  return dictionary.map((chord) => chord.aliases[0]).filter((x) => x);\n}\n\n/**\n * Keys used to reference chord types\n */\nexport function keys() {\n  return Object.keys(index);\n}\n\n/**\n * Return a list of all chord types\n */\nexport function all(): ChordType[] {\n  return dictionary.slice();\n}\n\n/** @deprecated */\nexport const entries = all;\n\n/**\n * Clear the dictionary\n */\nexport function removeAll() {\n  dictionary = [];\n  index = {};\n}\n\n/**\n * Add a chord to the dictionary.\n * @param intervals\n * @param aliases\n * @param [fullName]\n */\nexport function add(intervals: string[], aliases: string[], fullName?: string) {\n  const quality = getQuality(intervals);\n  const chord = {\n    ...pcset(intervals),\n    name: fullName || \"\",\n    quality,\n    intervals,\n    aliases,\n  };\n  dictionary.push(chord);\n  if (chord.name) {\n    index[chord.name] = chord;\n  }\n  index[chord.setNum] = chord;\n  index[chord.chroma] = chord;\n  chord.aliases.forEach((alias) => addAlias(chord, alias));\n}\n\nexport function addAlias(chord: ChordType, alias: string) {\n  index[alias] = chord;\n}\n\nfunction getQuality(intervals: string[]): ChordQuality {\n  const has = (interval: string) => intervals.indexOf(interval) !== -1;\n  return has(\"5A\")\n    ? \"Augmented\"\n    : has(\"3M\")\n      ? \"Major\"\n      : has(\"5d\")\n        ? \"Diminished\"\n        : has(\"3m\")\n          ? \"Minor\"\n          : \"Unknown\";\n}\n\ndata.forEach(([ivls, fullName, names]: string[]) =>\n  add(ivls.split(\" \"), names.split(\" \"), fullName),\n);\ndictionary.sort((a, b) => a.setNum - b.setNum);\n\n/** @deprecated */\nexport default {\n  names,\n  symbols,\n  get,\n  all,\n  add,\n  removeAll,\n  keys,\n  // deprecated\n  entries,\n  chordType,\n};\n","import { all, ChordType } from \"@tonaljs/chord-type\";\nimport { modes } from \"@tonaljs/pcset\";\nimport { note } from \"@tonaljs/pitch-note\";\n\ninterface FoundChord {\n  readonly weight: number;\n  readonly name: string;\n}\n\nconst namedSet = (notes: string[]) => {\n  const pcToName = notes.reduce<Record<number, string>>((record, n) => {\n    const chroma = note(n).chroma;\n    if (chroma !== undefined) {\n      record[chroma] = record[chroma] || note(n).name;\n    }\n    return record;\n  }, {});\n\n  return (chroma: number) => pcToName[chroma];\n};\n\ntype DetectOptions = {\n  assumePerfectFifth: boolean;\n};\nexport function detect(\n  source: string[],\n  options: Partial<DetectOptions> = {},\n): string[] {\n  const notes = source.map((n) => note(n).pc).filter((x) => x);\n  if (note.length === 0) {\n    return [];\n  }\n\n  const found: FoundChord[] = findMatches(notes, 1, options);\n\n  return found\n    .filter((chord) => chord.weight)\n    .sort((a, b) => b.weight - a.weight)\n    .map((chord) => chord.name);\n}\n\n/* tslint:disable:no-bitwise */\nconst BITMASK = {\n  // 3m 000100000000\n  // 3M 000010000000\n  anyThirds: 384,\n  // 5P 000000010000\n  perfectFifth: 16,\n  // 5d 000000100000\n  // 5A 000000001000\n  nonPerfectFifths: 40,\n  anySeventh: 3,\n};\n\nconst testChromaNumber = (bitmask: number) => (chromaNumber: number) =>\n  Boolean(chromaNumber & bitmask);\nconst hasAnyThird = testChromaNumber(BITMASK.anyThirds);\nconst hasPerfectFifth = testChromaNumber(BITMASK.perfectFifth);\nconst hasAnySeventh = testChromaNumber(BITMASK.anySeventh);\nconst hasNonPerfectFifth = testChromaNumber(BITMASK.nonPerfectFifths);\n\nfunction hasAnyThirdAndPerfectFifthAndAnySeventh(chordType: ChordType) {\n  const chromaNumber = parseInt(chordType.chroma, 2);\n  return (\n    hasAnyThird(chromaNumber) &&\n    hasPerfectFifth(chromaNumber) &&\n    hasAnySeventh(chromaNumber)\n  );\n}\n\nfunction withPerfectFifth(chroma: string): string {\n  const chromaNumber = parseInt(chroma, 2);\n  return hasNonPerfectFifth(chromaNumber)\n    ? chroma\n    : (chromaNumber | 16).toString(2);\n}\n\n/* tslint:enable:no-bitwise */\n\ntype FindMatchesOptions = {\n  assumePerfectFifth: boolean;\n};\nfunction findMatches(\n  notes: string[],\n  weight: number,\n  options: Partial<FindMatchesOptions>,\n): FoundChord[] {\n  const tonic = notes[0];\n  const tonicChroma = note(tonic).chroma;\n  const noteName = namedSet(notes);\n  // we need to test all chromas to get the correct baseNote\n  const allModes = modes(notes, false);\n\n  const found: FoundChord[] = [];\n  allModes.forEach((mode, index) => {\n    const modeWithPerfectFifth =\n      options.assumePerfectFifth && withPerfectFifth(mode);\n    // some chords could have the same chroma but different interval spelling\n    const chordTypes = all().filter((chordType) => {\n      if (\n        options.assumePerfectFifth &&\n        hasAnyThirdAndPerfectFifthAndAnySeventh(chordType)\n      ) {\n        return chordType.chroma === modeWithPerfectFifth;\n      }\n      return chordType.chroma === mode;\n    });\n\n    chordTypes.forEach((chordType) => {\n      const chordName = chordType.aliases[0];\n      const baseNote = noteName(index);\n      const isInversion = index !== tonicChroma;\n      if (isInversion) {\n        found.push({\n          weight: 0.5 * weight,\n          name: `${baseNote}${chordName}/${tonic}`,\n        });\n      } else {\n        found.push({ weight: 1 * weight, name: `${baseNote}${chordName}` });\n      }\n    });\n  });\n\n  return found;\n}\n\n/** @deprecated */\nexport default { detect };\n","export interface NamedPitch {\n  readonly name: string;\n}\n\n/*** @deprecated use NamedPitch */\nexport interface Named {\n  readonly name: string;\n}\n\nexport interface NotFound extends NamedPitch {\n  readonly empty: true;\n  readonly name: \"\";\n}\n\nexport function isNamedPitch(src: unknown): src is NamedPitch {\n  return src !== null &&\n    typeof src === \"object\" &&\n    \"name\" in src &&\n    typeof src.name === \"string\"\n    ? true\n    : false;\n}\n\ntype Fifths = number;\ntype Octaves = number;\nexport type Direction = 1 | -1;\n\nexport type PitchClassCoordinates = [Fifths];\nexport type NoteCoordinates = [Fifths, Octaves];\nexport type IntervalCoordinates = [Fifths, Octaves, Direction];\nexport type PitchCoordinates =\n  | PitchClassCoordinates\n  | NoteCoordinates\n  | IntervalCoordinates;\n\n/**\n * Pitch properties\n *\n * - {number} step - The step number: 0 = C, 1 = D, ... 6 = B\n * - {number} alt - Number of alterations: -2 = 'bb', -1 = 'b', 0 = '', 1 = '#', ...\n * - {number} [oct] = The octave (undefined when is a coord class)\n * - {number} [dir] = Interval direction (undefined when is not an interval)\n */\nexport interface Pitch {\n  readonly step: number;\n  readonly alt: number;\n  readonly oct?: number; // undefined for pitch classes\n  readonly dir?: Direction; // undefined for notes\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nexport const chroma = ({ step, alt }: Pitch) => (SIZES[step] + alt + 120) % 12;\n\nexport const height = ({ step, alt, oct, dir = 1 }: Pitch) =>\n  dir * (SIZES[step] + alt + 12 * (oct === undefined ? -100 : oct));\n\nexport const midi = (pitch: Pitch) => {\n  const h = height(pitch);\n  return pitch.oct !== undefined && h >= -12 && h <= 115 ? h + 12 : null;\n};\n\nexport function isPitch(pitch: unknown): pitch is Pitch {\n  return pitch !== null &&\n    typeof pitch === \"object\" &&\n    \"step\" in pitch &&\n    typeof pitch.step === \"number\" &&\n    \"alt\" in pitch &&\n    typeof pitch.alt === \"number\"\n    ? true\n    : false;\n}\n\n// The number of fifths of [C, D, E, F, G, A, B]\nconst FIFTHS = [0, 2, 4, -1, 1, 3, 5];\n// The number of octaves it span each step\nconst STEPS_TO_OCTS = FIFTHS.map((fifths: number) =>\n  Math.floor((fifths * 7) / 12),\n);\n\n/**\n * Get coordinates from pitch object\n */\nexport function coordinates(pitch: Pitch): PitchCoordinates {\n  const { step, alt, oct, dir = 1 } = pitch;\n  const f = FIFTHS[step] + 7 * alt;\n  if (oct === undefined) {\n    return [dir * f];\n  }\n  const o = oct - STEPS_TO_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n}\n\n// We need to get the steps from fifths\n// Fifths for CDEFGAB are [ 0, 2, 4, -1, 1, 3, 5 ]\n// We add 1 to fifths to avoid negative numbers, so:\n// for [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\"] we have:\nconst FIFTHS_TO_STEPS = [3, 0, 4, 1, 5, 2, 6];\n\n/**\n * Get pitch from coordinate objects\n */\nexport function pitch(coord: PitchCoordinates): Pitch {\n  const [f, o, dir] = coord;\n  const step = FIFTHS_TO_STEPS[unaltered(f)];\n  const alt = Math.floor((f + 1) / 7);\n  if (o === undefined) {\n    return { step, alt, dir };\n  }\n  const oct = o + 4 * alt + STEPS_TO_OCTS[step];\n  return { step, alt, oct, dir };\n}\n\n// Return the number of fifths as if it were unaltered\nfunction unaltered(f: number): number {\n  const i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\n","import {\n  coordinates,\n  Direction,\n  IntervalCoordinates,\n  isNamedPitch,\n  isPitch,\n  NamedPitch,\n  Pitch,\n  pitch,\n  PitchCoordinates,\n} from \"@tonaljs/pitch\";\n\nconst fillStr = (s: string, n: number) => Array(Math.abs(n) + 1).join(s);\n\nexport type IntervalName = string;\nexport type IntervalLiteral = IntervalName | Pitch | NamedPitch;\n\ntype Quality =\n  | \"dddd\"\n  | \"ddd\"\n  | \"dd\"\n  | \"d\"\n  | \"m\"\n  | \"M\"\n  | \"P\"\n  | \"A\"\n  | \"AA\"\n  | \"AAA\"\n  | \"AAAA\";\ntype Type = \"perfectable\" | \"majorable\";\n\nexport interface Interval extends Pitch, NamedPitch {\n  readonly empty: boolean;\n  readonly name: IntervalName;\n  readonly num: number;\n  readonly q: Quality;\n  readonly type: Type;\n  readonly step: number;\n  readonly alt: number;\n  readonly dir: Direction;\n  readonly simple: number;\n  readonly semitones: number;\n  readonly chroma: number;\n  readonly coord: IntervalCoordinates;\n  readonly oct: number;\n}\n\nexport interface NoInterval extends Partial<Interval> {\n  readonly empty: true;\n  readonly name: \"\";\n  readonly acc: \"\";\n}\n\nconst NoInterval: NoInterval = { empty: true, name: \"\", acc: \"\" };\n\n// shorthand tonal notation (with quality after number)\nconst INTERVAL_TONAL_REGEX = \"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\";\n// standard shorthand notation (with quality before number)\nconst INTERVAL_SHORTHAND_REGEX = \"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\";\nconst REGEX = new RegExp(\n  \"^\" + INTERVAL_TONAL_REGEX + \"|\" + INTERVAL_SHORTHAND_REGEX + \"$\",\n);\n\ntype IntervalTokens = [string, string];\n\n/**\n * @private\n */\nexport function tokenizeInterval(str?: IntervalName): IntervalTokens {\n  const m = REGEX.exec(`${str}`);\n  if (m === null) {\n    return [\"\", \"\"];\n  }\n  return m[1] ? [m[1], m[2]] : [m[4], m[3]];\n}\n\nconst cache: { [key in string]: Interval | NoInterval } = {};\n\n/**\n * Get interval properties. It returns an object with:\n *\n * - name: the interval name\n * - num: the interval number\n * - type: 'perfectable' or 'majorable'\n * - q: the interval quality (d, m, M, A)\n * - dir: interval direction (1 ascending, -1 descending)\n * - simple: the simplified number\n * - semitones: the size in semitones\n * - chroma: the interval chroma\n *\n * @param {string} interval - the interval name\n * @return {Object} the interval properties\n *\n * @example\n * import { interval } from '@tonaljs/core'\n * interval('P5').semitones // => 7\n * interval('m3').type // => 'majorable'\n */\nexport function interval(src: IntervalLiteral): Interval | NoInterval {\n  return typeof src === \"string\"\n    ? cache[src] || (cache[src] = parse(src))\n    : isPitch(src)\n      ? interval(pitchName(src))\n      : isNamedPitch(src)\n        ? interval(src.name)\n        : NoInterval;\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nconst TYPES = \"PMMPPMM\";\nfunction parse(str?: string): Interval | NoInterval {\n  const tokens = tokenizeInterval(str);\n  if (tokens[0] === \"\") {\n    return NoInterval;\n  }\n  const num = +tokens[0];\n  const q = tokens[1] as Quality;\n  const step = (Math.abs(num) - 1) % 7;\n  const t = TYPES[step];\n  if (t === \"M\" && q === \"P\") {\n    return NoInterval;\n  }\n  const type = t === \"M\" ? \"majorable\" : \"perfectable\";\n\n  const name = \"\" + num + q;\n  const dir = num < 0 ? -1 : 1;\n  const simple = num === 8 || num === -8 ? num : dir * (step + 1);\n  const alt = qToAlt(type, q);\n  const oct = Math.floor((Math.abs(num) - 1) / 7);\n  const semitones = dir * (SIZES[step] + alt + 12 * oct);\n  const chroma = (((dir * (SIZES[step] + alt)) % 12) + 12) % 12;\n  const coord = coordinates({ step, alt, oct, dir }) as IntervalCoordinates;\n  return {\n    empty: false,\n    name,\n    num,\n    q,\n    step,\n    alt,\n    dir,\n    type,\n    simple,\n    semitones,\n    chroma,\n    coord,\n    oct,\n  };\n}\n\n/**\n * @private\n *\n * forceDescending is used in the case of unison (#243)\n */\nexport function coordToInterval(\n  coord: PitchCoordinates,\n  forceDescending?: boolean,\n): Interval {\n  const [f, o = 0] = coord;\n  const isDescending = f * 7 + o * 12 < 0;\n  const ivl: IntervalCoordinates =\n    forceDescending || isDescending ? [-f, -o, -1] : [f, o, 1];\n  return interval(pitch(ivl)) as Interval;\n}\n\nfunction qToAlt(type: Type, q: string): number {\n  return (q === \"M\" && type === \"majorable\") ||\n    (q === \"P\" && type === \"perfectable\")\n    ? 0\n    : q === \"m\" && type === \"majorable\"\n      ? -1\n      : /^A+$/.test(q)\n        ? q.length\n        : /^d+$/.test(q)\n          ? -1 * (type === \"perfectable\" ? q.length : q.length + 1)\n          : 0;\n}\n\n// return the interval name of a pitch\nfunction pitchName(props: Pitch): string {\n  const { step, alt, oct = 0, dir } = props;\n  if (!dir) {\n    return \"\";\n  }\n  const calcNum = step + 1 + 7 * oct;\n  // this is an edge case: descending pitch class unison (see #243)\n  const num = calcNum === 0 ? step + 1 : calcNum;\n  const d = dir < 0 ? \"-\" : \"\";\n  const type = TYPES[step] === \"M\" ? \"majorable\" : \"perfectable\";\n  const name = d + num + altToQ(type, alt);\n  return name;\n}\n\nfunction altToQ(type: Type, alt: number): Quality {\n  if (alt === 0) {\n    return type === \"majorable\" ? \"M\" : \"P\";\n  } else if (alt === -1 && type === \"majorable\") {\n    return \"m\";\n  } else if (alt > 0) {\n    return fillStr(\"A\", alt) as Quality;\n  } else {\n    return fillStr(\"d\", type === \"perfectable\" ? alt : alt + 1) as Quality;\n  }\n}\n","import {\n  coordinates,\n  isNamedPitch,\n  isPitch,\n  NamedPitch,\n  Pitch,\n  pitch,\n  PitchCoordinates,\n} from \"@tonaljs/pitch\";\n\nconst fillStr = (s: string, n: number) => Array(Math.abs(n) + 1).join(s);\n\nexport type NoteWithOctave = string;\nexport type PcName = string;\nexport type NoteName = NoteWithOctave | PcName;\nexport type NoteLiteral = NoteName | Pitch | NamedPitch;\n\nexport interface Note extends Pitch, NamedPitch {\n  readonly empty: boolean;\n  readonly name: NoteName;\n  readonly letter: string;\n  readonly acc: string;\n  readonly pc: PcName;\n  readonly chroma: number;\n  readonly height: number;\n  readonly coord: PitchCoordinates;\n  readonly midi: number | null;\n  readonly freq: number | null;\n}\n\nexport interface NoNote extends Partial<Note> {\n  empty: true;\n  name: \"\";\n  pc: \"\";\n  acc: \"\";\n}\nconst NoNote: NoNote = { empty: true, name: \"\", pc: \"\", acc: \"\" };\n\nconst cache: Map<NoteLiteral | undefined, Note | NoNote> = new Map();\n\nexport const stepToLetter = (step: number) => \"CDEFGAB\".charAt(step);\nexport const altToAcc = (alt: number): string =>\n  alt < 0 ? fillStr(\"b\", -alt) : fillStr(\"#\", alt);\nexport const accToAlt = (acc: string): number =>\n  acc[0] === \"b\" ? -acc.length : acc.length;\n\n/**\n * Given a note literal (a note name or a note object), returns the Note object\n * @example\n * note('Bb4') // => { name: \"Bb4\", midi: 70, chroma: 10, ... }\n */\nexport function note(src: NoteLiteral): Note | NoNote {\n  const stringSrc = JSON.stringify(src);\n\n  const cached = cache.get(stringSrc);\n  if (cached) {\n    return cached;\n  }\n\n  const value =\n    typeof src === \"string\"\n      ? parse(src)\n      : isPitch(src)\n        ? note(pitchName(src))\n        : isNamedPitch(src)\n          ? note(src.name)\n          : NoNote;\n  cache.set(stringSrc, value);\n  return value;\n}\n\ntype NoteTokens = [string, string, string, string];\n\nconst REGEX = /^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\\d*)\\s*(.*)$/;\n\n/**\n * @private\n */\nexport function tokenizeNote(str: string): NoteTokens {\n  const m = REGEX.exec(str) as string[];\n  return m\n    ? [m[1].toUpperCase(), m[2].replace(/x/g, \"##\"), m[3], m[4]]\n    : [\"\", \"\", \"\", \"\"];\n}\n\n/**\n * @private\n */\nexport function coordToNote(noteCoord: PitchCoordinates): Note {\n  return note(pitch(noteCoord)) as Note;\n}\n\nconst mod = (n: number, m: number) => ((n % m) + m) % m;\n\nconst SEMI = [0, 2, 4, 5, 7, 9, 11];\nfunction parse(noteName: NoteName): Note | NoNote {\n  const tokens = tokenizeNote(noteName);\n  if (tokens[0] === \"\" || tokens[3] !== \"\") {\n    return NoNote;\n  }\n\n  const letter = tokens[0];\n  const acc = tokens[1];\n  const octStr = tokens[2];\n\n  const step = (letter.charCodeAt(0) + 3) % 7;\n  const alt = accToAlt(acc);\n  const oct = octStr.length ? +octStr : undefined;\n  const coord = coordinates({ step, alt, oct });\n\n  const name = letter + acc + octStr;\n  const pc = letter + acc;\n  const chroma = (SEMI[step] + alt + 120) % 12;\n  const height =\n    oct === undefined\n      ? mod(SEMI[step] + alt, 12) - 12 * 99\n      : SEMI[step] + alt + 12 * (oct + 1);\n  const midi = height >= 0 && height <= 127 ? height : null;\n  const freq = oct === undefined ? null : Math.pow(2, (height - 69) / 12) * 440;\n\n  return {\n    empty: false,\n    acc,\n    alt,\n    chroma,\n    coord,\n    freq,\n    height,\n    letter,\n    midi,\n    name,\n    oct,\n    pc,\n    step,\n  };\n}\n\nfunction pitchName(props: Pitch): NoteName {\n  const { step, alt, oct } = props;\n  const letter = stepToLetter(step);\n  if (!letter) {\n    return \"\";\n  }\n\n  const pc = letter + altToAcc(alt);\n  return oct || oct === 0 ? pc + oct : pc;\n}\n","import { PitchCoordinates } from \"@tonaljs/pitch\";\nimport {\n  IntervalLiteral,\n  IntervalName,\n  interval as asInterval,\n  coordToInterval,\n} from \"@tonaljs/pitch-interval\";\nimport {\n  NoteLiteral,\n  NoteName,\n  note as asNote,\n  coordToNote,\n} from \"@tonaljs/pitch-note\";\n\n/**\n * Transpose a note by an interval.\n *\n * @param {string} note - the note or note name\n * @param {string} interval - the interval or interval name\n * @return {string} the transposed note name or empty string if not valid notes\n * @example\n * import { transpose } from \"@tonaljs/core\"\n * transpose(\"d3\", \"3M\") // => \"F#3\"\n * transpose(\"D\", \"3M\") // => \"F#\"\n * [\"C\", \"D\", \"E\", \"F\", \"G\"].map(pc => transpose(pc, \"M3)) // => [\"E\", \"F#\", \"G#\", \"A\", \"B\"]\n */\nexport function transpose(\n  noteName: NoteLiteral,\n  intervalName: IntervalLiteral | [number, number],\n): NoteName {\n  const note = asNote(noteName);\n  const intervalCoord = Array.isArray(intervalName)\n    ? intervalName\n    : asInterval(intervalName).coord;\n  if (note.empty || !intervalCoord || intervalCoord.length < 2) {\n    return \"\";\n  }\n  const noteCoord = note.coord;\n  const tr: PitchCoordinates =\n    noteCoord.length === 1\n      ? [noteCoord[0] + intervalCoord[0]]\n      : [noteCoord[0] + intervalCoord[0], noteCoord[1] + intervalCoord[1]];\n  return coordToNote(tr).name;\n}\n\n// Private\nexport function tonicIntervalsTransposer(\n  intervals: string[],\n  tonic: string | undefined | null,\n) {\n  const len = intervals.length;\n  return (normalized: number) => {\n    if (!tonic) return \"\";\n    const index =\n      normalized < 0 ? (len - (-normalized % len)) % len : normalized % len;\n    const octaves = Math.floor(normalized / len);\n    const root = transpose(tonic, [0, octaves]);\n    return transpose(root, intervals[index]);\n  };\n}\n\n/**\n * Find the interval distance between two notes or coord classes.\n *\n * To find distance between coord classes, both notes must be coord classes and\n * the interval is always ascending\n *\n * @param {Note|string} from - the note or note name to calculate distance from\n * @param {Note|string} to - the note or note name to calculate distance to\n * @return {string} the interval name or empty string if not valid notes\n *\n */\nexport function distance(\n  fromNote: NoteLiteral,\n  toNote: NoteLiteral,\n): IntervalName {\n  const from = asNote(fromNote);\n  const to = asNote(toNote);\n  if (from.empty || to.empty) {\n    return \"\";\n  }\n\n  const fcoord = from.coord;\n  const tcoord = to.coord;\n  const fifths = tcoord[0] - fcoord[0];\n  const octs =\n    fcoord.length === 2 && tcoord.length === 2\n      ? tcoord[1] - fcoord[1]\n      : -Math.floor((fifths * 7) / 12);\n\n  // If it's unison and not pitch class, it can be descending interval (#243)\n  const forceDescending =\n    to.height === from.height &&\n    to.midi !== null &&\n    from.midi !== null &&\n    from.step > to.step;\n  return coordToInterval([fifths, octs], forceDescending).name;\n}\n","import { isNamedPitch } from \"@tonaljs/pitch\";\n\nexport * from \"@tonaljs/pitch\";\nexport * from \"@tonaljs/pitch-distance\";\nexport * from \"@tonaljs/pitch-interval\";\nexport * from \"@tonaljs/pitch-note\";\n\nexport const fillStr = (s: string, n: number) => Array(Math.abs(n) + 1).join(s);\n\nexport function deprecate<\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ResultFn extends (this: any, ...newArgs: any[]) => ReturnType<ResultFn>,\n>(original: string, alternative: string, fn: ResultFn) {\n  return function (this: unknown, ...args: unknown[]): ReturnType<ResultFn> {\n    // tslint:disable-next-line\n    console.warn(`${original} is deprecated. Use ${alternative}.`);\n    return fn.apply(this, args);\n  };\n}\n\nexport const isNamed = deprecate(\"isNamed\", \"isNamedPitch\", isNamedPitch);\n","/**\n * @private\n * Chord List\n * Source: https://en.wikibooks.org/wiki/Music_Theory/Complete_List_of_Chord_Patterns\n * Format: [\"intervals\", \"full name\", \"abrv1 abrv2\"]\n */\nconst CHORDS: string[][] = [\n  // ==Major==\n  [\"1P 3M 5P\", \"major\", \"M ^  maj\"],\n  [\"1P 3M 5P 7M\", \"major seventh\", \"maj7  ma7 M7 Maj7 ^7\"],\n  [\"1P 3M 5P 7M 9M\", \"major ninth\", \"maj9 9 ^9\"],\n  [\"1P 3M 5P 7M 9M 13M\", \"major thirteenth\", \"maj13 Maj13 ^13\"],\n  [\"1P 3M 5P 6M\", \"sixth\", \"6 add6 add13 M6\"],\n  [\"1P 3M 5P 6M 9M\", \"sixth added ninth\", \"6add9 6/9 69 M69\"],\n  [\"1P 3M 6m 7M\", \"major seventh flat sixth\", \"M7b6 ^7b6\"],\n  [\n    \"1P 3M 5P 7M 11A\",\n    \"major seventh sharp eleventh\",\n    \"maj#4 #4 #11 M7#11 ^7#11 maj7#11\",\n  ],\n  // ==Minor==\n  // '''Normal'''\n  [\"1P 3m 5P\", \"minor\", \"m min -\"],\n  [\"1P 3m 5P 7m\", \"minor seventh\", \"m7 min7 mi7 -7\"],\n  [\n    \"1P 3m 5P 7M\",\n    \"minor/major seventh\",\n    \"m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7\",\n  ],\n  [\"1P 3m 5P 6M\", \"minor sixth\", \"m6 -6\"],\n  [\"1P 3m 5P 7m 9M\", \"minor ninth\", \"m9 -9\"],\n  [\"1P 3m 5P 7M 9M\", \"minor/major ninth\", \"mM9 mMaj9 -^9\"],\n  [\"1P 3m 5P 7m 9M 11P\", \"minor eleventh\", \"m11 -11\"],\n  [\"1P 3m 5P 7m 9M 13M\", \"minor thirteenth\", \"m13 -13\"],\n  // '''Diminished'''\n  [\"1P 3m 5d\", \"diminished\", \"dim  o\"],\n  [\"1P 3m 5d 7d\", \"diminished seventh\", \"dim7 7 o7\"],\n  [\"1P 3m 5d 7m\", \"half-diminished\", \"m7b5  -7b5 h7 h\"],\n  // ==Dominant/Seventh==\n  // '''Normal'''\n  [\"1P 3M 5P 7m\", \"dominant seventh\", \"7 dom\"],\n  [\"1P 3M 5P 7m 9M\", \"dominant ninth\", \"9\"],\n  [\"1P 3M 5P 7m 9M 13M\", \"dominant thirteenth\", \"13\"],\n  [\"1P 3M 5P 7m 11A\", \"lydian dominant seventh\", \"7#11 7#4\"],\n  // '''Altered'''\n  [\"1P 3M 5P 7m 9m\", \"dominant flat ninth\", \"7b9\"],\n  [\"1P 3M 5P 7m 9A\", \"dominant sharp ninth\", \"7#9\"],\n  [\"1P 3M 7m 9m\", \"altered\", \"alt7\"],\n  // '''Suspended'''\n  [\"1P 4P 5P\", \"suspended fourth\", \"sus4 sus\"],\n  [\"1P 2M 5P\", \"suspended second\", \"sus2\"],\n  [\"1P 4P 5P 7m\", \"suspended fourth seventh\", \"7sus4 7sus\"],\n  [\"1P 5P 7m 9M 11P\", \"eleventh\", \"11\"],\n  [\n    \"1P 4P 5P 7m 9m\",\n    \"suspended fourth flat ninth\",\n    \"b9sus phryg 7b9sus 7b9sus4\",\n  ],\n  // ==Other==\n  [\"1P 5P\", \"fifth\", \"5\"],\n  [\"1P 3M 5A\", \"augmented\", \"aug + +5 ^#5\"],\n  [\"1P 3m 5A\", \"minor augmented\", \"m#5 -#5 m+\"],\n  [\"1P 3M 5A 7M\", \"augmented seventh\", \"maj7#5 maj7+5 +maj7 ^7#5\"],\n  [\n    \"1P 3M 5P 7M 9M 11A\",\n    \"major sharp eleventh (lydian)\",\n    \"maj9#11 9#11 ^9#11\",\n  ],\n  // ==Legacy==\n  [\"1P 2M 4P 5P\", \"\", \"sus24 sus4add9\"],\n  [\"1P 3M 5A 7M 9M\", \"\", \"maj9#5 Maj9#5\"],\n  [\"1P 3M 5A 7m\", \"\", \"7#5 +7 7+ 7aug aug7\"],\n  [\"1P 3M 5A 7m 9A\", \"\", \"7#5#9 7#9#5 7alt\"],\n  [\"1P 3M 5A 7m 9M\", \"\", \"9#5 9+\"],\n  [\"1P 3M 5A 7m 9M 11A\", \"\", \"9#5#11\"],\n  [\"1P 3M 5A 7m 9m\", \"\", \"7#5b9 7b9#5\"],\n  [\"1P 3M 5A 7m 9m 11A\", \"\", \"7#5b9#11\"],\n  [\"1P 3M 5A 9A\", \"\", \"+add#9\"],\n  [\"1P 3M 5A 9M\", \"\", \"M#5add9 +add9\"],\n  [\"1P 3M 5P 6M 11A\", \"\", \"M6#11 M6b5 6#11 6b5\"],\n  [\"1P 3M 5P 6M 7M 9M\", \"\", \"M7add13\"],\n  [\"1P 3M 5P 6M 9M 11A\", \"\", \"69#11\"],\n  [\"1P 3m 5P 6M 9M\", \"\", \"m69 -69\"],\n  [\"1P 3M 5P 6m 7m\", \"\", \"7b6\"],\n  [\"1P 3M 5P 7M 9A 11A\", \"\", \"maj7#9#11\"],\n  [\"1P 3M 5P 7M 9M 11A 13M\", \"\", \"M13#11 maj13#11 M13+4 M13#4\"],\n  [\"1P 3M 5P 7M 9m\", \"\", \"M7b9\"],\n  [\"1P 3M 5P 7m 11A 13m\", \"\", \"7#11b13 7b5b13\"],\n  [\"1P 3M 5P 7m 13M\", \"\", \"7add6 67 7add13\"],\n  [\"1P 3M 5P 7m 9A 11A\", \"\", \"7#9#11 7b5#9 7#9b5\"],\n  [\"1P 3M 5P 7m 9A 11A 13M\", \"\", \"13#9#11\"],\n  [\"1P 3M 5P 7m 9A 11A 13m\", \"\", \"7#9#11b13\"],\n  [\"1P 3M 5P 7m 9A 13M\", \"\", \"13#9\"],\n  [\"1P 3M 5P 7m 9A 13m\", \"\", \"7#9b13\"],\n  [\"1P 3M 5P 7m 9M 11A\", \"\", \"9#11 9+4 9#4\"],\n  [\"1P 3M 5P 7m 9M 11A 13M\", \"\", \"13#11 13+4 13#4\"],\n  [\"1P 3M 5P 7m 9M 11A 13m\", \"\", \"9#11b13 9b5b13\"],\n  [\"1P 3M 5P 7m 9m 11A\", \"\", \"7b9#11 7b5b9 7b9b5\"],\n  [\"1P 3M 5P 7m 9m 11A 13M\", \"\", \"13b9#11\"],\n  [\"1P 3M 5P 7m 9m 11A 13m\", \"\", \"7b9b13#11 7b9#11b13 7b5b9b13\"],\n  [\"1P 3M 5P 7m 9m 13M\", \"\", \"13b9\"],\n  [\"1P 3M 5P 7m 9m 13m\", \"\", \"7b9b13\"],\n  [\"1P 3M 5P 7m 9m 9A\", \"\", \"7b9#9\"],\n  [\"1P 3M 5P 9M\", \"\", \"Madd9 2 add9 add2\"],\n  [\"1P 3M 5P 9m\", \"\", \"Maddb9\"],\n  [\"1P 3M 5d\", \"\", \"Mb5\"],\n  [\"1P 3M 5d 6M 7m 9M\", \"\", \"13b5\"],\n  [\"1P 3M 5d 7M\", \"\", \"M7b5\"],\n  [\"1P 3M 5d 7M 9M\", \"\", \"M9b5\"],\n  [\"1P 3M 5d 7m\", \"\", \"7b5\"],\n  [\"1P 3M 5d 7m 9M\", \"\", \"9b5\"],\n  [\"1P 3M 7m\", \"\", \"7no5\"],\n  [\"1P 3M 7m 13m\", \"\", \"7b13\"],\n  [\"1P 3M 7m 9M\", \"\", \"9no5\"],\n  [\"1P 3M 7m 9M 13M\", \"\", \"13no5\"],\n  [\"1P 3M 7m 9M 13m\", \"\", \"9b13\"],\n  [\"1P 3m 4P 5P\", \"\", \"madd4\"],\n  [\"1P 3m 5P 6m 7M\", \"\", \"mMaj7b6\"],\n  [\"1P 3m 5P 6m 7M 9M\", \"\", \"mMaj9b6\"],\n  [\"1P 3m 5P 7m 11P\", \"\", \"m7add11 m7add4\"],\n  [\"1P 3m 5P 9M\", \"\", \"madd9\"],\n  [\"1P 3m 5d 6M 7M\", \"\", \"o7M7\"],\n  [\"1P 3m 5d 7M\", \"\", \"oM7\"],\n  [\"1P 3m 6m 7M\", \"\", \"mb6M7\"],\n  [\"1P 3m 6m 7m\", \"\", \"m7#5\"],\n  [\"1P 3m 6m 7m 9M\", \"\", \"m9#5\"],\n  [\"1P 3m 5A 7m 9M 11P\", \"\", \"m11A\"],\n  [\"1P 3m 6m 9m\", \"\", \"mb6b9\"],\n  [\"1P 2M 3m 5d 7m\", \"\", \"m9b5\"],\n  [\"1P 4P 5A 7M\", \"\", \"M7#5sus4\"],\n  [\"1P 4P 5A 7M 9M\", \"\", \"M9#5sus4\"],\n  [\"1P 4P 5A 7m\", \"\", \"7#5sus4\"],\n  [\"1P 4P 5P 7M\", \"\", \"M7sus4\"],\n  [\"1P 4P 5P 7M 9M\", \"\", \"M9sus4\"],\n  [\"1P 4P 5P 7m 9M\", \"\", \"9sus4 9sus\"],\n  [\"1P 4P 5P 7m 9M 13M\", \"\", \"13sus4 13sus\"],\n  [\"1P 4P 5P 7m 9m 13m\", \"\", \"7sus4b9b13 7b9b13sus4\"],\n  [\"1P 4P 7m 10m\", \"\", \"4 quartal\"],\n  [\"1P 5P 7m 9m 11P\", \"\", \"11b9\"],\n];\n\nexport default CHORDS;\n","import { deprecate } from \"@tonaljs/core\";\nimport {\n  EmptyPcset,\n  get as pcset,\n  Pcset,\n  PcsetChroma,\n  PcsetNum,\n} from \"@tonaljs/pcset\";\nimport data from \"./data\";\n\nexport type ChordQuality =\n  | \"Major\"\n  | \"Minor\"\n  | \"Augmented\"\n  | \"Diminished\"\n  | \"Unknown\";\n\nexport interface ChordType extends Pcset {\n  name: string;\n  quality: ChordQuality;\n  aliases: string[];\n}\nconst NoChordType: ChordType = {\n  ...EmptyPcset,\n  name: \"\",\n  quality: \"Unknown\",\n  intervals: [],\n  aliases: [],\n};\n\ntype ChordTypeName = string | PcsetChroma | PcsetNum;\n\nlet dictionary: ChordType[] = [];\nlet index: Record<ChordTypeName, ChordType> = {};\n\n/**\n * Given a chord name or chroma, return the chord properties\n * @param {string} source - chord name or pitch class set chroma\n * @example\n * import { get } from 'tonaljs/chord-type'\n * get('major') // => { name: 'major', ... }\n */\nexport function get(type: ChordTypeName): ChordType {\n  return index[type] || NoChordType;\n}\n\nexport const chordType = deprecate(\"ChordType.chordType\", \"ChordType.get\", get);\n\n/**\n * Get all chord (long) names\n */\nexport function names() {\n  return dictionary.map((chord) => chord.name).filter((x) => x);\n}\n\n/**\n * Get all chord symbols\n */\nexport function symbols() {\n  return dictionary.map((chord) => chord.aliases[0]).filter((x) => x);\n}\n\n/**\n * Keys used to reference chord types\n */\nexport function keys() {\n  return Object.keys(index);\n}\n\n/**\n * Return a list of all chord types\n */\nexport function all(): ChordType[] {\n  return dictionary.slice();\n}\n\nexport const entries = deprecate(\"ChordType.entries\", \"ChordType.all\", all);\n\n/**\n * Clear the dictionary\n */\nexport function removeAll() {\n  dictionary = [];\n  index = {};\n}\n\n/**\n * Add a chord to the dictionary.\n * @param intervals\n * @param aliases\n * @param [fullName]\n */\nexport function add(intervals: string[], aliases: string[], fullName?: string) {\n  const quality = getQuality(intervals);\n  const chord = {\n    ...pcset(intervals),\n    name: fullName || \"\",\n    quality,\n    intervals,\n    aliases,\n  };\n  dictionary.push(chord);\n  if (chord.name) {\n    index[chord.name] = chord;\n  }\n  index[chord.setNum] = chord;\n  index[chord.chroma] = chord;\n  chord.aliases.forEach((alias) => addAlias(chord, alias));\n}\n\nexport function addAlias(chord: ChordType, alias: string) {\n  index[alias] = chord;\n}\n\nfunction getQuality(intervals: string[]): ChordQuality {\n  const has = (interval: string) => intervals.indexOf(interval) !== -1;\n  return has(\"5A\")\n    ? \"Augmented\"\n    : has(\"3M\")\n    ? \"Major\"\n    : has(\"5d\")\n    ? \"Diminished\"\n    : has(\"3m\")\n    ? \"Minor\"\n    : \"Unknown\";\n}\n\ndata.forEach(([ivls, fullName, names]: string[]) =>\n  add(ivls.split(\" \"), names.split(\" \"), fullName)\n);\ndictionary.sort((a, b) => a.setNum - b.setNum);\n\nexport default {\n  names,\n  symbols,\n  get,\n  all,\n  add,\n  removeAll,\n  keys,\n  // deprecated\n  entries,\n  chordType,\n};\n","// SCALES\n// Format: [\"intervals\", \"name\", \"alias1\", \"alias2\", ...]\nconst SCALES: string[][] = [\n  // Basic scales\n  [\"1P 2M 3M 5P 6M\", \"major pentatonic\", \"pentatonic\"],\n  [\"1P 2M 3M 4P 5P 6M 7M\", \"major\", \"ionian\"],\n  [\"1P 2M 3m 4P 5P 6m 7m\", \"minor\", \"aeolian\"],\n\n  // Jazz common scales\n  [\"1P 2M 3m 3M 5P 6M\", \"major blues\"],\n  [\"1P 3m 4P 5d 5P 7m\", \"minor blues\", \"blues\"],\n  [\"1P 2M 3m 4P 5P 6M 7M\", \"melodic minor\"],\n  [\"1P 2M 3m 4P 5P 6m 7M\", \"harmonic minor\"],\n  [\"1P 2M 3M 4P 5P 6M 7m 7M\", \"bebop\"],\n  [\"1P 2M 3m 4P 5d 6m 6M 7M\", \"diminished\", \"whole-half diminished\"],\n\n  // Modes\n  [\"1P 2M 3m 4P 5P 6M 7m\", \"dorian\"],\n  [\"1P 2M 3M 4A 5P 6M 7M\", \"lydian\"],\n  [\"1P 2M 3M 4P 5P 6M 7m\", \"mixolydian\", \"dominant\"],\n  [\"1P 2m 3m 4P 5P 6m 7m\", \"phrygian\"],\n  [\"1P 2m 3m 4P 5d 6m 7m\", \"locrian\"],\n\n  // 5-note scales\n  [\"1P 3M 4P 5P 7M\", \"ionian pentatonic\"],\n  [\"1P 3M 4P 5P 7m\", \"mixolydian pentatonic\", \"indian\"],\n  [\"1P 2M 4P 5P 6M\", \"ritusen\"],\n  [\"1P 2M 4P 5P 7m\", \"egyptian\"],\n  [\"1P 3M 4P 5d 7m\", \"neopolitan major pentatonic\"],\n  [\"1P 3m 4P 5P 6m\", \"vietnamese 1\"],\n  [\"1P 2m 3m 5P 6m\", \"pelog\"],\n  [\"1P 2m 4P 5P 6m\", \"kumoijoshi\"],\n  [\"1P 2M 3m 5P 6m\", \"hirajoshi\"],\n  [\"1P 2m 4P 5d 7m\", \"iwato\"],\n  [\"1P 2m 4P 5P 7m\", \"in-sen\"],\n  [\"1P 3M 4A 5P 7M\", \"lydian pentatonic\", \"chinese\"],\n  [\"1P 3m 4P 6m 7m\", \"malkos raga\"],\n  [\"1P 3m 4P 5d 7m\", \"locrian pentatonic\", \"minor seven flat five pentatonic\"],\n  [\"1P 3m 4P 5P 7m\", \"minor pentatonic\", \"vietnamese 2\"],\n  [\"1P 3m 4P 5P 6M\", \"minor six pentatonic\"],\n  [\"1P 2M 3m 5P 6M\", \"flat three pentatonic\", \"kumoi\"],\n  [\"1P 2M 3M 5P 6m\", \"flat six pentatonic\"],\n  [\"1P 2m 3M 5P 6M\", \"scriabin\"],\n  [\"1P 3M 5d 6m 7m\", \"whole tone pentatonic\"],\n  [\"1P 3M 4A 5A 7M\", \"lydian #5P pentatonic\"],\n  [\"1P 3M 4A 5P 7m\", \"lydian dominant pentatonic\"],\n  [\"1P 3m 4P 5P 7M\", \"minor #7M pentatonic\"],\n  [\"1P 3m 4d 5d 7m\", \"super locrian pentatonic\"],\n\n  // 6-note scales\n  [\"1P 2M 3m 4P 5P 7M\", \"minor hexatonic\"],\n  [\"1P 2A 3M 5P 5A 7M\", \"augmented\"],\n  [\"1P 2M 4P 5P 6M 7m\", \"piongio\"],\n  [\"1P 2m 3M 4A 6M 7m\", \"prometheus neopolitan\"],\n  [\"1P 2M 3M 4A 6M 7m\", \"prometheus\"],\n  [\"1P 2m 3M 5d 6m 7m\", \"mystery #1\"],\n  [\"1P 2m 3M 4P 5A 6M\", \"six tone symmetric\"],\n  [\"1P 2M 3M 4A 5A 6A\", \"whole tone\", \"messiaen's mode #1\"],\n  [\"1P 2m 4P 4A 5P 7M\", \"messiaen's mode #5\"],\n\n  // 7-note scales\n  [\"1P 2M 3M 4P 5d 6m 7m\", \"locrian major\", \"arabian\"],\n  [\"1P 2m 3M 4A 5P 6m 7M\", \"double harmonic lydian\"],\n  [\n    \"1P 2m 2A 3M 4A 6m 7m\",\n    \"altered\",\n    \"super locrian\",\n    \"diminished whole tone\",\n    \"pomeroy\",\n  ],\n  [\"1P 2M 3m 4P 5d 6m 7m\", \"locrian #2\", \"half-diminished\", \"aeolian b5\"],\n  [\n    \"1P 2M 3M 4P 5P 6m 7m\",\n    \"mixolydian b6\",\n    \"melodic minor fifth mode\",\n    \"hindu\",\n  ],\n  [\"1P 2M 3M 4A 5P 6M 7m\", \"lydian dominant\", \"lydian b7\", \"overtone\"],\n  [\"1P 2M 3M 4A 5A 6M 7M\", \"lydian augmented\"],\n  [\n    \"1P 2m 3m 4P 5P 6M 7m\",\n    \"dorian b2\",\n    \"phrygian #6\",\n    \"melodic minor second mode\",\n  ],\n  [\n    \"1P 2m 3m 4d 5d 6m 7d\",\n    \"ultralocrian\",\n    \"superlocrian bb7\",\n    \"superlocrian diminished\",\n  ],\n  [\"1P 2m 3m 4P 5d 6M 7m\", \"locrian 6\", \"locrian natural 6\", \"locrian sharp 6\"],\n  [\"1P 2A 3M 4P 5P 5A 7M\", \"augmented heptatonic\"],\n  // Source https://en.wikipedia.org/wiki/Ukrainian_Dorian_scale\n  [\n    \"1P 2M 3m 4A 5P 6M 7m\",\n    \"dorian #4\",\n    \"ukrainian dorian\",\n    \"romanian minor\",\n    \"altered dorian\",\n  ],\n  [\"1P 2M 3m 4A 5P 6M 7M\", \"lydian diminished\"],\n  [\"1P 2M 3M 4A 5A 7m 7M\", \"leading whole tone\"],\n  [\"1P 2M 3M 4A 5P 6m 7m\", \"lydian minor\"],\n  [\"1P 2m 3M 4P 5P 6m 7m\", \"phrygian dominant\", \"spanish\", \"phrygian major\"],\n  [\"1P 2m 3m 4P 5P 6m 7M\", \"balinese\"],\n  [\"1P 2m 3m 4P 5P 6M 7M\", \"neopolitan major\"],\n  [\"1P 2M 3M 4P 5P 6m 7M\", \"harmonic major\"],\n  [\"1P 2m 3M 4P 5P 6m 7M\", \"double harmonic major\", \"gypsy\"],\n  [\"1P 2M 3m 4A 5P 6m 7M\", \"hungarian minor\"],\n  [\"1P 2A 3M 4A 5P 6M 7m\", \"hungarian major\"],\n  [\"1P 2m 3M 4P 5d 6M 7m\", \"oriental\"],\n  [\"1P 2m 3m 3M 4A 5P 7m\", \"flamenco\"],\n  [\"1P 2m 3m 4A 5P 6m 7M\", \"todi raga\"],\n  [\"1P 2m 3M 4P 5d 6m 7M\", \"persian\"],\n  [\"1P 2m 3M 5d 6m 7m 7M\", \"enigmatic\"],\n  [\n    \"1P 2M 3M 4P 5A 6M 7M\",\n    \"major augmented\",\n    \"major #5\",\n    \"ionian augmented\",\n    \"ionian #5\",\n  ],\n  [\"1P 2A 3M 4A 5P 6M 7M\", \"lydian #9\"],\n\n  // 8-note scales\n  [\"1P 2m 2M 4P 4A 5P 6m 7M\", \"messiaen's mode #4\"],\n  [\"1P 2m 3M 4P 4A 5P 6m 7M\", \"purvi raga\"],\n  [\"1P 2m 3m 3M 4P 5P 6m 7m\", \"spanish heptatonic\"],\n  [\"1P 2M 3m 3M 4P 5P 6M 7m\", \"bebop minor\"],\n  [\"1P 2M 3M 4P 5P 5A 6M 7M\", \"bebop major\"],\n  [\"1P 2m 3m 4P 5d 5P 6m 7m\", \"bebop locrian\"],\n  [\"1P 2M 3m 4P 5P 6m 7m 7M\", \"minor bebop\"],\n  [\"1P 2M 3M 4P 5d 5P 6M 7M\", \"ichikosucho\"],\n  [\"1P 2M 3m 4P 5P 6m 6M 7M\", \"minor six diminished\"],\n  [\n    \"1P 2m 3m 3M 4A 5P 6M 7m\",\n    \"half-whole diminished\",\n    \"dominant diminished\",\n    \"messiaen's mode #2\",\n  ],\n  [\"1P 3m 3M 4P 5P 6M 7m 7M\", \"kafi raga\"],\n  [\"1P 2M 3M 4P 4A 5A 6A 7M\", \"messiaen's mode #6\"],\n\n  // 9-note scales\n  [\"1P 2M 3m 3M 4P 5d 5P 6M 7m\", \"composite blues\"],\n  [\"1P 2M 3m 3M 4A 5P 6m 7m 7M\", \"messiaen's mode #3\"],\n\n  // 10-note scales\n  [\"1P 2m 2M 3m 4P 4A 5P 6m 6M 7M\", \"messiaen's mode #7\"],\n\n  // 12-note scales\n  [\"1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M\", \"chromatic\"],\n];\n\nexport default SCALES;\n","import {\n  EmptyPcset,\n  get as pcset,\n  Pcset,\n  PcsetChroma,\n  PcsetNum,\n} from \"@tonaljs/pcset\";\nimport data from \"./data\";\n\n/**\n * Properties for a scale in the scale dictionary. It's a pitch class set\n * properties with the following additional information:\n * - name: the scale name\n * - aliases: alternative list of names\n * - intervals: an array of interval names\n */\nexport interface ScaleType extends Pcset {\n  readonly name: string;\n  readonly aliases: string[];\n}\n\nexport const NoScaleType: ScaleType = {\n  ...EmptyPcset,\n  intervals: [],\n  aliases: [],\n};\n\ntype ScaleTypeName = string | PcsetChroma | PcsetNum;\n\nlet dictionary: ScaleType[] = [];\nlet index: Record<ScaleTypeName, ScaleType> = {};\n\nexport function names() {\n  return dictionary.map((scale) => scale.name);\n}\n\n/**\n * Given a scale name or chroma, return the scale properties\n *\n * @param {string} type - scale name or pitch class set chroma\n * @example\n * import { get } from 'tonaljs/scale-type'\n * get('major') // => { name: 'major', ... }\n */\nexport function get(type: ScaleTypeName): ScaleType {\n  return index[type] || NoScaleType;\n}\n\n/**\n * @deprecated\n * @use ScaleType.get\n */\nexport const scaleType = get;\n\n/**\n * Return a list of all scale types\n */\nexport function all() {\n  return dictionary.slice();\n}\n\n/**\n * @deprecated\n * @use ScaleType.all\n */\nexport const entries = all;\n\n/**\n * Keys used to reference scale types\n */\nexport function keys() {\n  return Object.keys(index);\n}\n\n/**\n * Clear the dictionary\n */\nexport function removeAll() {\n  dictionary = [];\n  index = {};\n}\n\n/**\n * Add a scale into dictionary\n * @param intervals\n * @param name\n * @param aliases\n */\nexport function add(\n  intervals: string[],\n  name: string,\n  aliases: string[] = [],\n): ScaleType {\n  const scale = { ...pcset(intervals), name, intervals, aliases };\n  dictionary.push(scale);\n  index[scale.name] = scale;\n  index[scale.setNum] = scale;\n  index[scale.chroma] = scale;\n  scale.aliases.forEach((alias) => addAlias(scale, alias));\n  return scale;\n}\n\nexport function addAlias(scale: ScaleType, alias: string) {\n  index[alias] = scale;\n}\n\ndata.forEach(([ivls, name, ...aliases]: string[]) =>\n  add(ivls.split(\" \"), name, aliases),\n);\n\n/** @deprecated */\nexport default {\n  names,\n  get,\n  all,\n  add,\n  removeAll,\n  keys,\n\n  // deprecated\n  entries,\n  scaleType,\n};\n","import { detect } from \"@tonaljs/chord-detect\";\nimport {\n  ChordType,\n  all as chordTypes,\n  get as getChordType,\n} from \"@tonaljs/chord-type\";\nimport { tonicIntervalsTransposer } from \"@tonaljs/core\";\n\nimport {\n  deprecate,\n  distance,\n  note,\n  NoteName,\n  tokenizeNote,\n  transpose as transposeNote,\n} from \"@tonaljs/core\";\n\nimport { isSubsetOf, isSupersetOf } from \"@tonaljs/pcset\";\n\nimport { all as scaleTypes } from \"@tonaljs/scale-type\";\nexport { detect } from \"@tonaljs/chord-detect\";\n\ntype ChordName = string;\ntype ChordNameTokens = [string, string]; // [TONIC, SCALE TYPE]\n\nexport interface Chord extends ChordType {\n  tonic: string | null;\n  type: string;\n  root: string;\n  rootDegree: number;\n  symbol: string;\n  notes: NoteName[];\n}\n\nconst NoChord: Chord = {\n  empty: true,\n  name: \"\",\n  symbol: \"\",\n  root: \"\",\n  rootDegree: 0,\n  type: \"\",\n  tonic: null,\n  setNum: NaN,\n  quality: \"Unknown\",\n  chroma: \"\",\n  normalized: \"\",\n  aliases: [],\n  notes: [],\n  intervals: [],\n};\n\n// 6, 64, 7, 9, 11 and 13 are consider part of the chord\n// (see https://github.com/danigb/tonal/issues/55)\nconst NUM_TYPES = /^(6|64|7|9|11|13)$/;\n/**\n * Tokenize a chord name. It returns an array with the tonic and chord type\n * If not tonic is found, all the name is considered the chord name.\n *\n * This function does NOT check if the chord type exists or not. It only tries\n * to split the tonic and chord type.\n *\n * @function\n * @param {string} name - the chord name\n * @return {Array} an array with [tonic, type]\n * @example\n * tokenize(\"Cmaj7\") // => [ \"C\", \"maj7\" ]\n * tokenize(\"C7\") // => [ \"C\", \"7\" ]\n * tokenize(\"mMaj7\") // => [ null, \"mMaj7\" ]\n * tokenize(\"Cnonsense\") // => [ null, \"nonsense\" ]\n */\nexport function tokenize(name: string): ChordNameTokens {\n  const [letter, acc, oct, type] = tokenizeNote(name);\n  if (letter === \"\") {\n    return [\"\", name];\n  }\n  // aug is augmented (see https://github.com/danigb/tonal/issues/55)\n  if (letter === \"A\" && type === \"ug\") {\n    return [\"\", \"aug\"];\n  }\n  return [letter + acc, oct + type];\n}\n\n/**\n * Get a Chord from a chord name.\n */\nexport function get(src: ChordName | ChordNameTokens): Chord {\n  if (src === \"\") {\n    return NoChord;\n  }\n  if (Array.isArray(src) && src.length === 2) {\n    return getChord(src[1], src[0]);\n  } else {\n    const [tonic, type] = tokenize(src);\n    const chord = getChord(type, tonic);\n    return chord.empty ? getChord(src) : chord;\n  }\n}\n\n/**\n * Get chord properties\n *\n * @param typeName - the chord type name\n * @param [tonic] - Optional tonic\n * @param [root]  - Optional root (requires a tonic)\n */\nexport function getChord(\n  typeName: string,\n  optionalTonic?: string,\n  optionalRoot?: string\n): Chord {\n  const type = getChordType(typeName);\n  const tonic = note(optionalTonic || \"\");\n  const root = note(optionalRoot || \"\");\n\n  if (\n    type.empty ||\n    (optionalTonic && tonic.empty) ||\n    (optionalRoot && root.empty)\n  ) {\n    return NoChord;\n  }\n\n  const rootInterval = distance(tonic.pc, root.pc);\n  const rootDegree = type.intervals.indexOf(rootInterval) + 1;\n  if (!root.empty && !rootDegree) {\n    return NoChord;\n  }\n\n  const intervals = Array.from(type.intervals);\n\n  for (let i = 1; i < rootDegree; i++) {\n    const num = intervals[0][0];\n    const quality = intervals[0][1];\n    const newNum = parseInt(num, 10) + 7;\n    intervals.push(`${newNum}${quality}`);\n    intervals.shift();\n  }\n\n  const notes = tonic.empty\n    ? []\n    : intervals.map((i) => transposeNote(tonic, i));\n\n  typeName = type.aliases.indexOf(typeName) !== -1 ? typeName : type.aliases[0];\n  const symbol = `${tonic.empty ? \"\" : tonic.pc}${typeName}${\n    root.empty || rootDegree <= 1 ? \"\" : \"/\" + root.pc\n  }`;\n  const name = `${optionalTonic ? tonic.pc + \" \" : \"\"}${type.name}${\n    rootDegree > 1 && optionalRoot ? \" over \" + root.pc : \"\"\n  }`;\n  return {\n    ...type,\n    name,\n    symbol,\n    type: type.name,\n    root: root.name,\n    intervals,\n    rootDegree,\n    tonic: tonic.name,\n    notes,\n  };\n}\n\nexport const chord = deprecate(\"Chord.chord\", \"Chord.get\", get);\n\n/**\n * Transpose a chord name\n *\n * @param {string} chordName - the chord name\n * @return {string} the transposed chord\n *\n * @example\n * transpose('Dm7', 'P4') // => 'Gm7\n */\nexport function transpose(chordName: string, interval: string): string {\n  const [tonic, type] = tokenize(chordName);\n  if (!tonic) {\n    return chordName;\n  }\n  return transposeNote(tonic, interval) + type;\n}\n\n/**\n * Get all scales where the given chord fits\n *\n * @example\n * chordScales('C7b9')\n * // => [\"phrygian dominant\", \"flamenco\", \"spanish heptatonic\", \"half-whole diminished\", \"chromatic\"]\n */\nexport function chordScales(name: string): string[] {\n  const s = get(name);\n  const isChordIncluded = isSupersetOf(s.chroma);\n  return scaleTypes()\n    .filter((scale) => isChordIncluded(scale.chroma))\n    .map((scale) => scale.name);\n}\n/**\n * Get all chords names that are a superset of the given one\n * (has the same notes and at least one more)\n *\n * @function\n * @example\n * extended(\"CMaj7\")\n * // => [ 'Cmaj#4', 'Cmaj7#9#11', 'Cmaj9', 'CM7add13', 'Cmaj13', 'Cmaj9#11', 'CM13#11', 'CM7b9' ]\n */\nexport function extended(chordName: string): string[] {\n  const s = get(chordName);\n  const isSuperset = isSupersetOf(s.chroma);\n  return chordTypes()\n    .filter((chord) => isSuperset(chord.chroma))\n    .map((chord) => s.tonic + chord.aliases[0]);\n}\n\n/**\n * Find all chords names that are a subset of the given one\n * (has less notes but all from the given chord)\n *\n * @example\n */\nexport function reduced(chordName: string): string[] {\n  const s = get(chordName);\n  const isSubset = isSubsetOf(s.chroma);\n  return chordTypes()\n    .filter((chord) => isSubset(chord.chroma))\n    .map((chord) => s.tonic + chord.aliases[0]);\n}\n\n/**\n * Returns a function to get a note name from the scale degree.\n *\n * @example\n * [1, 2, 3, 4].map(Chord.degrees(\"C\")) => [\"C\", \"E\", \"G\", \"C\"]\n * [1, 2, 3, 4].map(Chord.degrees(\"C4\")) => [\"C4\", \"E4\", \"G4\", \"C5\"]\n */\nexport function degrees(chordName: string | ChordNameTokens) {\n  const { intervals, tonic } = get(chordName);\n  const transpose = tonicIntervalsTransposer(intervals, tonic);\n  return (degree: number) =>\n    degree ? transpose(degree > 0 ? degree - 1 : degree) : \"\";\n}\n\n/**\n * Sames as `degree` but with 0-based index\n */\nexport function steps(chordName: string | ChordNameTokens) {\n  const { intervals, tonic } = get(chordName);\n  return tonicIntervalsTransposer(intervals, tonic);\n}\n\nexport default {\n  getChord,\n  get,\n  detect,\n  chordScales,\n  extended,\n  reduced,\n  tokenize,\n  transpose,\n  degrees,\n  steps,\n\n  // deprecate\n  chord,\n};\n","import DATA from \"./data\";\n\ntype Fraction = [number, number];\n\nconst VALUES: DurationValue[] = [];\n\nDATA.forEach(([denominator, shorthand, names]) =>\n  add(denominator, shorthand, names),\n);\n\nexport interface DurationValue {\n  empty: boolean;\n  value: number;\n  name: string;\n  fraction: Fraction;\n  shorthand: string;\n  dots: string;\n  names: string[];\n}\n\nconst NoDuration: DurationValue = {\n  empty: true,\n  name: \"\",\n  value: 0,\n  fraction: [0, 0],\n  shorthand: \"\",\n  dots: \"\",\n  names: [],\n};\n\nexport function names(): string[] {\n  return VALUES.reduce((names, duration) => {\n    duration.names.forEach((name) => names.push(name));\n    return names;\n  }, [] as string[]);\n}\n\nexport function shorthands(): string[] {\n  return VALUES.map((dur) => dur.shorthand);\n}\n\nconst REGEX = /^([^.]+)(\\.*)$/;\n\nexport function get(name: string): DurationValue {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [_, simple, dots] = REGEX.exec(name) || [];\n  const base = VALUES.find(\n    (dur) => dur.shorthand === simple || dur.names.includes(simple),\n  );\n  if (!base) {\n    return NoDuration;\n  }\n\n  const fraction = calcDots(base.fraction, dots.length);\n  const value = fraction[0] / fraction[1];\n\n  return { ...base, name, dots, value, fraction };\n}\n\nexport const value = (name: string) => get(name).value;\nexport const fraction = (name: string) => get(name).fraction;\n\n/** @deprecated */\nexport default { names, shorthands, get, value, fraction };\n\n//// PRIVATE ////\n\nfunction add(denominator: number, shorthand: string, names: string[]) {\n  VALUES.push({\n    empty: false,\n    dots: \"\",\n    name: \"\",\n    value: 1 / denominator,\n    fraction: denominator < 1 ? [1 / denominator, 1] : [1, denominator],\n    shorthand,\n    names,\n  });\n}\n\nfunction calcDots(fraction: Fraction, dots: number): Fraction {\n  const pow = Math.pow(2, dots);\n\n  let numerator = fraction[0] * pow;\n  let denominator = fraction[1] * pow;\n  const base = numerator;\n\n  // add fractions\n  for (let i = 0; i < dots; i++) {\n    numerator += base / Math.pow(2, i + 1);\n  }\n\n  // simplify\n  while (numerator % 2 === 0 && denominator % 2 === 0) {\n    numerator /= 2;\n    denominator /= 2;\n  }\n  return [numerator, denominator];\n}\n","// source: https://en.wikipedia.org/wiki/Note_value\nconst DATA: [number, string, string[]][] = [\n  [\n    0.125,\n    \"dl\",\n    [\"large\", \"duplex longa\", \"maxima\", \"octuple\", \"octuple whole\"],\n  ],\n  [0.25, \"l\", [\"long\", \"longa\"]],\n  [0.5, \"d\", [\"double whole\", \"double\", \"breve\"]],\n  [1, \"w\", [\"whole\", \"semibreve\"]],\n  [2, \"h\", [\"half\", \"minim\"]],\n  [4, \"q\", [\"quarter\", \"crotchet\"]],\n  [8, \"e\", [\"eighth\", \"quaver\"]],\n  [16, \"s\", [\"sixteenth\", \"semiquaver\"]],\n  [32, \"t\", [\"thirty-second\", \"demisemiquaver\"]],\n  [64, \"sf\", [\"sixty-fourth\", \"hemidemisemiquaver\"]],\n  [128, \"h\", [\"hundred twenty-eighth\"]],\n  [256, \"th\", [\"two hundred fifty-sixth\"]],\n];\n\nexport default DATA;\n","import { IntervalCoordinates, NoteCoordinates } from \"@tonaljs/pitch\";\nimport { distance as dist } from \"@tonaljs/pitch-distance\";\nimport {\n  IntervalName,\n  coordToInterval,\n  interval as props,\n} from \"@tonaljs/pitch-interval\";\n\n/**\n * Get the natural list of names\n */\nexport function names(): IntervalName[] {\n  return \"1P 2M 3M 4P 5P 6m 7m\".split(\" \");\n}\n\n/**\n * Get properties of an interval\n *\n * @function\n * @example\n * Interval.get('P4') // => {\"alt\": 0,  \"dir\": 1,  \"name\": \"4P\", \"num\": 4, \"oct\": 0, \"q\": \"P\", \"semitones\": 5, \"simple\": 4, \"step\": 3, \"type\": \"perfectable\"}\n */\nexport const get = props;\n\n/**\n * Get name of an interval\n *\n * @function\n * @example\n * Interval.name('4P') // => \"4P\"\n * Interval.name('P4') // => \"4P\"\n * Interval.name('C4') // => \"\"\n */\nexport const name = (name: string) => props(name).name;\n\n/**\n * Get semitones of an interval\n * @function\n * @example\n * Interval.semitones('P4') // => 5\n */\nexport const semitones = (name: string) => props(name).semitones;\n\n/**\n * Get quality of an interval\n * @function\n * @example\n * Interval.quality('P4') // => \"P\"\n */\nexport const quality = (name: string) => props(name).q;\n\n/**\n * Get number of an interval\n * @function\n * @example\n * Interval.num('P4') // => 4\n */\nexport const num = (name: string) => props(name).num;\n\n/**\n * Get the simplified version of an interval.\n *\n * @function\n * @param {string} interval - the interval to simplify\n * @return {string} the simplified interval\n *\n * @example\n * Interval.simplify(\"9M\") // => \"2M\"\n * Interval.simplify(\"2M\") // => \"2M\"\n * Interval.simplify(\"-2M\") // => \"7m\"\n * [\"8P\", \"9M\", \"10M\", \"11P\", \"12P\", \"13M\", \"14M\", \"15P\"].map(Interval.simplify)\n * // => [ \"8P\", \"2M\", \"3M\", \"4P\", \"5P\", \"6M\", \"7M\", \"8P\" ]\n */\nexport function simplify(name: IntervalName): IntervalName {\n  const i = props(name);\n  return i.empty ? \"\" : i.simple + i.q;\n}\n\n/**\n * Get the inversion (https://en.wikipedia.org/wiki/Inversion_(music)#Intervals)\n * of an interval.\n *\n * @function\n * @param {string} interval - the interval to invert in interval shorthand\n * notation or interval array notation\n * @return {string} the inverted interval\n *\n * @example\n * Interval.invert(\"3m\") // => \"6M\"\n * Interval.invert(\"2M\") // => \"7m\"\n */\nexport function invert(name: IntervalName): IntervalName {\n  const i = props(name);\n  if (i.empty) {\n    return \"\";\n  }\n  const step = (7 - i.step) % 7;\n  const alt = i.type === \"perfectable\" ? -i.alt : -(i.alt + 1);\n  return props({ step, alt, oct: i.oct, dir: i.dir }).name;\n}\n\n// interval numbers\nconst IN = [1, 2, 2, 3, 3, 4, 5, 5, 6, 6, 7, 7];\n// interval qualities\nconst IQ = \"P m M m M P d P m M m M\".split(\" \");\n\n/**\n * Get interval name from semitones number. Since there are several interval\n * names for the same number, the name it's arbitrary, but deterministic.\n *\n * @param {Integer} num - the number of semitones (can be negative)\n * @return {string} the interval name\n * @example\n * Interval.fromSemitones(7) // => \"5P\"\n * Interval.fromSemitones(-7) // => \"-5P\"\n */\nexport function fromSemitones(semitones: number): IntervalName {\n  const d = semitones < 0 ? -1 : 1;\n  const n = Math.abs(semitones);\n  const c = n % 12;\n  const o = Math.floor(n / 12);\n  return d * (IN[c] + 7 * o) + IQ[c];\n}\n\n/**\n * Find interval between two notes\n *\n * @example\n * Interval.distance(\"C4\", \"G4\"); // => \"5P\"\n */\nexport const distance = dist;\n\n/**\n * Adds two intervals\n *\n * @function\n * @param {string} interval1\n * @param {string} interval2\n * @return {string} the added interval name\n * @example\n * Interval.add(\"3m\", \"5P\") // => \"7m\"\n */\nexport const add = combinator((a, b) => [a[0] + b[0], a[1] + b[1]]);\n\n/**\n * Returns a function that adds an interval\n *\n * @function\n * @example\n * ['1P', '2M', '3M'].map(Interval.addTo('5P')) // => [\"5P\", \"6M\", \"7M\"]\n */\nexport const addTo = (interval: string) => (other: string) =>\n  add(interval, other);\n\n/**\n * Subtracts two intervals\n *\n * @function\n * @param {string} minuendInterval\n * @param {string} subtrahendInterval\n * @return {string} the substracted interval name\n * @example\n * Interval.substract('5P', '3M') // => '3m'\n * Interval.substract('3M', '5P') // => '-3m'\n */\nexport const substract = combinator((a, b) => [a[0] - b[0], a[1] - b[1]]);\n\nexport function transposeFifths(\n  interval: IntervalName,\n  fifths: number,\n): IntervalName {\n  const ivl = get(interval);\n  if (ivl.empty) return \"\";\n\n  const [nFifths, nOcts, dir] = ivl.coord;\n  return coordToInterval([nFifths + fifths, nOcts, dir]).name;\n}\n\nexport default {\n  names,\n  get,\n  name,\n  num,\n  semitones,\n  quality,\n  fromSemitones,\n  distance,\n  invert,\n  simplify,\n  add,\n  addTo,\n  substract,\n  transposeFifths,\n};\n\n//// PRIVATE ////\n\ntype Operation = (\n  a: IntervalCoordinates,\n  b: IntervalCoordinates,\n) => NoteCoordinates;\n\nfunction combinator(fn: Operation) {\n  return (a: IntervalName, b: IntervalName): IntervalName | undefined => {\n    const coordA = props(a).coord;\n    const coordB = props(b).coord;\n    if (coordA && coordB) {\n      const coord = fn(coordA, coordB);\n      return coordToInterval(coord).name;\n    }\n  };\n}\n","import { NoteName, note as props } from \"@tonaljs/pitch-note\";\n\ntype Midi = number;\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function isMidi(arg: any): arg is Midi {\n  return +arg >= 0 && +arg <= 127;\n}\n\n/**\n * Get the note midi number (a number between 0 and 127)\n *\n * It returns undefined if not valid note name\n *\n * @function\n * @param {string|number} note - the note name or midi number\n * @return {Integer} the midi number or undefined if not valid note\n * @example\n * import { toMidi } from '@tonaljs/midi'\n * toMidi(\"C4\") // => 60\n * toMidi(60) // => 60\n * toMidi('60') // => 60\n */\nexport function toMidi(note: NoteName | number): number | null {\n  if (isMidi(note)) {\n    return +note;\n  }\n  const n = props(note);\n  return n.empty ? null : n.midi;\n}\n\n/**\n * Get the frequency in hertz from midi number\n *\n * @param {number} midi - the note midi number\n * @param {number} [tuning = 440] - A4 tuning frequency in Hz (440 by default)\n * @return {number} the frequency or null if not valid note midi\n * @example\n * import { midiToFreq} from '@tonaljs/midi'\n * midiToFreq(69) // => 440\n */\nexport function midiToFreq(midi: number, tuning = 440): number {\n  return Math.pow(2, (midi - 69) / 12) * tuning;\n}\n\nconst L2 = Math.log(2);\nconst L440 = Math.log(440);\n\n/**\n * Get the midi number from a frequency in hertz. The midi number can\n * contain decimals (with two digits precision)\n *\n * @param {number} frequency\n * @return {number}\n * @example\n * import { freqToMidi} from '@tonaljs/midi'\n * freqToMidi(220)); //=> 57\n * freqToMidi(261.62)); //=> 60\n * freqToMidi(261)); //=> 59.96\n */\nexport function freqToMidi(freq: number): number {\n  const v = (12 * (Math.log(freq) - L440)) / L2 + 69;\n  return Math.round(v * 100) / 100;\n}\n\nexport interface ToNoteNameOptions {\n  pitchClass?: boolean;\n  sharps?: boolean;\n}\n\nconst SHARPS = \"C C# D D# E F F# G G# A A# B\".split(\" \");\nconst FLATS = \"C Db D Eb E F Gb G Ab A Bb B\".split(\" \");\n/**\n * Given a midi number, returns a note name. The altered notes will have\n * flats unless explicitly set with the optional `useSharps` parameter.\n *\n * @function\n * @param {number} midi - the midi note number\n * @param {Object} options = default: `{ sharps: false, pitchClass: false }`\n * @param {boolean} useSharps - (Optional) set to true to use sharps instead of flats\n * @return {string} the note name\n * @example\n * import { midiToNoteName } from '@tonaljs/midi'\n * midiToNoteName(61) // => \"Db4\"\n * midiToNoteName(61, { pitchClass: true }) // => \"Db\"\n * midiToNoteName(61, { sharps: true }) // => \"C#4\"\n * midiToNoteName(61, { pitchClass: true, sharps: true }) // => \"C#\"\n * // it rounds to nearest note\n * midiToNoteName(61.7) // => \"D4\"\n */\nexport function midiToNoteName(midi: number, options: ToNoteNameOptions = {}) {\n  if (isNaN(midi) || midi === -Infinity || midi === Infinity) return \"\";\n  midi = Math.round(midi);\n  const pcs = options.sharps === true ? SHARPS : FLATS;\n  const pc = pcs[midi % 12];\n  if (options.pitchClass) {\n    return pc;\n  }\n  const o = Math.floor(midi / 12) - 1;\n  return pc + o;\n}\n\nexport function chroma(midi: number): number {\n  return midi % 12;\n}\n\nfunction pcsetFromChroma(chroma: string): number[] {\n  return chroma.split(\"\").reduce((pcset, val, index) => {\n    if (index < 12 && val === \"1\") pcset.push(index);\n    return pcset;\n  }, [] as number[]);\n}\n\nfunction pcsetFromMidi(midi: number[]): number[] {\n  return midi\n    .map(chroma)\n    .sort((a, b) => a - b)\n    .filter((n, i, a) => i === 0 || n !== a[i - 1]);\n}\n\n/**\n * Given a list of midi numbers, returns the pitch class set (unique chroma numbers)\n * @param midi\n * @example\n *\n */\nexport function pcset(notes: number[] | string): number[] {\n  return Array.isArray(notes) ? pcsetFromMidi(notes) : pcsetFromChroma(notes);\n}\n\nexport function pcsetNearest(notes: number[] | string) {\n  const set = pcset(notes);\n  return (midi: number): number | undefined => {\n    const ch = chroma(midi);\n    for (let i = 0; i < 12; i++) {\n      if (set.includes(ch + i)) return midi + i;\n      if (set.includes(ch - i)) return midi - i;\n    }\n    return undefined;\n  };\n}\n\nexport function pcsetSteps(notes: number[] | string, tonic: number) {\n  const set = pcset(notes);\n  const len = set.length;\n  return (step: number): number => {\n    const index = step < 0 ? (len - (-step % len)) % len : step % len;\n    const octaves = Math.floor(step / len);\n    return set[index] + octaves * 12 + tonic;\n  };\n}\n\nexport function pcsetDegrees(notes: number[] | string, tonic: number) {\n  const steps = pcsetSteps(notes, tonic);\n  return (degree: number): number | undefined => {\n    if (degree === 0) return undefined;\n    return steps(degree > 0 ? degree - 1 : degree);\n  };\n}\n\n/** @deprecated */\nexport default {\n  chroma,\n  freqToMidi,\n  isMidi,\n  midiToFreq,\n  midiToNoteName,\n  pcsetNearest,\n  pcset,\n  pcsetDegrees,\n  pcsetSteps,\n  toMidi,\n};\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { freqToMidi, midiToNoteName } from \"@tonaljs/midi\";\nimport { Pitch } from \"@tonaljs/pitch\";\nimport { distance as _dist, transpose as _tr } from \"@tonaljs/pitch-distance\";\nimport { IntervalName } from \"@tonaljs/pitch-interval\";\nimport {\n  Note,\n  NoteLiteral,\n  NoteName,\n  note as props,\n} from \"@tonaljs/pitch-note\";\n\nexport type { NoteType } from \"@tonaljs/pitch-note\";\n\nconst NAMES = [\"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\"];\n\nconst toName = (n: Note) => n.name;\nconst onlyNotes = (array: any[]) =>\n  array.map(props).filter((n) => !n.empty) as Note[];\n\n/**\n * Return the natural note names without octave\n * @function\n * @example\n * Note.names(); // => [\"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\"]\n */\nexport function names(array?: any[]): string[] {\n  if (array === undefined) {\n    return NAMES.slice();\n  } else if (!Array.isArray(array)) {\n    return [];\n  } else {\n    return onlyNotes(array).map(toName);\n  }\n}\n\n/**\n * Get a note from a note name\n *\n * @function\n * @example\n * Note.get('Bb4') // => { name: \"Bb4\", midi: 70, chroma: 10, ... }\n */\nexport const get = props;\n\n/**\n * Get the note name\n * @function\n */\nexport const name = (note: NoteLiteral) => get(note).name;\n\n/**\n * Get the note pitch class name\n * @function\n */\nexport const pitchClass = (note: NoteLiteral) => get(note).pc;\n\n/**\n * Get the note accidentals\n * @function\n */\nexport const accidentals = (note: NoteLiteral) => get(note).acc;\n\n/**\n * Get the note octave\n * @function\n */\nexport const octave = (note: NoteLiteral) => get(note).oct;\n\n/**\n * Get the note midi\n * @function\n */\nexport const midi = (note: NoteLiteral) => get(note).midi;\n\n/**\n * Get the note midi\n * @function\n */\nexport const freq = (note: NoteLiteral) => get(note).freq;\n\n/**\n * Get the note chroma\n * @function\n */\nexport const chroma = (note: NoteLiteral) => get(note).chroma;\n\n/**\n * Given a midi number, returns a note name. Uses flats for altered notes.\n *\n * @function\n * @param {number} midi - the midi note number\n * @return {string} the note name\n * @example\n * Note.fromMidi(61) // => \"Db4\"\n * Note.fromMidi(61.7) // => \"D4\"\n */\nexport function fromMidi(midi: number) {\n  return midiToNoteName(midi);\n}\n\n/**\n * Given a midi number, returns a note name. Uses flats for altered notes.\n */\nexport function fromFreq(freq: number) {\n  return midiToNoteName(freqToMidi(freq));\n}\n/**\n * Given a midi number, returns a note name. Uses flats for altered notes.\n */\nexport function fromFreqSharps(freq: number) {\n  return midiToNoteName(freqToMidi(freq), { sharps: true });\n}\n\n/**\n * Given a midi number, returns a note name. Uses flats for altered notes.\n *\n * @function\n * @param {number} midi - the midi note number\n * @return {string} the note name\n * @example\n * Note.fromMidiSharps(61) // => \"C#4\"\n */\n\nexport function fromMidiSharps(midi: number) {\n  return midiToNoteName(midi, { sharps: true });\n}\n\nexport const distance = _dist;\n\n/**\n * Transpose a note by an interval\n */\nexport const transpose = _tr;\nexport const tr = _tr;\n\n/**\n * Transpose by an interval.\n * @function\n * @param {string} interval\n * @return {function} a function that transposes by the given interval\n * @example\n * [\"C\", \"D\", \"E\"].map(Note.transposeBy(\"5P\"));\n * // => [\"G\", \"A\", \"B\"]\n */\nexport const transposeBy = (interval: IntervalName) => (note: NoteName) =>\n  transpose(note, interval);\nexport const trBy = transposeBy;\n\n/**\n * Transpose from a note\n * @function\n * @param {string} note\n * @return {function}  a function that transposes the the note by an interval\n * [\"1P\", \"3M\", \"5P\"].map(Note.transposeFrom(\"C\"));\n * // => [\"C\", \"E\", \"G\"]\n */\nexport const transposeFrom = (note: NoteName) => (interval: IntervalName) =>\n  transpose(note, interval);\nexport const trFrom = transposeFrom;\n\n/**\n * Transpose a note by a number of perfect fifths.\n *\n * @function\n * @param {string} note - the note name\n * @param {number} fifths - the number of fifths\n * @return {string} the transposed note name\n *\n * @example\n * import { transposeFifths } from \"@tonaljs/note\"\n * transposeFifths(\"G4\", 1) // => \"D\"\n * [0, 1, 2, 3, 4].map(fifths => transposeFifths(\"C\", fifths)) // => [\"C\", \"G\", \"D\", \"A\", \"E\"]\n */\nexport function transposeFifths(noteName: NoteName, fifths: number): NoteName {\n  return transpose(noteName, [fifths, 0]);\n}\nexport const trFifths = transposeFifths;\n\n// TODO: documentation\nexport function transposeOctaves(\n  noteName: NoteName,\n  octaves: number,\n): NoteName {\n  return transpose(noteName, [0, octaves]);\n}\n\nexport type NoteComparator = (a: Note, b: Note) => number;\n\nexport const ascending: NoteComparator = (a, b) => a.height - b.height;\nexport const descending: NoteComparator = (a, b) => b.height - a.height;\n\nexport function sortedNames(\n  notes: any[],\n  comparator?: NoteComparator,\n): string[] {\n  comparator = comparator || ascending;\n  return onlyNotes(notes).sort(comparator).map(toName);\n}\n\nexport function sortedUniqNames(notes: any[]): string[] {\n  return sortedNames(notes, ascending).filter(\n    (n, i, a) => i === 0 || n !== a[i - 1],\n  );\n}\n\n/**\n * Simplify a note\n *\n * @function\n * @param {string} note - the note to be simplified\n * - sameAccType: default true. Use same kind of accidentals that source\n * @return {string} the simplified note or '' if not valid note\n * @example\n * simplify(\"C##\") // => \"D\"\n * simplify(\"C###\") // => \"D#\"\n * simplify(\"C###\")\n * simplify(\"B#4\") // => \"C5\"\n */\nexport const simplify = (noteName: NoteName | Pitch): string => {\n  const note = get(noteName);\n  if (note.empty) {\n    return \"\";\n  }\n  return midiToNoteName(note.midi || note.chroma, {\n    sharps: note.alt > 0,\n    pitchClass: note.midi === null,\n  });\n};\n/**\n * Get enharmonic of a note\n *\n * @function\n * @param {string} note\n * @param [string] - [optional] Destination pitch class\n * @return {string} the enharmonic note name or '' if not valid note\n * @example\n * Note.enharmonic(\"Db\") // => \"C#\"\n * Note.enharmonic(\"C\") // => \"C\"\n * Note.enharmonic(\"F2\",\"E#\") // => \"E#2\"\n * Note.enharmonic(\"C##b\"); // => \"\"\n */\nexport function enharmonic(noteName: string, destName?: string) {\n  const src = get(noteName);\n  if (src.empty) {\n    return \"\";\n  }\n\n  // destination: use given or generate one\n  const dest = get(\n    destName ||\n      midiToNoteName(src.midi || src.chroma, {\n        sharps: src.alt < 0,\n        pitchClass: true,\n      }),\n  );\n\n  // ensure destination is valid\n  if (dest.empty || dest.chroma !== src.chroma) {\n    return \"\";\n  }\n\n  // if src has no octave, no need to calculate anything else\n  if (src.oct === undefined) {\n    return dest.pc;\n  }\n\n  // detect any octave overflow\n  const srcChroma = src.chroma - src.alt;\n  const destChroma = dest.chroma - dest.alt;\n  const destOctOffset =\n    srcChroma > 11 || destChroma < 0\n      ? -1\n      : srcChroma < 0 || destChroma > 11\n        ? +1\n        : 0;\n  // calculate the new octave\n  const destOct = src.oct + destOctOffset;\n  return dest.pc + destOct;\n}\n\n/** @deprecated */\nexport default {\n  names,\n  get,\n  name,\n  pitchClass,\n  accidentals,\n  octave,\n  midi,\n  ascending,\n  descending,\n  distance,\n  sortedNames,\n  sortedUniqNames,\n  fromMidi,\n  fromMidiSharps,\n  freq,\n  fromFreq,\n  fromFreqSharps,\n  chroma,\n  transpose,\n  tr,\n  transposeBy,\n  trBy,\n  transposeFrom,\n  trFrom,\n  transposeFifths,\n  transposeOctaves,\n  trFifths,\n  simplify,\n  enharmonic,\n};\n","export interface NamedPitch {\n  readonly name: string;\n}\n\n/*** @deprecated use NamedPitch */\nexport interface Named {\n  readonly name: string;\n}\n\nexport interface NotFound extends NamedPitch {\n  readonly empty: true;\n  readonly name: \"\";\n}\n\nexport function isNamedPitch(src: unknown): src is NamedPitch {\n  return src !== null &&\n    typeof src === \"object\" &&\n    \"name\" in src &&\n    typeof src.name === \"string\"\n    ? true\n    : false;\n}\n\ntype Fifths = number;\ntype Octaves = number;\nexport type Direction = 1 | -1;\n\nexport type PitchClassCoordinates = [Fifths];\nexport type NoteCoordinates = [Fifths, Octaves];\nexport type IntervalCoordinates = [Fifths, Octaves, Direction];\nexport type PitchCoordinates =\n  | PitchClassCoordinates\n  | NoteCoordinates\n  | IntervalCoordinates;\n\n/**\n * Pitch properties\n *\n * - {number} step - The step number: 0 = C, 1 = D, ... 6 = B\n * - {number} alt - Number of alterations: -2 = 'bb', -1 = 'b', 0 = '', 1 = '#', ...\n * - {number} [oct] = The octave (undefined when is a coord class)\n * - {number} [dir] = Interval direction (undefined when is not an interval)\n */\nexport interface Pitch {\n  readonly step: number;\n  readonly alt: number;\n  readonly oct?: number; // undefined for pitch classes\n  readonly dir?: Direction; // undefined for notes\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nexport const chroma = ({ step, alt }: Pitch) => (SIZES[step] + alt + 120) % 12;\n\nexport const height = ({ step, alt, oct, dir = 1 }: Pitch) =>\n  dir * (SIZES[step] + alt + 12 * (oct === undefined ? -100 : oct));\n\nexport const midi = (pitch: Pitch) => {\n  const h = height(pitch);\n  return pitch.oct !== undefined && h >= -12 && h <= 115 ? h + 12 : null;\n};\n\nexport function isPitch(pitch: unknown): pitch is Pitch {\n  return pitch !== null &&\n    typeof pitch === \"object\" &&\n    \"step\" in pitch &&\n    typeof pitch.step === \"number\" &&\n    \"alt\" in pitch &&\n    typeof pitch.alt === \"number\" &&\n    !isNaN(pitch.step) &&\n    !isNaN(pitch.alt)\n    ? true\n    : false;\n}\n\n// The number of fifths of [C, D, E, F, G, A, B]\nconst FIFTHS = [0, 2, 4, -1, 1, 3, 5];\n// The number of octaves it span each step\nconst STEPS_TO_OCTS = FIFTHS.map((fifths: number) =>\n  Math.floor((fifths * 7) / 12),\n);\n\n/**\n * Get coordinates from pitch object\n */\nexport function coordinates(pitch: Pitch): PitchCoordinates {\n  const { step, alt, oct, dir = 1 } = pitch;\n  const f = FIFTHS[step] + 7 * alt;\n  if (oct === undefined) {\n    return [dir * f];\n  }\n  const o = oct - STEPS_TO_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n}\n\n// We need to get the steps from fifths\n// Fifths for CDEFGAB are [ 0, 2, 4, -1, 1, 3, 5 ]\n// We add 1 to fifths to avoid negative numbers, so:\n// for [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\"] we have:\nconst FIFTHS_TO_STEPS = [3, 0, 4, 1, 5, 2, 6];\n\n/**\n * Get pitch from coordinate objects\n */\nexport function pitch(coord: PitchCoordinates): Pitch {\n  const [f, o, dir] = coord;\n  const step = FIFTHS_TO_STEPS[unaltered(f)];\n  const alt = Math.floor((f + 1) / 7);\n  if (o === undefined) {\n    return { step, alt, dir };\n  }\n  const oct = o + 4 * alt + STEPS_TO_OCTS[step];\n  return { step, alt, oct, dir };\n}\n\n// Return the number of fifths as if it were unaltered\nfunction unaltered(f: number): number {\n  const i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\n","import {\n  coordinates,\n  Direction,\n  IntervalCoordinates,\n  isNamedPitch,\n  isPitch,\n  NamedPitch,\n  Pitch,\n  pitch,\n  PitchCoordinates,\n} from \"@tonaljs/pitch\";\n\nconst fillStr = (s: string, n: number) => Array(Math.abs(n) + 1).join(s);\n\nexport type IntervalName = string;\nexport type IntervalLiteral = IntervalName | Pitch | NamedPitch;\n\ntype Quality =\n  | \"dddd\"\n  | \"ddd\"\n  | \"dd\"\n  | \"d\"\n  | \"m\"\n  | \"M\"\n  | \"P\"\n  | \"A\"\n  | \"AA\"\n  | \"AAA\"\n  | \"AAAA\";\ntype Type = \"perfectable\" | \"majorable\";\n\nexport interface Interval extends Pitch, NamedPitch {\n  readonly empty: boolean;\n  readonly name: IntervalName;\n  readonly num: number;\n  readonly q: Quality;\n  readonly type: Type;\n  readonly step: number;\n  readonly alt: number;\n  readonly dir: Direction;\n  readonly simple: number;\n  readonly semitones: number;\n  readonly chroma: number;\n  readonly coord: IntervalCoordinates;\n  readonly oct: number;\n}\n\nexport type IntervalType = Interval;\n\nconst NoInterval: Interval = Object.freeze({\n  empty: true,\n  name: \"\",\n  num: NaN,\n  q: \"\" as Quality,\n  type: \"\" as Type,\n  step: NaN,\n  alt: NaN,\n  dir: NaN as Direction,\n  simple: NaN,\n  semitones: NaN,\n  chroma: NaN,\n  coord: [] as unknown as IntervalCoordinates,\n  oct: NaN,\n});\n\n// shorthand tonal notation (with quality after number)\nconst INTERVAL_TONAL_REGEX = \"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\";\n// standard shorthand notation (with quality before number)\nconst INTERVAL_SHORTHAND_REGEX = \"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\";\nconst REGEX = new RegExp(\n  \"^\" + INTERVAL_TONAL_REGEX + \"|\" + INTERVAL_SHORTHAND_REGEX + \"$\",\n);\n\ntype IntervalTokens = [string, string];\n\n/**\n * @private\n */\nexport function tokenizeInterval(str?: IntervalName): IntervalTokens {\n  const m = REGEX.exec(`${str}`);\n  if (m === null) {\n    return [\"\", \"\"];\n  }\n  return m[1] ? [m[1], m[2]] : [m[4], m[3]];\n}\n\nconst cache: { [key in string]: Interval } = {};\n\n/**\n * Get interval properties. It returns an object with:\n *\n * - name: the interval name\n * - num: the interval number\n * - type: 'perfectable' or 'majorable'\n * - q: the interval quality (d, m, M, A)\n * - dir: interval direction (1 ascending, -1 descending)\n * - simple: the simplified number\n * - semitones: the size in semitones\n * - chroma: the interval chroma\n *\n * @param {string} interval - the interval name\n * @return {Object} the interval properties\n *\n * @example\n * import { interval } from '@tonaljs/core'\n * interval('P5').semitones // => 7\n * interval('m3').type // => 'majorable'\n */\nexport function interval(src: IntervalLiteral): Interval {\n  return typeof src === \"string\"\n    ? cache[src] || (cache[src] = parse(src))\n    : isPitch(src)\n      ? interval(pitchName(src))\n      : isNamedPitch(src)\n        ? interval(src.name)\n        : NoInterval;\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nconst TYPES = \"PMMPPMM\";\nfunction parse(str?: string): Interval {\n  const tokens = tokenizeInterval(str);\n  if (tokens[0] === \"\") {\n    return NoInterval;\n  }\n  const num = +tokens[0];\n  const q = tokens[1] as Quality;\n  const step = (Math.abs(num) - 1) % 7;\n  const t = TYPES[step];\n  if (t === \"M\" && q === \"P\") {\n    return NoInterval;\n  }\n  const type = t === \"M\" ? \"majorable\" : \"perfectable\";\n\n  const name = \"\" + num + q;\n  const dir = num < 0 ? -1 : 1;\n  const simple = num === 8 || num === -8 ? num : dir * (step + 1);\n  const alt = qToAlt(type, q);\n  const oct = Math.floor((Math.abs(num) - 1) / 7);\n  const semitones = dir * (SIZES[step] + alt + 12 * oct);\n  const chroma = (((dir * (SIZES[step] + alt)) % 12) + 12) % 12;\n  const coord = coordinates({ step, alt, oct, dir }) as IntervalCoordinates;\n  return {\n    empty: false,\n    name,\n    num,\n    q,\n    step,\n    alt,\n    dir,\n    type,\n    simple,\n    semitones,\n    chroma,\n    coord,\n    oct,\n  };\n}\n\n/**\n * @private\n *\n * forceDescending is used in the case of unison (#243)\n */\nexport function coordToInterval(\n  coord: PitchCoordinates,\n  forceDescending?: boolean,\n): Interval {\n  const [f, o = 0] = coord;\n  const isDescending = f * 7 + o * 12 < 0;\n  const ivl: IntervalCoordinates =\n    forceDescending || isDescending ? [-f, -o, -1] : [f, o, 1];\n  return interval(pitch(ivl)) as Interval;\n}\n\nfunction qToAlt(type: Type, q: string): number {\n  return (q === \"M\" && type === \"majorable\") ||\n    (q === \"P\" && type === \"perfectable\")\n    ? 0\n    : q === \"m\" && type === \"majorable\"\n      ? -1\n      : /^A+$/.test(q)\n        ? q.length\n        : /^d+$/.test(q)\n          ? -1 * (type === \"perfectable\" ? q.length : q.length + 1)\n          : 0;\n}\n\n// return the interval name of a pitch\nfunction pitchName(props: Pitch): string {\n  const { step, alt, oct = 0, dir } = props;\n  if (!dir) {\n    return \"\";\n  }\n  const calcNum = step + 1 + 7 * oct;\n  // this is an edge case: descending pitch class unison (see #243)\n  const num = calcNum === 0 ? step + 1 : calcNum;\n  const d = dir < 0 ? \"-\" : \"\";\n  const type = TYPES[step] === \"M\" ? \"majorable\" : \"perfectable\";\n  const name = d + num + altToQ(type, alt);\n  return name;\n}\n\nfunction altToQ(type: Type, alt: number): Quality {\n  if (alt === 0) {\n    return type === \"majorable\" ? \"M\" : \"P\";\n  } else if (alt === -1 && type === \"majorable\") {\n    return \"m\";\n  } else if (alt > 0) {\n    return fillStr(\"A\", alt) as Quality;\n  } else {\n    return fillStr(\"d\", type === \"perfectable\" ? alt : alt + 1) as Quality;\n  }\n}\n","import { isNamedPitch, isPitch, Pitch } from \"@tonaljs/pitch\";\nimport { interval } from \"@tonaljs/pitch-interval\";\nimport { accToAlt, altToAcc } from \"@tonaljs/pitch-note\";\n\nexport interface RomanNumeral extends Pitch {\n  readonly name: string;\n  readonly empty: boolean;\n  readonly roman: string;\n  readonly interval: string;\n  readonly acc: string;\n  readonly chordType: string;\n  readonly major: boolean;\n  readonly dir: 1;\n}\n\nexport interface NoRomanNumeral extends Partial<RomanNumeral> {\n  readonly empty: true;\n  readonly name: \"\";\n  readonly chordType: \"\";\n}\nconst NoRomanNumeral: NoRomanNumeral = { empty: true, name: \"\", chordType: \"\" };\n\nconst cache: Record<string, RomanNumeral | NoRomanNumeral> = {};\n\n/**\n * Get properties of a roman numeral string\n *\n * @function\n * @param {string} - the roman numeral string (can have type, like: Imaj7)\n * @return {Object} - the roman numeral properties\n * @param {string} name - the roman numeral (tonic)\n * @param {string} type - the chord type\n * @param {string} num - the number (1 = I, 2 = II...)\n * @param {boolean} major - major or not\n *\n * @example\n * romanNumeral(\"VIIb5\") // => { name: \"VII\", type: \"b5\", num: 7, major: true }\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function get(src: any): RomanNumeral | NoRomanNumeral {\n  return typeof src === \"string\"\n    ? cache[src] || (cache[src] = parse(src))\n    : typeof src === \"number\"\n      ? get(NAMES[src] || \"\")\n      : isPitch(src)\n        ? fromPitch(src)\n        : isNamedPitch(src)\n          ? get(src.name)\n          : NoRomanNumeral;\n}\n\n/**\n * @deprecated\n * @use RomanNumeral.get\n */\nexport const romanNumeral = get;\n\n/**\n * Get roman numeral names\n *\n * @function\n * @param {boolean} [isMajor=true]\n * @return {Array<String>}\n *\n * @example\n * names() // => [\"I\", \"II\", \"III\", \"IV\", \"V\", \"VI\", \"VII\"]\n */\nexport function names(major = true) {\n  return (major ? NAMES : NAMES_MINOR).slice();\n}\n\nfunction fromPitch(pitch: Pitch): RomanNumeral | NoRomanNumeral {\n  return get(altToAcc(pitch.alt) + NAMES[pitch.step]);\n}\n\nconst REGEX =\n  /^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;\n\n// [name, accidentals, romanNumeral, chordType]\ntype RomanNumeralTokens = [string, string, string, string];\nexport function tokenize(str: string): RomanNumeralTokens {\n  return (REGEX.exec(str) || [\"\", \"\", \"\", \"\"]) as RomanNumeralTokens;\n}\n\nconst ROMANS = \"I II III IV V VI VII\";\nconst NAMES = ROMANS.split(\" \");\nconst NAMES_MINOR = ROMANS.toLowerCase().split(\" \");\n\nfunction parse(src: string): RomanNumeral | NoRomanNumeral {\n  const [name, acc, roman, chordType] = tokenize(src);\n  if (!roman) {\n    return NoRomanNumeral;\n  }\n\n  const upperRoman = roman.toUpperCase();\n  const step = NAMES.indexOf(upperRoman);\n  const alt = accToAlt(acc);\n  const dir = 1;\n  return {\n    empty: false,\n    name,\n    roman,\n    interval: interval({ step, alt, dir }).name,\n    acc,\n    chordType,\n    alt,\n    step,\n    major: roman === upperRoman,\n    oct: 0,\n    dir,\n  };\n}\n\n/** @deprecated */\nexport default {\n  names,\n  get,\n  // deprecated\n  romanNumeral,\n};\n","import { transpose, transposeFifths } from \"@tonaljs/note\";\nimport { accToAlt, altToAcc, note } from \"@tonaljs/pitch-note\";\nimport { get as roman } from \"@tonaljs/roman-numeral\";\n\nconst Empty: readonly string[] = Object.freeze([] as string[]);\n\nexport interface Key {\n  readonly type: \"major\" | \"minor\";\n  readonly tonic: string;\n  readonly alteration: number;\n  readonly keySignature: string;\n}\n\nconst NoKey: Key = {\n  type: \"major\",\n  tonic: \"\",\n  alteration: 0,\n  keySignature: \"\",\n};\n\nexport interface KeyScale {\n  readonly tonic: string;\n  readonly grades: readonly string[];\n  readonly intervals: readonly string[];\n  readonly scale: readonly string[];\n  readonly triads: readonly string[];\n  readonly chords: readonly string[];\n  readonly chordsHarmonicFunction: readonly string[];\n  readonly chordScales: readonly string[];\n  readonly secondaryDominants: readonly string[];\n  readonly secondaryDominantSupertonics: readonly string[];\n  readonly substituteDominants: readonly string[];\n  readonly substituteDominantSupertonics: readonly string[];\n\n  // @deprecated use secondaryDominantsSupertonic\n  readonly secondaryDominantsMinorRelative: readonly string[];\n  // @deprecated use substituteDominantSupertonics\n  readonly substituteDominantsMinorRelative: readonly string[];\n}\n\nconst NoKeyScale: KeyScale = {\n  tonic: \"\",\n  grades: Empty,\n  intervals: Empty,\n  scale: Empty,\n  triads: Empty,\n  chords: Empty,\n  chordsHarmonicFunction: Empty,\n  chordScales: Empty,\n  secondaryDominants: Empty,\n  secondaryDominantSupertonics: Empty,\n  substituteDominantsMinorRelative: Empty,\n  substituteDominants: Empty,\n  substituteDominantSupertonics: Empty,\n  secondaryDominantsMinorRelative: Empty,\n};\n\nexport interface MajorKey extends Key, KeyScale {\n  readonly type: \"major\";\n  readonly minorRelative: string;\n  readonly scale: readonly string[];\n  readonly substituteDominants: readonly string[];\n  readonly secondaryDominantSupertonics: readonly string[];\n  // @deprecated use secondaryDominantsSupertonic\n  readonly substituteDominantsMinorRelative: readonly string[];\n}\n\nconst NoMajorKey: MajorKey = {\n  ...NoKey,\n  ...NoKeyScale,\n  type: \"major\",\n  minorRelative: \"\",\n  scale: Empty,\n  substituteDominants: Empty,\n  secondaryDominantSupertonics: Empty,\n  substituteDominantsMinorRelative: Empty,\n};\n\nexport interface MinorKey extends Key {\n  readonly type: \"minor\";\n  readonly relativeMajor: string;\n  readonly natural: KeyScale;\n  readonly harmonic: KeyScale;\n  readonly melodic: KeyScale;\n}\n\nconst NoMinorKey: MinorKey = {\n  ...NoKey,\n  type: \"minor\",\n  relativeMajor: \"\",\n  natural: NoKeyScale,\n  harmonic: NoKeyScale,\n  melodic: NoKeyScale,\n};\n\nexport type KeyChord = {\n  name: string;\n  roles: string[];\n};\n\nconst mapScaleToType = (scale: string[], list: string[], sep = \"\") =>\n  list.map((type, i) => `${scale[i]}${sep}${type}`);\n\nfunction keyScale(\n  grades: string[],\n  triads: string[],\n  chordTypes: string[],\n  harmonicFunctions: string[],\n  chordScales: string[],\n) {\n  return (tonic: string): KeyScale => {\n    const intervals = grades.map((gr) => roman(gr).interval || \"\");\n    const scale = intervals.map((interval) => transpose(tonic, interval));\n    const chords = mapScaleToType(scale, chordTypes);\n    const secondaryDominants = scale\n      .map((note) => transpose(note, \"5P\"))\n      .map((note) =>\n        // A secondary dominant is a V chord which:\n        // 1. is not diatonic to the key,\n        // 2. it must have a diatonic root.\n        scale.includes(note) && !chords.includes(note + \"7\") ? note + \"7\" : \"\",\n      );\n\n    const secondaryDominantSupertonics = supertonics(\n      secondaryDominants,\n      triads,\n    );\n    const substituteDominants = secondaryDominants.map((chord) => {\n      if (!chord) return \"\";\n      const domRoot = chord.slice(0, -1);\n      const subRoot = transpose(domRoot, \"5d\");\n      return subRoot + \"7\";\n    });\n    const substituteDominantSupertonics = supertonics(\n      substituteDominants,\n      triads,\n    );\n\n    return {\n      tonic,\n      grades,\n      intervals,\n      scale,\n      triads: mapScaleToType(scale, triads),\n      chords,\n      chordsHarmonicFunction: harmonicFunctions.slice(),\n      chordScales: mapScaleToType(scale, chordScales, \" \"),\n      secondaryDominants,\n      secondaryDominantSupertonics,\n      substituteDominants,\n      substituteDominantSupertonics,\n\n      // @deprecated use secondaryDominantsSupertonic\n      secondaryDominantsMinorRelative: secondaryDominantSupertonics,\n      // @deprecated use secondaryDominantsSupertonic\n      substituteDominantsMinorRelative: substituteDominantSupertonics,\n    };\n  };\n}\n\nconst supertonics = (dominants: string[], targetTriads: string[]) => {\n  return dominants.map((chord, index) => {\n    if (!chord) return \"\";\n    const domRoot = chord.slice(0, -1);\n    const minorRoot = transpose(domRoot, \"5P\");\n    const target = targetTriads[index];\n    const isMinor = target.endsWith(\"m\");\n    return isMinor ? minorRoot + \"m7\" : minorRoot + \"m7b5\";\n  });\n};\n\nconst distInFifths = (from: string, to: string) => {\n  const f = note(from);\n  const t = note(to);\n  return f.empty || t.empty ? 0 : t.coord[0] - f.coord[0];\n};\n\nconst MajorScale = keyScale(\n  \"I II III IV V VI VII\".split(\" \"),\n  \" m m   m dim\".split(\" \"),\n  \"maj7 m7 m7 maj7 7 m7 m7b5\".split(\" \"),\n  \"T SD T SD D T D\".split(\" \"),\n  \"major,dorian,phrygian,lydian,mixolydian,minor,locrian\".split(\",\"),\n);\nconst NaturalScale = keyScale(\n  \"I II bIII IV V bVI bVII\".split(\" \"),\n  \"m dim  m m  \".split(\" \"),\n  \"m7 m7b5 maj7 m7 m7 maj7 7\".split(\" \"),\n  \"T SD T SD D SD SD\".split(\" \"),\n  \"minor,locrian,major,dorian,phrygian,lydian,mixolydian\".split(\",\"),\n);\nconst HarmonicScale = keyScale(\n  \"I II bIII IV V bVI VII\".split(\" \"),\n  \"m dim aug m   dim\".split(\" \"),\n  \"mMaj7 m7b5 +maj7 m7 7 maj7 o7\".split(\" \"),\n  \"T SD T SD D SD D\".split(\" \"),\n  \"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian\".split(\n    \",\",\n  ),\n);\nconst MelodicScale = keyScale(\n  \"I II bIII IV V VI VII\".split(\" \"),\n  \"m m aug   dim dim\".split(\" \"),\n  \"m6 m7 +maj7 7 7 m7b5 m7b5\".split(\" \"),\n  \"T SD T SD D  \".split(\" \"),\n  \"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered\".split(\n    \",\",\n  ),\n);\n\n/**\n * Get a major key properties in a given tonic\n * @param tonic\n */\nexport function majorKey(tonic: string): MajorKey {\n  const pc = note(tonic).pc;\n  if (!pc) return NoMajorKey;\n\n  const keyScale = MajorScale(pc);\n  const alteration = distInFifths(\"C\", pc);\n\n  return {\n    ...keyScale,\n    type: \"major\",\n    minorRelative: transpose(pc, \"-3m\"),\n    alteration,\n    keySignature: altToAcc(alteration),\n  };\n}\n\n/**\n * Get a list of available chords for a given major key\n * @param tonic\n * @returns array of { name: string, roles: string[] }\n */\nexport function majorKeyChords(tonic: string): KeyChord[] {\n  const key = majorKey(tonic);\n  const chords: KeyChord[] = [];\n  keyChordsOf(key, chords);\n  return chords;\n}\n\n/**\n * Get a list of available chords for a given major key\n * @param tonic\n * @returns array of { name: string, roles: string[] }\n */\nexport function minorKeyChords(tonic: string): KeyChord[] {\n  const key = minorKey(tonic);\n  const chords: KeyChord[] = [];\n  keyChordsOf(key.natural, chords);\n  keyChordsOf(key.harmonic, chords);\n  keyChordsOf(key.melodic, chords);\n  return chords;\n}\n\nfunction keyChordsOf(key: KeyScale, chords: KeyChord[]) {\n  const updateChord = (name: string, newRole: string) => {\n    if (!name) return;\n    let keyChord = chords.find((chord) => chord.name === name);\n    if (!keyChord) {\n      keyChord = { name, roles: [] };\n      chords.push(keyChord);\n    }\n    if (newRole && !keyChord.roles.includes(newRole)) {\n      keyChord.roles.push(newRole);\n    }\n  };\n\n  key.chords.forEach((chordName, index) =>\n    updateChord(chordName, key.chordsHarmonicFunction[index]),\n  );\n  key.secondaryDominants.forEach((chordName, index) =>\n    updateChord(chordName, `V/${key.grades[index]}`),\n  );\n  key.secondaryDominantSupertonics.forEach((chordName, index) =>\n    updateChord(chordName, `ii/${key.grades[index]}`),\n  );\n  key.substituteDominants.forEach((chordName, index) =>\n    updateChord(chordName, `subV/${key.grades[index]}`),\n  );\n  key.substituteDominantSupertonics.forEach((chordName, index) =>\n    updateChord(chordName, `subii/${key.grades[index]}`),\n  );\n}\n\n/**\n * Get minor key properties in a given tonic\n * @param tonic\n */\nexport function minorKey(tnc: string): MinorKey {\n  const pc = note(tnc).pc;\n  if (!pc) return NoMinorKey;\n\n  const alteration = distInFifths(\"C\", pc) - 3;\n  return {\n    type: \"minor\",\n    tonic: pc,\n    relativeMajor: transpose(pc, \"3m\"),\n    alteration,\n    keySignature: altToAcc(alteration),\n    natural: NaturalScale(pc),\n    harmonic: HarmonicScale(pc),\n    melodic: MelodicScale(pc),\n  };\n}\n\n/**\n * Given a key signature, returns the tonic of the major key\n * @param signature\n * @example\n * majorTonicFromKeySignature('###') // => 'A'\n */\nexport function majorTonicFromKeySignature(\n  sig: string | number,\n): string | null {\n  if (typeof sig === \"number\") {\n    return transposeFifths(\"C\", sig);\n  } else if (typeof sig === \"string\" && /^b+|#+$/.test(sig)) {\n    return transposeFifths(\"C\", accToAlt(sig));\n  }\n  return null;\n}\n\n/** @deprecated */\nexport default { majorKey, majorTonicFromKeySignature, minorKey };\n","export interface NamedPitch {\n  readonly name: string;\n}\n\n/*** @deprecated use NamedPitch */\nexport interface Named {\n  readonly name: string;\n}\n\nexport interface NotFound extends NamedPitch {\n  readonly empty: true;\n  readonly name: \"\";\n}\n\nexport function isNamedPitch(src: unknown): src is NamedPitch {\n  return src !== null &&\n    typeof src === \"object\" &&\n    \"name\" in src &&\n    typeof src.name === \"string\"\n    ? true\n    : false;\n}\n\ntype Fifths = number;\ntype Octaves = number;\nexport type Direction = 1 | -1;\n\nexport type PitchClassCoordinates = [Fifths];\nexport type NoteCoordinates = [Fifths, Octaves];\nexport type IntervalCoordinates = [Fifths, Octaves, Direction];\nexport type PitchCoordinates =\n  | PitchClassCoordinates\n  | NoteCoordinates\n  | IntervalCoordinates;\n\n/**\n * Pitch properties\n *\n * - {number} step - The step number: 0 = C, 1 = D, ... 6 = B\n * - {number} alt - Number of alterations: -2 = 'bb', -1 = 'b', 0 = '', 1 = '#', ...\n * - {number} [oct] = The octave (undefined when is a coord class)\n * - {number} [dir] = Interval direction (undefined when is not an interval)\n */\nexport interface Pitch {\n  readonly step: number;\n  readonly alt: number;\n  readonly oct?: number; // undefined for pitch classes\n  readonly dir?: Direction; // undefined for notes\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nexport const chroma = ({ step, alt }: Pitch) => (SIZES[step] + alt + 120) % 12;\n\nexport const height = ({ step, alt, oct, dir = 1 }: Pitch) =>\n  dir * (SIZES[step] + alt + 12 * (oct === undefined ? -100 : oct));\n\nexport const midi = (pitch: Pitch) => {\n  const h = height(pitch);\n  return pitch.oct !== undefined && h >= -12 && h <= 115 ? h + 12 : null;\n};\n\nexport function isPitch(pitch: unknown): pitch is Pitch {\n  return pitch !== null &&\n    typeof pitch === \"object\" &&\n    \"step\" in pitch &&\n    typeof pitch.step === \"number\" &&\n    \"alt\" in pitch &&\n    typeof pitch.alt === \"number\" &&\n    !isNaN(pitch.step) &&\n    !isNaN(pitch.alt)\n    ? true\n    : false;\n}\n\n// The number of fifths of [C, D, E, F, G, A, B]\nconst FIFTHS = [0, 2, 4, -1, 1, 3, 5];\n// The number of octaves it span each step\nconst STEPS_TO_OCTS = FIFTHS.map((fifths: number) =>\n  Math.floor((fifths * 7) / 12),\n);\n\n/**\n * Get coordinates from pitch object\n */\nexport function coordinates(pitch: Pitch): PitchCoordinates {\n  const { step, alt, oct, dir = 1 } = pitch;\n  const f = FIFTHS[step] + 7 * alt;\n  if (oct === undefined) {\n    return [dir * f];\n  }\n  const o = oct - STEPS_TO_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n}\n\n// We need to get the steps from fifths\n// Fifths for CDEFGAB are [ 0, 2, 4, -1, 1, 3, 5 ]\n// We add 1 to fifths to avoid negative numbers, so:\n// for [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\"] we have:\nconst FIFTHS_TO_STEPS = [3, 0, 4, 1, 5, 2, 6];\n\n/**\n * Get pitch from coordinate objects\n */\nexport function pitch(coord: PitchCoordinates): Pitch {\n  const [f, o, dir] = coord;\n  const step = FIFTHS_TO_STEPS[unaltered(f)];\n  const alt = Math.floor((f + 1) / 7);\n  if (o === undefined) {\n    return { step, alt, dir };\n  }\n  const oct = o + 4 * alt + STEPS_TO_OCTS[step];\n  return { step, alt, oct, dir };\n}\n\n// Return the number of fifths as if it were unaltered\nfunction unaltered(f: number): number {\n  const i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\n","import {\n  coordinates,\n  Direction,\n  IntervalCoordinates,\n  isNamedPitch,\n  isPitch,\n  NamedPitch,\n  Pitch,\n  pitch,\n  PitchCoordinates,\n} from \"@tonaljs/pitch\";\n\nconst fillStr = (s: string, n: number) => Array(Math.abs(n) + 1).join(s);\n\nexport type IntervalName = string;\nexport type IntervalLiteral = IntervalName | Pitch | NamedPitch;\n\ntype Quality =\n  | \"dddd\"\n  | \"ddd\"\n  | \"dd\"\n  | \"d\"\n  | \"m\"\n  | \"M\"\n  | \"P\"\n  | \"A\"\n  | \"AA\"\n  | \"AAA\"\n  | \"AAAA\";\ntype Type = \"perfectable\" | \"majorable\";\n\nexport interface Interval extends Pitch, NamedPitch {\n  readonly empty: boolean;\n  readonly name: IntervalName;\n  readonly num: number;\n  readonly q: Quality;\n  readonly type: Type;\n  readonly step: number;\n  readonly alt: number;\n  readonly dir: Direction;\n  readonly simple: number;\n  readonly semitones: number;\n  readonly chroma: number;\n  readonly coord: IntervalCoordinates;\n  readonly oct: number;\n}\n\nexport type IntervalType = Interval;\n\nconst NoInterval: Interval = Object.freeze({\n  empty: true,\n  name: \"\",\n  num: NaN,\n  q: \"\" as Quality,\n  type: \"\" as Type,\n  step: NaN,\n  alt: NaN,\n  dir: NaN as Direction,\n  simple: NaN,\n  semitones: NaN,\n  chroma: NaN,\n  coord: [] as unknown as IntervalCoordinates,\n  oct: NaN,\n});\n\n// shorthand tonal notation (with quality after number)\nconst INTERVAL_TONAL_REGEX = \"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\";\n// standard shorthand notation (with quality before number)\nconst INTERVAL_SHORTHAND_REGEX = \"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\";\nconst REGEX = new RegExp(\n  \"^\" + INTERVAL_TONAL_REGEX + \"|\" + INTERVAL_SHORTHAND_REGEX + \"$\",\n);\n\ntype IntervalTokens = [string, string];\n\n/**\n * @private\n */\nexport function tokenizeInterval(str?: IntervalName): IntervalTokens {\n  const m = REGEX.exec(`${str}`);\n  if (m === null) {\n    return [\"\", \"\"];\n  }\n  return m[1] ? [m[1], m[2]] : [m[4], m[3]];\n}\n\nconst cache: { [key in string]: Interval } = {};\n\n/**\n * Get interval properties. It returns an object with:\n *\n * - name: the interval name\n * - num: the interval number\n * - type: 'perfectable' or 'majorable'\n * - q: the interval quality (d, m, M, A)\n * - dir: interval direction (1 ascending, -1 descending)\n * - simple: the simplified number\n * - semitones: the size in semitones\n * - chroma: the interval chroma\n *\n * @param {string} interval - the interval name\n * @return {Object} the interval properties\n *\n * @example\n * import { interval } from '@tonaljs/core'\n * interval('P5').semitones // => 7\n * interval('m3').type // => 'majorable'\n */\nexport function interval(src: IntervalLiteral): Interval {\n  return typeof src === \"string\"\n    ? cache[src] || (cache[src] = parse(src))\n    : isPitch(src)\n      ? interval(pitchName(src))\n      : isNamedPitch(src)\n        ? interval(src.name)\n        : NoInterval;\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nconst TYPES = \"PMMPPMM\";\nfunction parse(str?: string): Interval {\n  const tokens = tokenizeInterval(str);\n  if (tokens[0] === \"\") {\n    return NoInterval;\n  }\n  const num = +tokens[0];\n  const q = tokens[1] as Quality;\n  const step = (Math.abs(num) - 1) % 7;\n  const t = TYPES[step];\n  if (t === \"M\" && q === \"P\") {\n    return NoInterval;\n  }\n  const type = t === \"M\" ? \"majorable\" : \"perfectable\";\n\n  const name = \"\" + num + q;\n  const dir = num < 0 ? -1 : 1;\n  const simple = num === 8 || num === -8 ? num : dir * (step + 1);\n  const alt = qToAlt(type, q);\n  const oct = Math.floor((Math.abs(num) - 1) / 7);\n  const semitones = dir * (SIZES[step] + alt + 12 * oct);\n  const chroma = (((dir * (SIZES[step] + alt)) % 12) + 12) % 12;\n  const coord = coordinates({ step, alt, oct, dir }) as IntervalCoordinates;\n  return {\n    empty: false,\n    name,\n    num,\n    q,\n    step,\n    alt,\n    dir,\n    type,\n    simple,\n    semitones,\n    chroma,\n    coord,\n    oct,\n  };\n}\n\n/**\n * @private\n *\n * forceDescending is used in the case of unison (#243)\n */\nexport function coordToInterval(\n  coord: PitchCoordinates,\n  forceDescending?: boolean,\n): Interval {\n  const [f, o = 0] = coord;\n  const isDescending = f * 7 + o * 12 < 0;\n  const ivl: IntervalCoordinates =\n    forceDescending || isDescending ? [-f, -o, -1] : [f, o, 1];\n  return interval(pitch(ivl)) as Interval;\n}\n\nfunction qToAlt(type: Type, q: string): number {\n  return (q === \"M\" && type === \"majorable\") ||\n    (q === \"P\" && type === \"perfectable\")\n    ? 0\n    : q === \"m\" && type === \"majorable\"\n      ? -1\n      : /^A+$/.test(q)\n        ? q.length\n        : /^d+$/.test(q)\n          ? -1 * (type === \"perfectable\" ? q.length : q.length + 1)\n          : 0;\n}\n\n// return the interval name of a pitch\nfunction pitchName(props: Pitch): string {\n  const { step, alt, oct = 0, dir } = props;\n  if (!dir) {\n    return \"\";\n  }\n  const calcNum = step + 1 + 7 * oct;\n  // this is an edge case: descending pitch class unison (see #243)\n  const num = calcNum === 0 ? step + 1 : calcNum;\n  const d = dir < 0 ? \"-\" : \"\";\n  const type = TYPES[step] === \"M\" ? \"majorable\" : \"perfectable\";\n  const name = d + num + altToQ(type, alt);\n  return name;\n}\n\nfunction altToQ(type: Type, alt: number): Quality {\n  if (alt === 0) {\n    return type === \"majorable\" ? \"M\" : \"P\";\n  } else if (alt === -1 && type === \"majorable\") {\n    return \"m\";\n  } else if (alt > 0) {\n    return fillStr(\"A\", alt) as Quality;\n  } else {\n    return fillStr(\"d\", type === \"perfectable\" ? alt : alt + 1) as Quality;\n  }\n}\n","import { IntervalCoordinates, NoteCoordinates } from \"@tonaljs/pitch\";\nimport { distance as dist } from \"@tonaljs/pitch-distance\";\nimport {\n  IntervalName,\n  coordToInterval,\n  interval as props,\n} from \"@tonaljs/pitch-interval\";\n\n/**\n * Get the natural list of names\n */\nexport function names(): IntervalName[] {\n  return \"1P 2M 3M 4P 5P 6m 7m\".split(\" \");\n}\n\n/**\n * Get properties of an interval\n *\n * @function\n * @example\n * Interval.get('P4') // => {\"alt\": 0,  \"dir\": 1,  \"name\": \"4P\", \"num\": 4, \"oct\": 0, \"q\": \"P\", \"semitones\": 5, \"simple\": 4, \"step\": 3, \"type\": \"perfectable\"}\n */\nexport const get = props;\n\n/**\n * Get name of an interval\n *\n * @function\n * @example\n * Interval.name('4P') // => \"4P\"\n * Interval.name('P4') // => \"4P\"\n * Interval.name('C4') // => \"\"\n */\nexport const name = (name: string) => props(name).name;\n\n/**\n * Get semitones of an interval\n * @function\n * @example\n * Interval.semitones('P4') // => 5\n */\nexport const semitones = (name: string) => props(name).semitones;\n\n/**\n * Get quality of an interval\n * @function\n * @example\n * Interval.quality('P4') // => \"P\"\n */\nexport const quality = (name: string) => props(name).q;\n\n/**\n * Get number of an interval\n * @function\n * @example\n * Interval.num('P4') // => 4\n */\nexport const num = (name: string) => props(name).num;\n\n/**\n * Get the simplified version of an interval.\n *\n * @function\n * @param {string} interval - the interval to simplify\n * @return {string} the simplified interval\n *\n * @example\n * Interval.simplify(\"9M\") // => \"2M\"\n * Interval.simplify(\"2M\") // => \"2M\"\n * Interval.simplify(\"-2M\") // => \"7m\"\n * [\"8P\", \"9M\", \"10M\", \"11P\", \"12P\", \"13M\", \"14M\", \"15P\"].map(Interval.simplify)\n * // => [ \"8P\", \"2M\", \"3M\", \"4P\", \"5P\", \"6M\", \"7M\", \"8P\" ]\n */\nexport function simplify(name: IntervalName): IntervalName {\n  const i = props(name);\n  return i.empty ? \"\" : i.simple + i.q;\n}\n\n/**\n * Get the inversion (https://en.wikipedia.org/wiki/Inversion_(music)#Intervals)\n * of an interval.\n *\n * @function\n * @param {string} interval - the interval to invert in interval shorthand\n * notation or interval array notation\n * @return {string} the inverted interval\n *\n * @example\n * Interval.invert(\"3m\") // => \"6M\"\n * Interval.invert(\"2M\") // => \"7m\"\n */\nexport function invert(name: IntervalName): IntervalName {\n  const i = props(name);\n  if (i.empty) {\n    return \"\";\n  }\n  const step = (7 - i.step) % 7;\n  const alt = i.type === \"perfectable\" ? -i.alt : -(i.alt + 1);\n  return props({ step, alt, oct: i.oct, dir: i.dir }).name;\n}\n\n// interval numbers\nconst IN = [1, 2, 2, 3, 3, 4, 5, 5, 6, 6, 7, 7];\n// interval qualities\nconst IQ = \"P m M m M P d P m M m M\".split(\" \");\n\n/**\n * Get interval name from semitones number. Since there are several interval\n * names for the same number, the name it's arbitrary, but deterministic.\n *\n * @param {Integer} num - the number of semitones (can be negative)\n * @return {string} the interval name\n * @example\n * Interval.fromSemitones(7) // => \"5P\"\n * Interval.fromSemitones(-7) // => \"-5P\"\n */\nexport function fromSemitones(semitones: number): IntervalName {\n  const d = semitones < 0 ? -1 : 1;\n  const n = Math.abs(semitones);\n  const c = n % 12;\n  const o = Math.floor(n / 12);\n  return d * (IN[c] + 7 * o) + IQ[c];\n}\n\n/**\n * Find interval between two notes\n *\n * @example\n * Interval.distance(\"C4\", \"G4\"); // => \"5P\"\n */\nexport const distance = dist;\n\n/**\n * Adds two intervals\n *\n * @function\n * @param {string} interval1\n * @param {string} interval2\n * @return {string} the added interval name\n * @example\n * Interval.add(\"3m\", \"5P\") // => \"7m\"\n */\nexport const add = combinator((a, b) => [a[0] + b[0], a[1] + b[1]]);\n\n/**\n * Returns a function that adds an interval\n *\n * @function\n * @example\n * ['1P', '2M', '3M'].map(Interval.addTo('5P')) // => [\"5P\", \"6M\", \"7M\"]\n */\nexport const addTo = (interval: string) => (other: string) =>\n  add(interval, other);\n\n/**\n * Subtracts two intervals\n *\n * @function\n * @param {string} minuendInterval\n * @param {string} subtrahendInterval\n * @return {string} the subtracted interval name\n * @example\n * Interval.subtract('5P', '3M') // => '3m'\n * Interval.subtract('3M', '5P') // => '-3m'\n */\nexport const subtract = combinator((a, b) => [a[0] - b[0], a[1] - b[1]]);\n\nexport function transposeFifths(\n  interval: IntervalName,\n  fifths: number,\n): IntervalName {\n  const ivl = get(interval);\n  if (ivl.empty) return \"\";\n\n  const [nFifths, nOcts, dir] = ivl.coord;\n  return coordToInterval([nFifths + fifths, nOcts, dir]).name;\n}\n\n/** @deprecated */\nexport default {\n  names,\n  get,\n  name,\n  num,\n  semitones,\n  quality,\n  fromSemitones,\n  distance,\n  invert,\n  simplify,\n  add,\n  addTo,\n  subtract,\n  transposeFifths,\n};\n\n//// PRIVATE ////\n\ntype Operation = (\n  a: IntervalCoordinates,\n  b: IntervalCoordinates,\n) => NoteCoordinates;\n\nfunction combinator(fn: Operation) {\n  return (a: IntervalName, b: IntervalName): IntervalName | undefined => {\n    const coordA = props(a).coord;\n    const coordB = props(b).coord;\n    if (coordA && coordB) {\n      const coord = fn(coordA, coordB);\n      return coordToInterval(coord).name;\n    }\n  };\n}\n","import { rotate } from \"@tonaljs/collection\";\nimport { simplify, transposeFifths } from \"@tonaljs/interval\";\nimport { EmptyPcset, Pcset } from \"@tonaljs/pcset\";\nimport { transpose } from \"@tonaljs/pitch-distance\";\nimport { NoteName } from \"@tonaljs/pitch-note\";\nimport { get as getType } from \"@tonaljs/scale-type\";\n\nconst MODES = [\n  [0, 2773, 0, \"ionian\", \"\", \"Maj7\", \"major\"],\n  [1, 2902, 2, \"dorian\", \"m\", \"m7\"],\n  [2, 3418, 4, \"phrygian\", \"m\", \"m7\"],\n  [3, 2741, -1, \"lydian\", \"\", \"Maj7\"],\n  [4, 2774, 1, \"mixolydian\", \"\", \"7\"],\n  [5, 2906, 3, \"aeolian\", \"m\", \"m7\", \"minor\"],\n  [6, 3434, 5, \"locrian\", \"dim\", \"m7b5\"],\n] as const;\n\ntype ModeDatum = (typeof MODES)[number];\n\nexport interface Mode extends Pcset {\n  readonly name: string;\n  readonly modeNum: number;\n  readonly alt: number; // number of alterations === number of fifths\n  readonly triad: string;\n  readonly seventh: string;\n  readonly aliases: string[];\n}\n\nconst NoMode: Mode = {\n  ...EmptyPcset,\n  name: \"\",\n  alt: 0,\n  modeNum: NaN,\n  triad: \"\",\n  seventh: \"\",\n  aliases: [],\n};\n\nconst modes: Mode[] = MODES.map(toMode);\nconst index: Record<string, Mode> = {};\nmodes.forEach((mode) => {\n  index[mode.name] = mode;\n  mode.aliases.forEach((alias) => {\n    index[alias] = mode;\n  });\n});\n\ntype ModeLiteral = string | { name: string };\n\n/**\n * Get a Mode by it's name\n *\n * @example\n * get('dorian')\n * // =>\n * // {\n * //   intervals: [ '1P', '2M', '3m', '4P', '5P', '6M', '7m' ],\n * //   modeNum: 1,\n * //   chroma: '101101010110',\n * //   normalized: '101101010110',\n * //   name: 'dorian',\n * //   setNum: 2902,\n * //   alt: 2,\n * //   triad: 'm',\n * //   seventh: 'm7',\n * //   aliases: []\n * // }\n */\nexport function get(name: ModeLiteral): Mode {\n  return typeof name === \"string\"\n    ? index[name.toLowerCase()] || NoMode\n    : name && name.name\n      ? get(name.name)\n      : NoMode;\n}\n\n/** @deprecated */\nexport const mode = get;\n\n/**\n * Get a list of all modes\n */\nexport function all() {\n  return modes.slice();\n}\n\n/** @deprecated */\nexport const entries = all;\n\n/**\n * Get a list of all mode names\n */\nexport function names() {\n  return modes.map((mode) => mode.name);\n}\n\nfunction toMode(mode: ModeDatum): Mode {\n  const [modeNum, setNum, alt, name, triad, seventh, alias] = mode;\n  const aliases = alias ? [alias] : [];\n  const chroma = Number(setNum).toString(2);\n  const intervals = getType(name).intervals;\n  return {\n    empty: false,\n    intervals,\n    modeNum,\n    chroma,\n    normalized: chroma,\n    name,\n    setNum,\n    alt,\n    triad,\n    seventh,\n    aliases,\n  };\n}\n\nexport function notes(modeName: ModeLiteral, tonic: NoteName) {\n  return get(modeName).intervals.map((ivl) => transpose(tonic, ivl));\n}\n\nfunction chords(chords: string[]) {\n  return (modeName: ModeLiteral, tonic: NoteName) => {\n    const mode = get(modeName);\n    if (mode.empty) return [];\n    const triads = rotate(mode.modeNum, chords);\n    const tonics = mode.intervals.map((i) => transpose(tonic, i));\n    return triads.map((triad, i) => tonics[i] + triad);\n  };\n}\n\nexport const triads = chords(MODES.map((x) => x[4]));\nexport const seventhChords = chords(MODES.map((x) => x[5]));\n\nexport function distance(destination: ModeLiteral, source: ModeLiteral) {\n  const from = get(source);\n  const to = get(destination);\n  if (from.empty || to.empty) return \"\";\n  return simplify(transposeFifths(\"1P\", to.alt - from.alt));\n}\n\nexport function relativeTonic(\n  destination: ModeLiteral,\n  source: ModeLiteral,\n  tonic: NoteName,\n) {\n  return transpose(tonic, distance(destination, source));\n}\n\n/** @deprecated */\nexport default {\n  get,\n  names,\n  all,\n  distance,\n  relativeTonic,\n  notes,\n  triads,\n  seventhChords,\n  // deprecated\n  entries,\n  mode,\n};\n","/**\n * @private\n * Chord List\n * Source: https://en.wikibooks.org/wiki/Music_Theory/Complete_List_of_Chord_Patterns\n * Format: [\"intervals\", \"full name\", \"abrv1 abrv2\"]\n */\nconst CHORDS: string[][] = [\n  // ==Major==\n  [\"1P 3M 5P\", \"major\", \"M ^  maj\"],\n  [\"1P 3M 5P 7M\", \"major seventh\", \"maj7  ma7 M7 Maj7 ^7\"],\n  [\"1P 3M 5P 7M 9M\", \"major ninth\", \"maj9 9 ^9\"],\n  [\"1P 3M 5P 7M 9M 13M\", \"major thirteenth\", \"maj13 Maj13 ^13\"],\n  [\"1P 3M 5P 6M\", \"sixth\", \"6 add6 add13 M6\"],\n  [\"1P 3M 5P 6M 9M\", \"sixth added ninth\", \"6add9 6/9 69 M69\"],\n  [\"1P 3M 6m 7M\", \"major seventh flat sixth\", \"M7b6 ^7b6\"],\n  [\n    \"1P 3M 5P 7M 11A\",\n    \"major seventh sharp eleventh\",\n    \"maj#4 #4 #11 M7#11 ^7#11 maj7#11\",\n  ],\n  // ==Minor==\n  // '''Normal'''\n  [\"1P 3m 5P\", \"minor\", \"m min -\"],\n  [\"1P 3m 5P 7m\", \"minor seventh\", \"m7 min7 mi7 -7\"],\n  [\n    \"1P 3m 5P 7M\",\n    \"minor/major seventh\",\n    \"m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7\",\n  ],\n  [\"1P 3m 5P 6M\", \"minor sixth\", \"m6 -6\"],\n  [\"1P 3m 5P 7m 9M\", \"minor ninth\", \"m9 -9\"],\n  [\"1P 3m 5P 7M 9M\", \"minor/major ninth\", \"mM9 mMaj9 -^9\"],\n  [\"1P 3m 5P 7m 9M 11P\", \"minor eleventh\", \"m11 -11\"],\n  [\"1P 3m 5P 7m 9M 13M\", \"minor thirteenth\", \"m13 -13\"],\n  // '''Diminished'''\n  [\"1P 3m 5d\", \"diminished\", \"dim  o\"],\n  [\"1P 3m 5d 7d\", \"diminished seventh\", \"dim7 7 o7\"],\n  [\"1P 3m 5d 7m\", \"half-diminished\", \"m7b5  -7b5 h7 h\"],\n  // ==Dominant/Seventh==\n  // '''Normal'''\n  [\"1P 3M 5P 7m\", \"dominant seventh\", \"7 dom\"],\n  [\"1P 3M 5P 7m 9M\", \"dominant ninth\", \"9\"],\n  [\"1P 3M 5P 7m 9M 13M\", \"dominant thirteenth\", \"13\"],\n  [\"1P 3M 5P 7m 11A\", \"lydian dominant seventh\", \"7#11 7#4\"],\n  // '''Altered'''\n  [\"1P 3M 5P 7m 9m\", \"dominant flat ninth\", \"7b9\"],\n  [\"1P 3M 5P 7m 9A\", \"dominant sharp ninth\", \"7#9\"],\n  [\"1P 3M 7m 9m\", \"altered\", \"alt7\"],\n  // '''Suspended'''\n  [\"1P 4P 5P\", \"suspended fourth\", \"sus4 sus\"],\n  [\"1P 2M 5P\", \"suspended second\", \"sus2\"],\n  [\"1P 4P 5P 7m\", \"suspended fourth seventh\", \"7sus4 7sus\"],\n  [\"1P 5P 7m 9M 11P\", \"eleventh\", \"11\"],\n  [\n    \"1P 4P 5P 7m 9m\",\n    \"suspended fourth flat ninth\",\n    \"b9sus phryg 7b9sus 7b9sus4\",\n  ],\n  // ==Other==\n  [\"1P 5P\", \"fifth\", \"5\"],\n  [\"1P 3M 5A\", \"augmented\", \"aug + +5 ^#5\"],\n  [\"1P 3m 5A\", \"minor augmented\", \"m#5 -#5 m+\"],\n  [\"1P 3M 5A 7M\", \"augmented seventh\", \"maj7#5 maj7+5 +maj7 ^7#5\"],\n  [\n    \"1P 3M 5P 7M 9M 11A\",\n    \"major sharp eleventh (lydian)\",\n    \"maj9#11 9#11 ^9#11\",\n  ],\n  // ==Legacy==\n  [\"1P 2M 4P 5P\", \"\", \"sus24 sus4add9\"],\n  [\"1P 3M 5A 7M 9M\", \"\", \"maj9#5 Maj9#5\"],\n  [\"1P 3M 5A 7m\", \"\", \"7#5 +7 7+ 7aug aug7\"],\n  [\"1P 3M 5A 7m 9A\", \"\", \"7#5#9 7#9#5 7alt\"],\n  [\"1P 3M 5A 7m 9M\", \"\", \"9#5 9+\"],\n  [\"1P 3M 5A 7m 9M 11A\", \"\", \"9#5#11\"],\n  [\"1P 3M 5A 7m 9m\", \"\", \"7#5b9 7b9#5\"],\n  [\"1P 3M 5A 7m 9m 11A\", \"\", \"7#5b9#11\"],\n  [\"1P 3M 5A 9A\", \"\", \"+add#9\"],\n  [\"1P 3M 5A 9M\", \"\", \"M#5add9 +add9\"],\n  [\"1P 3M 5P 6M 11A\", \"\", \"M6#11 M6b5 6#11 6b5\"],\n  [\"1P 3M 5P 6M 7M 9M\", \"\", \"M7add13\"],\n  [\"1P 3M 5P 6M 9M 11A\", \"\", \"69#11\"],\n  [\"1P 3m 5P 6M 9M\", \"\", \"m69 -69\"],\n  [\"1P 3M 5P 6m 7m\", \"\", \"7b6\"],\n  [\"1P 3M 5P 7M 9A 11A\", \"\", \"maj7#9#11\"],\n  [\"1P 3M 5P 7M 9M 11A 13M\", \"\", \"M13#11 maj13#11 M13+4 M13#4\"],\n  [\"1P 3M 5P 7M 9m\", \"\", \"M7b9\"],\n  [\"1P 3M 5P 7m 11A 13m\", \"\", \"7#11b13 7b5b13\"],\n  [\"1P 3M 5P 7m 13M\", \"\", \"7add6 67 7add13\"],\n  [\"1P 3M 5P 7m 9A 11A\", \"\", \"7#9#11 7b5#9 7#9b5\"],\n  [\"1P 3M 5P 7m 9A 11A 13M\", \"\", \"13#9#11\"],\n  [\"1P 3M 5P 7m 9A 11A 13m\", \"\", \"7#9#11b13\"],\n  [\"1P 3M 5P 7m 9A 13M\", \"\", \"13#9\"],\n  [\"1P 3M 5P 7m 9A 13m\", \"\", \"7#9b13\"],\n  [\"1P 3M 5P 7m 9M 11A\", \"\", \"9#11 9+4 9#4\"],\n  [\"1P 3M 5P 7m 9M 11A 13M\", \"\", \"13#11 13+4 13#4\"],\n  [\"1P 3M 5P 7m 9M 11A 13m\", \"\", \"9#11b13 9b5b13\"],\n  [\"1P 3M 5P 7m 9m 11A\", \"\", \"7b9#11 7b5b9 7b9b5\"],\n  [\"1P 3M 5P 7m 9m 11A 13M\", \"\", \"13b9#11\"],\n  [\"1P 3M 5P 7m 9m 11A 13m\", \"\", \"7b9b13#11 7b9#11b13 7b5b9b13\"],\n  [\"1P 3M 5P 7m 9m 13M\", \"\", \"13b9\"],\n  [\"1P 3M 5P 7m 9m 13m\", \"\", \"7b9b13\"],\n  [\"1P 3M 5P 7m 9m 9A\", \"\", \"7b9#9\"],\n  [\"1P 3M 5P 9M\", \"\", \"Madd9 2 add9 add2\"],\n  [\"1P 3M 5P 9m\", \"\", \"Maddb9\"],\n  [\"1P 3M 5d\", \"\", \"Mb5\"],\n  [\"1P 3M 5d 6M 7m 9M\", \"\", \"13b5\"],\n  [\"1P 3M 5d 7M\", \"\", \"M7b5\"],\n  [\"1P 3M 5d 7M 9M\", \"\", \"M9b5\"],\n  [\"1P 3M 5d 7m\", \"\", \"7b5\"],\n  [\"1P 3M 5d 7m 9M\", \"\", \"9b5\"],\n  [\"1P 3M 7m\", \"\", \"7no5\"],\n  [\"1P 3M 7m 13m\", \"\", \"7b13\"],\n  [\"1P 3M 7m 9M\", \"\", \"9no5\"],\n  [\"1P 3M 7m 9M 13M\", \"\", \"13no5\"],\n  [\"1P 3M 7m 9M 13m\", \"\", \"9b13\"],\n  [\"1P 3m 4P 5P\", \"\", \"madd4\"],\n  [\"1P 3m 5P 6m 7M\", \"\", \"mMaj7b6\"],\n  [\"1P 3m 5P 6m 7M 9M\", \"\", \"mMaj9b6\"],\n  [\"1P 3m 5P 7m 11P\", \"\", \"m7add11 m7add4\"],\n  [\"1P 3m 5P 9M\", \"\", \"madd9\"],\n  [\"1P 3m 5d 6M 7M\", \"\", \"o7M7\"],\n  [\"1P 3m 5d 7M\", \"\", \"oM7\"],\n  [\"1P 3m 6m 7M\", \"\", \"mb6M7\"],\n  [\"1P 3m 6m 7m\", \"\", \"m7#5\"],\n  [\"1P 3m 6m 7m 9M\", \"\", \"m9#5\"],\n  [\"1P 3m 5A 7m 9M 11P\", \"\", \"m11A\"],\n  [\"1P 3m 6m 9m\", \"\", \"mb6b9\"],\n  [\"1P 2M 3m 5d 7m\", \"\", \"m9b5\"],\n  [\"1P 4P 5A 7M\", \"\", \"M7#5sus4\"],\n  [\"1P 4P 5A 7M 9M\", \"\", \"M9#5sus4\"],\n  [\"1P 4P 5A 7m\", \"\", \"7#5sus4\"],\n  [\"1P 4P 5P 7M\", \"\", \"M7sus4\"],\n  [\"1P 4P 5P 7M 9M\", \"\", \"M9sus4\"],\n  [\"1P 4P 5P 7m 9M\", \"\", \"9sus4 9sus\"],\n  [\"1P 4P 5P 7m 9M 13M\", \"\", \"13sus4 13sus\"],\n  [\"1P 4P 5P 7m 9m 13m\", \"\", \"7sus4b9b13 7b9b13sus4\"],\n  [\"1P 4P 7m 10m\", \"\", \"4 quartal\"],\n  [\"1P 5P 7m 9m 11P\", \"\", \"11b9\"],\n];\n\nexport default CHORDS;\n","import {\n  EmptyPcset,\n  get as pcset,\n  Pcset,\n  PcsetChroma,\n  PcsetNum,\n} from \"@tonaljs/pcset\";\nimport data from \"./data\";\n\nexport type ChordQuality =\n  | \"Major\"\n  | \"Minor\"\n  | \"Augmented\"\n  | \"Diminished\"\n  | \"Unknown\";\n\nexport interface ChordType extends Pcset {\n  name: string;\n  quality: ChordQuality;\n  aliases: string[];\n}\nconst NoChordType: ChordType = {\n  ...EmptyPcset,\n  name: \"\",\n  quality: \"Unknown\",\n  intervals: [],\n  aliases: [],\n};\n\ntype ChordTypeName = string | PcsetChroma | PcsetNum;\n\nlet dictionary: ChordType[] = [];\nlet index: Record<ChordTypeName, ChordType> = {};\n\n/**\n * Given a chord name or chroma, return the chord properties\n * @param {string} source - chord name or pitch class set chroma\n * @example\n * import { get } from 'tonaljs/chord-type'\n * get('major') // => { name: 'major', ... }\n */\nexport function get(type: ChordTypeName): ChordType {\n  return index[type] || NoChordType;\n}\n\n/** @deprecated */\nexport const chordType = get;\n\n/**\n * Get all chord (long) names\n */\nexport function names() {\n  return dictionary.map((chord) => chord.name).filter((x) => x);\n}\n\n/**\n * Get all chord symbols\n */\nexport function symbols() {\n  return dictionary.map((chord) => chord.aliases[0]).filter((x) => x);\n}\n\n/**\n * Keys used to reference chord types\n */\nexport function keys() {\n  return Object.keys(index);\n}\n\n/**\n * Return a list of all chord types\n */\nexport function all(): ChordType[] {\n  return dictionary.slice();\n}\n\n/** @deprecated */\nexport const entries = all;\n\n/**\n * Clear the dictionary\n */\nexport function removeAll() {\n  dictionary = [];\n  index = {};\n}\n\n/**\n * Add a chord to the dictionary.\n * @param intervals\n * @param aliases\n * @param [fullName]\n */\nexport function add(intervals: string[], aliases: string[], fullName?: string) {\n  const quality = getQuality(intervals);\n  const chord = {\n    ...pcset(intervals),\n    name: fullName || \"\",\n    quality,\n    intervals,\n    aliases,\n  };\n  dictionary.push(chord);\n  if (chord.name) {\n    index[chord.name] = chord;\n  }\n  index[chord.setNum] = chord;\n  index[chord.chroma] = chord;\n  chord.aliases.forEach((alias) => addAlias(chord, alias));\n}\n\nexport function addAlias(chord: ChordType, alias: string) {\n  index[alias] = chord;\n}\n\nfunction getQuality(intervals: string[]): ChordQuality {\n  const has = (interval: string) => intervals.indexOf(interval) !== -1;\n  return has(\"5A\")\n    ? \"Augmented\"\n    : has(\"3M\")\n      ? \"Major\"\n      : has(\"5d\")\n        ? \"Diminished\"\n        : has(\"3m\")\n          ? \"Minor\"\n          : \"Unknown\";\n}\n\ndata.forEach(([ivls, fullName, names]: string[]) =>\n  add(ivls.split(\" \"), names.split(\" \"), fullName),\n);\ndictionary.sort((a, b) => a.setNum - b.setNum);\n\n/** @deprecated */\nexport default {\n  names,\n  symbols,\n  get,\n  all,\n  add,\n  removeAll,\n  keys,\n  // deprecated\n  entries,\n  chordType,\n};\n","export interface NamedPitch {\n  readonly name: string;\n}\n\n/*** @deprecated use NamedPitch */\nexport interface Named {\n  readonly name: string;\n}\n\nexport interface NotFound extends NamedPitch {\n  readonly empty: true;\n  readonly name: \"\";\n}\n\nexport function isNamedPitch(src: unknown): src is NamedPitch {\n  return src !== null &&\n    typeof src === \"object\" &&\n    \"name\" in src &&\n    typeof src.name === \"string\"\n    ? true\n    : false;\n}\n\ntype Fifths = number;\ntype Octaves = number;\nexport type Direction = 1 | -1;\n\nexport type PitchClassCoordinates = [Fifths];\nexport type NoteCoordinates = [Fifths, Octaves];\nexport type IntervalCoordinates = [Fifths, Octaves, Direction];\nexport type PitchCoordinates =\n  | PitchClassCoordinates\n  | NoteCoordinates\n  | IntervalCoordinates;\n\n/**\n * Pitch properties\n *\n * - {number} step - The step number: 0 = C, 1 = D, ... 6 = B\n * - {number} alt - Number of alterations: -2 = 'bb', -1 = 'b', 0 = '', 1 = '#', ...\n * - {number} [oct] = The octave (undefined when is a coord class)\n * - {number} [dir] = Interval direction (undefined when is not an interval)\n */\nexport interface Pitch {\n  readonly step: number;\n  readonly alt: number;\n  readonly oct?: number; // undefined for pitch classes\n  readonly dir?: Direction; // undefined for notes\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nexport const chroma = ({ step, alt }: Pitch) => (SIZES[step] + alt + 120) % 12;\n\nexport const height = ({ step, alt, oct, dir = 1 }: Pitch) =>\n  dir * (SIZES[step] + alt + 12 * (oct === undefined ? -100 : oct));\n\nexport const midi = (pitch: Pitch) => {\n  const h = height(pitch);\n  return pitch.oct !== undefined && h >= -12 && h <= 115 ? h + 12 : null;\n};\n\nexport function isPitch(pitch: unknown): pitch is Pitch {\n  return pitch !== null &&\n    typeof pitch === \"object\" &&\n    \"step\" in pitch &&\n    typeof pitch.step === \"number\" &&\n    \"alt\" in pitch &&\n    typeof pitch.alt === \"number\" &&\n    !isNaN(pitch.step) &&\n    !isNaN(pitch.alt)\n    ? true\n    : false;\n}\n\n// The number of fifths of [C, D, E, F, G, A, B]\nconst FIFTHS = [0, 2, 4, -1, 1, 3, 5];\n// The number of octaves it span each step\nconst STEPS_TO_OCTS = FIFTHS.map((fifths: number) =>\n  Math.floor((fifths * 7) / 12),\n);\n\n/**\n * Get coordinates from pitch object\n */\nexport function coordinates(pitch: Pitch): PitchCoordinates {\n  const { step, alt, oct, dir = 1 } = pitch;\n  const f = FIFTHS[step] + 7 * alt;\n  if (oct === undefined) {\n    return [dir * f];\n  }\n  const o = oct - STEPS_TO_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n}\n\n// We need to get the steps from fifths\n// Fifths for CDEFGAB are [ 0, 2, 4, -1, 1, 3, 5 ]\n// We add 1 to fifths to avoid negative numbers, so:\n// for [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\"] we have:\nconst FIFTHS_TO_STEPS = [3, 0, 4, 1, 5, 2, 6];\n\n/**\n * Get pitch from coordinate objects\n */\nexport function pitch(coord: PitchCoordinates): Pitch {\n  const [f, o, dir] = coord;\n  const step = FIFTHS_TO_STEPS[unaltered(f)];\n  const alt = Math.floor((f + 1) / 7);\n  if (o === undefined) {\n    return { step, alt, dir };\n  }\n  const oct = o + 4 * alt + STEPS_TO_OCTS[step];\n  return { step, alt, oct, dir };\n}\n\n// Return the number of fifths as if it were unaltered\nfunction unaltered(f: number): number {\n  const i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\n","import {\n  coordinates,\n  Direction,\n  IntervalCoordinates,\n  isNamedPitch,\n  isPitch,\n  NamedPitch,\n  Pitch,\n  pitch,\n  PitchCoordinates,\n} from \"@tonaljs/pitch\";\n\nconst fillStr = (s: string, n: number) => Array(Math.abs(n) + 1).join(s);\n\nexport type IntervalName = string;\nexport type IntervalLiteral = IntervalName | Pitch | NamedPitch;\n\ntype Quality =\n  | \"dddd\"\n  | \"ddd\"\n  | \"dd\"\n  | \"d\"\n  | \"m\"\n  | \"M\"\n  | \"P\"\n  | \"A\"\n  | \"AA\"\n  | \"AAA\"\n  | \"AAAA\";\ntype Type = \"perfectable\" | \"majorable\";\n\nexport interface Interval extends Pitch, NamedPitch {\n  readonly empty: boolean;\n  readonly name: IntervalName;\n  readonly num: number;\n  readonly q: Quality;\n  readonly type: Type;\n  readonly step: number;\n  readonly alt: number;\n  readonly dir: Direction;\n  readonly simple: number;\n  readonly semitones: number;\n  readonly chroma: number;\n  readonly coord: IntervalCoordinates;\n  readonly oct: number;\n}\n\nexport type IntervalType = Interval;\n\nconst NoInterval: Interval = Object.freeze({\n  empty: true,\n  name: \"\",\n  num: NaN,\n  q: \"\" as Quality,\n  type: \"\" as Type,\n  step: NaN,\n  alt: NaN,\n  dir: NaN as Direction,\n  simple: NaN,\n  semitones: NaN,\n  chroma: NaN,\n  coord: [] as unknown as IntervalCoordinates,\n  oct: NaN,\n});\n\n// shorthand tonal notation (with quality after number)\nconst INTERVAL_TONAL_REGEX = \"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\";\n// standard shorthand notation (with quality before number)\nconst INTERVAL_SHORTHAND_REGEX = \"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\";\nconst REGEX = new RegExp(\n  \"^\" + INTERVAL_TONAL_REGEX + \"|\" + INTERVAL_SHORTHAND_REGEX + \"$\",\n);\n\ntype IntervalTokens = [string, string];\n\n/**\n * @private\n */\nexport function tokenizeInterval(str?: IntervalName): IntervalTokens {\n  const m = REGEX.exec(`${str}`);\n  if (m === null) {\n    return [\"\", \"\"];\n  }\n  return m[1] ? [m[1], m[2]] : [m[4], m[3]];\n}\n\nconst cache: { [key in string]: Interval } = {};\n\n/**\n * Get interval properties. It returns an object with:\n *\n * - name: the interval name\n * - num: the interval number\n * - type: 'perfectable' or 'majorable'\n * - q: the interval quality (d, m, M, A)\n * - dir: interval direction (1 ascending, -1 descending)\n * - simple: the simplified number\n * - semitones: the size in semitones\n * - chroma: the interval chroma\n *\n * @param {string} interval - the interval name\n * @return {Object} the interval properties\n *\n * @example\n * import { interval } from '@tonaljs/core'\n * interval('P5').semitones // => 7\n * interval('m3').type // => 'majorable'\n */\nexport function interval(src: IntervalLiteral): Interval {\n  return typeof src === \"string\"\n    ? cache[src] || (cache[src] = parse(src))\n    : isPitch(src)\n      ? interval(pitchName(src))\n      : isNamedPitch(src)\n        ? interval(src.name)\n        : NoInterval;\n}\n\nconst SIZES = [0, 2, 4, 5, 7, 9, 11];\nconst TYPES = \"PMMPPMM\";\nfunction parse(str?: string): Interval {\n  const tokens = tokenizeInterval(str);\n  if (tokens[0] === \"\") {\n    return NoInterval;\n  }\n  const num = +tokens[0];\n  const q = tokens[1] as Quality;\n  const step = (Math.abs(num) - 1) % 7;\n  const t = TYPES[step];\n  if (t === \"M\" && q === \"P\") {\n    return NoInterval;\n  }\n  const type = t === \"M\" ? \"majorable\" : \"perfectable\";\n\n  const name = \"\" + num + q;\n  const dir = num < 0 ? -1 : 1;\n  const simple = num === 8 || num === -8 ? num : dir * (step + 1);\n  const alt = qToAlt(type, q);\n  const oct = Math.floor((Math.abs(num) - 1) / 7);\n  const semitones = dir * (SIZES[step] + alt + 12 * oct);\n  const chroma = (((dir * (SIZES[step] + alt)) % 12) + 12) % 12;\n  const coord = coordinates({ step, alt, oct, dir }) as IntervalCoordinates;\n  return {\n    empty: false,\n    name,\n    num,\n    q,\n    step,\n    alt,\n    dir,\n    type,\n    simple,\n    semitones,\n    chroma,\n    coord,\n    oct,\n  };\n}\n\n/**\n * @private\n *\n * forceDescending is used in the case of unison (#243)\n */\nexport function coordToInterval(\n  coord: PitchCoordinates,\n  forceDescending?: boolean,\n): Interval {\n  const [f, o = 0] = coord;\n  const isDescending = f * 7 + o * 12 < 0;\n  const ivl: IntervalCoordinates =\n    forceDescending || isDescending ? [-f, -o, -1] : [f, o, 1];\n  return interval(pitch(ivl)) as Interval;\n}\n\nfunction qToAlt(type: Type, q: string): number {\n  return (q === \"M\" && type === \"majorable\") ||\n    (q === \"P\" && type === \"perfectable\")\n    ? 0\n    : q === \"m\" && type === \"majorable\"\n      ? -1\n      : /^A+$/.test(q)\n        ? q.length\n        : /^d+$/.test(q)\n          ? -1 * (type === \"perfectable\" ? q.length : q.length + 1)\n          : 0;\n}\n\n// return the interval name of a pitch\nfunction pitchName(props: Pitch): string {\n  const { step, alt, oct = 0, dir } = props;\n  if (!dir) {\n    return \"\";\n  }\n  const calcNum = step + 1 + 7 * oct;\n  // this is an edge case: descending pitch class unison (see #243)\n  const num = calcNum === 0 ? step + 1 : calcNum;\n  const d = dir < 0 ? \"-\" : \"\";\n  const type = TYPES[step] === \"M\" ? \"majorable\" : \"perfectable\";\n  const name = d + num + altToQ(type, alt);\n  return name;\n}\n\nfunction altToQ(type: Type, alt: number): Quality {\n  if (alt === 0) {\n    return type === \"majorable\" ? \"M\" : \"P\";\n  } else if (alt === -1 && type === \"majorable\") {\n    return \"m\";\n  } else if (alt > 0) {\n    return fillStr(\"A\", alt) as Quality;\n  } else {\n    return fillStr(\"d\", type === \"perfectable\" ? alt : alt + 1) as Quality;\n  }\n}\n","import { IntervalCoordinates, NoteCoordinates } from \"@tonaljs/pitch\";\nimport { distance as dist } from \"@tonaljs/pitch-distance\";\nimport {\n  IntervalName,\n  coordToInterval,\n  interval as props,\n} from \"@tonaljs/pitch-interval\";\n\n/**\n * Get the natural list of names\n */\nexport function names(): IntervalName[] {\n  return \"1P 2M 3M 4P 5P 6m 7m\".split(\" \");\n}\n\n/**\n * Get properties of an interval\n *\n * @function\n * @example\n * Interval.get('P4') // => {\"alt\": 0,  \"dir\": 1,  \"name\": \"4P\", \"num\": 4, \"oct\": 0, \"q\": \"P\", \"semitones\": 5, \"simple\": 4, \"step\": 3, \"type\": \"perfectable\"}\n */\nexport const get = props;\n\n/**\n * Get name of an interval\n *\n * @function\n * @example\n * Interval.name('4P') // => \"4P\"\n * Interval.name('P4') // => \"4P\"\n * Interval.name('C4') // => \"\"\n */\nexport const name = (name: string) => props(name).name;\n\n/**\n * Get semitones of an interval\n * @function\n * @example\n * Interval.semitones('P4') // => 5\n */\nexport const semitones = (name: string) => props(name).semitones;\n\n/**\n * Get quality of an interval\n * @function\n * @example\n * Interval.quality('P4') // => \"P\"\n */\nexport const quality = (name: string) => props(name).q;\n\n/**\n * Get number of an interval\n * @function\n * @example\n * Interval.num('P4') // => 4\n */\nexport const num = (name: string) => props(name).num;\n\n/**\n * Get the simplified version of an interval.\n *\n * @function\n * @param {string} interval - the interval to simplify\n * @return {string} the simplified interval\n *\n * @example\n * Interval.simplify(\"9M\") // => \"2M\"\n * Interval.simplify(\"2M\") // => \"2M\"\n * Interval.simplify(\"-2M\") // => \"7m\"\n * [\"8P\", \"9M\", \"10M\", \"11P\", \"12P\", \"13M\", \"14M\", \"15P\"].map(Interval.simplify)\n * // => [ \"8P\", \"2M\", \"3M\", \"4P\", \"5P\", \"6M\", \"7M\", \"8P\" ]\n */\nexport function simplify(name: IntervalName): IntervalName {\n  const i = props(name);\n  return i.empty ? \"\" : i.simple + i.q;\n}\n\n/**\n * Get the inversion (https://en.wikipedia.org/wiki/Inversion_(music)#Intervals)\n * of an interval.\n *\n * @function\n * @param {string} interval - the interval to invert in interval shorthand\n * notation or interval array notation\n * @return {string} the inverted interval\n *\n * @example\n * Interval.invert(\"3m\") // => \"6M\"\n * Interval.invert(\"2M\") // => \"7m\"\n */\nexport function invert(name: IntervalName): IntervalName {\n  const i = props(name);\n  if (i.empty) {\n    return \"\";\n  }\n  const step = (7 - i.step) % 7;\n  const alt = i.type === \"perfectable\" ? -i.alt : -(i.alt + 1);\n  return props({ step, alt, oct: i.oct, dir: i.dir }).name;\n}\n\n// interval numbers\nconst IN = [1, 2, 2, 3, 3, 4, 5, 5, 6, 6, 7, 7];\n// interval qualities\nconst IQ = \"P m M m M P d P m M m M\".split(\" \");\n\n/**\n * Get interval name from semitones number. Since there are several interval\n * names for the same number, the name it's arbitrary, but deterministic.\n *\n * @param {Integer} num - the number of semitones (can be negative)\n * @return {string} the interval name\n * @example\n * Interval.fromSemitones(7) // => \"5P\"\n * Interval.fromSemitones(-7) // => \"-5P\"\n */\nexport function fromSemitones(semitones: number): IntervalName {\n  const d = semitones < 0 ? -1 : 1;\n  const n = Math.abs(semitones);\n  const c = n % 12;\n  const o = Math.floor(n / 12);\n  return d * (IN[c] + 7 * o) + IQ[c];\n}\n\n/**\n * Find interval between two notes\n *\n * @example\n * Interval.distance(\"C4\", \"G4\"); // => \"5P\"\n */\nexport const distance = dist;\n\n/**\n * Adds two intervals\n *\n * @function\n * @param {string} interval1\n * @param {string} interval2\n * @return {string} the added interval name\n * @example\n * Interval.add(\"3m\", \"5P\") // => \"7m\"\n */\nexport const add = combinator((a, b) => [a[0] + b[0], a[1] + b[1]]);\n\n/**\n * Returns a function that adds an interval\n *\n * @function\n * @example\n * ['1P', '2M', '3M'].map(Interval.addTo('5P')) // => [\"5P\", \"6M\", \"7M\"]\n */\nexport const addTo = (interval: string) => (other: string) =>\n  add(interval, other);\n\n/**\n * Subtracts two intervals\n *\n * @function\n * @param {string} minuendInterval\n * @param {string} subtrahendInterval\n * @return {string} the subtracted interval name\n * @example\n * Interval.subtract('5P', '3M') // => '3m'\n * Interval.subtract('3M', '5P') // => '-3m'\n */\nexport const subtract = combinator((a, b) => [a[0] - b[0], a[1] - b[1]]);\n\nexport function transposeFifths(\n  interval: IntervalName,\n  fifths: number,\n): IntervalName {\n  const ivl = get(interval);\n  if (ivl.empty) return \"\";\n\n  const [nFifths, nOcts, dir] = ivl.coord;\n  return coordToInterval([nFifths + fifths, nOcts, dir]).name;\n}\n\n/** @deprecated */\nexport default {\n  names,\n  get,\n  name,\n  num,\n  semitones,\n  quality,\n  fromSemitones,\n  distance,\n  invert,\n  simplify,\n  add,\n  addTo,\n  subtract,\n  transposeFifths,\n};\n\n//// PRIVATE ////\n\ntype Operation = (\n  a: IntervalCoordinates,\n  b: IntervalCoordinates,\n) => NoteCoordinates;\n\nfunction combinator(fn: Operation) {\n  return (a: IntervalName, b: IntervalName): IntervalName | undefined => {\n    const coordA = props(a).coord;\n    const coordB = props(b).coord;\n    if (coordA && coordB) {\n      const coord = fn(coordA, coordB);\n      return coordToInterval(coord).name;\n    }\n  };\n}\n","import { detect } from \"@tonaljs/chord-detect\";\nimport {\n  ChordType,\n  all as chordTypes,\n  get as getChordType,\n} from \"@tonaljs/chord-type\";\nimport { subtract } from \"@tonaljs/interval\";\nimport { isSubsetOf, isSupersetOf } from \"@tonaljs/pcset\";\nimport {\n  distance,\n  tonicIntervalsTransposer,\n  transpose as transposeNote,\n} from \"@tonaljs/pitch-distance\";\nimport { NoteName, note, tokenizeNote } from \"@tonaljs/pitch-note\";\nimport { all as scaleTypes } from \"@tonaljs/scale-type\";\n\nexport { detect } from \"@tonaljs/chord-detect\";\n\ntype ChordNameOrTokens =\n  | string // full name to be parsed\n  | [string] // only the name\n  | [string, string] // tonic, name\n  | [string, string, string]; // tonic, name, bass\ntype ChordNameTokens = [string, string, string]; // [TONIC, SCALE TYPE, BASS]\n\nexport interface Chord extends ChordType {\n  tonic: string | null;\n  type: string;\n  root: string;\n  bass: string;\n  rootDegree: number;\n  symbol: string;\n  notes: NoteName[];\n}\n\nconst NoChord: Chord = {\n  empty: true,\n  name: \"\",\n  symbol: \"\",\n  root: \"\",\n  bass: \"\",\n  rootDegree: 0,\n  type: \"\",\n  tonic: null,\n  setNum: NaN,\n  quality: \"Unknown\",\n  chroma: \"\",\n  normalized: \"\",\n  aliases: [],\n  notes: [],\n  intervals: [],\n};\n\n// 6, 64, 7, 9, 11 and 13 are consider part of the chord\n// (see https://github.com/danigb/tonal/issues/55)\n//const NUM_TYPES = /^(6|64|7|9|11|13)$/;\n/**\n * Tokenize a chord name. It returns an array with the tonic, chord type and bass\n * If not tonic is found, all the name is considered the chord name.\n *\n * This function does NOT check if the chord type exists or not. It only tries\n * to split the tonic and chord type.\n *\n * This function does NOT check if the bass is part of the chord or not but it\n * only accepts a pitch class as bass\n *\n * @function\n * @param {string} name - the chord name\n * @return {Array} an array with [tonic, type, bass]\n * @example\n * tokenize(\"Cmaj7\") // => [ \"C\", \"maj7\" ]\n * tokenize(\"C7\") // => [ \"C\", \"7\" ]\n * tokenize(\"mMaj7\") // => [ null, \"mMaj7\" ]\n * tokenize(\"Cnonsense\") // => [ null, \"nonsense\" ]\n */\nexport function tokenize(name: string): ChordNameTokens {\n  const [letter, acc, oct, type] = tokenizeNote(name);\n  if (letter === \"\") {\n    return tokenizeBass(\"\", name);\n  } else if (letter === \"A\" && type === \"ug\") {\n    return tokenizeBass(\"\", \"aug\");\n  } else {\n    return tokenizeBass(letter + acc, oct + type);\n  }\n}\n\nfunction tokenizeBass(note: string, chord: string): ChordNameTokens {\n  const split = chord.split(\"/\");\n  if (split.length === 1) {\n    return [note, split[0], \"\"];\n  }\n  const [letter, acc, oct, type] = tokenizeNote(split[1]);\n  // Only a pitch class is accepted as bass note\n  if (letter !== \"\" && oct === \"\" && type === \"\") {\n    return [note, split[0], letter + acc];\n  } else {\n    return [note, chord, \"\"];\n  }\n}\n\n/**\n * Get a Chord from a chord name.\n */\nexport function get(src: ChordNameOrTokens): Chord {\n  if (Array.isArray(src)) {\n    return getChord(src[1] || \"\", src[0], src[2]);\n  } else if (src === \"\") {\n    return NoChord;\n  } else {\n    const [tonic, type, bass] = tokenize(src);\n    const chord = getChord(type, tonic, bass);\n    return chord.empty ? getChord(src) : chord;\n  }\n}\n\n/**\n * Get chord properties\n *\n * @param typeName - the chord type name\n * @param [tonic] - Optional tonic\n * @param [root]  - Optional root (requires a tonic)\n */\nexport function getChord(\n  typeName: string,\n  optionalTonic?: string,\n  optionalBass?: string,\n): Chord {\n  const type = getChordType(typeName);\n  const tonic = note(optionalTonic || \"\");\n  const bass = note(optionalBass || \"\");\n\n  if (\n    type.empty ||\n    (optionalTonic && tonic.empty) ||\n    (optionalBass && bass.empty)\n  ) {\n    return NoChord;\n  }\n\n  const bassInterval = distance(tonic.pc, bass.pc);\n  const bassIndex = type.intervals.indexOf(bassInterval);\n  const hasRoot = bassIndex >= 0;\n  const root = hasRoot ? bass : note(\"\");\n  const rootDegree = bassIndex === -1 ? NaN : bassIndex + 1;\n  const hasBass = bass.pc && bass.pc !== tonic.pc;\n\n  const intervals = Array.from(type.intervals);\n\n  if (hasRoot) {\n    for (let i = 1; i < rootDegree; i++) {\n      const num = intervals[0][0];\n      const quality = intervals[0][1];\n      const newNum = parseInt(num, 10) + 7;\n      intervals.push(`${newNum}${quality}`);\n      intervals.shift();\n    }\n  } else if (hasBass) {\n    const ivl = subtract(distance(tonic.pc, bass.pc), \"8P\");\n    if (ivl) intervals.unshift(ivl);\n  }\n\n  const notes = tonic.empty\n    ? []\n    : intervals.map((i) => transposeNote(tonic.pc, i));\n\n  typeName = type.aliases.indexOf(typeName) !== -1 ? typeName : type.aliases[0];\n  const symbol = `${tonic.empty ? \"\" : tonic.pc}${typeName}${\n    hasRoot && rootDegree > 1 ? \"/\" + root.pc : hasBass ? \"/\" + bass.pc : \"\"\n  }`;\n  const name = `${optionalTonic ? tonic.pc + \" \" : \"\"}${type.name}${\n    hasRoot && rootDegree > 1\n      ? \" over \" + root.pc\n      : hasBass\n        ? \" over \" + bass.pc\n        : \"\"\n  }`;\n  return {\n    ...type,\n    name,\n    symbol,\n    tonic: tonic.pc,\n    type: type.name,\n    root: root.pc,\n    bass: hasBass ? bass.pc : \"\",\n    intervals,\n    rootDegree,\n    notes,\n  };\n}\n\nexport const chord = get;\n\n/**\n * Transpose a chord name\n *\n * @param {string} chordName - the chord name\n * @return {string} the transposed chord\n *\n * @example\n * transpose('Dm7', 'P4') // => 'Gm7\n */\nexport function transpose(chordName: string, interval: string): string {\n  const [tonic, type, bass] = tokenize(chordName);\n  if (!tonic) {\n    return chordName;\n  }\n  const tr = transposeNote(bass, interval);\n  const slash = tr ? \"/\" + tr : \"\";\n  return transposeNote(tonic, interval) + type + slash;\n}\n\n/**\n * Get all scales where the given chord fits\n *\n * @example\n * chordScales('C7b9')\n * // => [\"phrygian dominant\", \"flamenco\", \"spanish heptatonic\", \"half-whole diminished\", \"chromatic\"]\n */\nexport function chordScales(name: string): string[] {\n  const s = get(name);\n  const isChordIncluded = isSupersetOf(s.chroma);\n  return scaleTypes()\n    .filter((scale) => isChordIncluded(scale.chroma))\n    .map((scale) => scale.name);\n}\n/**\n * Get all chords names that are a superset of the given one\n * (has the same notes and at least one more)\n *\n * @function\n * @example\n * extended(\"CMaj7\")\n * // => [ 'Cmaj#4', 'Cmaj7#9#11', 'Cmaj9', 'CM7add13', 'Cmaj13', 'Cmaj9#11', 'CM13#11', 'CM7b9' ]\n */\nexport function extended(chordName: string): string[] {\n  const s = get(chordName);\n  const isSuperset = isSupersetOf(s.chroma);\n  return chordTypes()\n    .filter((chord) => isSuperset(chord.chroma))\n    .map((chord) => s.tonic + chord.aliases[0]);\n}\n\n/**\n * Find all chords names that are a subset of the given one\n * (has less notes but all from the given chord)\n *\n * @example\n */\nexport function reduced(chordName: string): string[] {\n  const s = get(chordName);\n  const isSubset = isSubsetOf(s.chroma);\n  return chordTypes()\n    .filter((chord) => isSubset(chord.chroma))\n    .map((chord) => s.tonic + chord.aliases[0]);\n}\n\n/**\n * Return the chord notes\n */\nexport function notes(chordName: ChordNameOrTokens, tonic?: string): string[] {\n  const chord = get(chordName);\n  const note = tonic || chord.tonic;\n  if (!note || chord.empty) return [];\n  return chord.intervals.map((ivl) => transposeNote(note, ivl));\n}\n\n/**\n * Returns a function to get a note name from the scale degree.\n *\n * @example\n * [1, 2, 3, 4].map(Chord.degrees(\"C\")) => [\"C\", \"E\", \"G\", \"C\"]\n * [1, 2, 3, 4].map(Chord.degrees(\"C4\")) => [\"C4\", \"E4\", \"G4\", \"C5\"]\n */\nexport function degrees(chordName: ChordNameOrTokens, tonic?: string) {\n  const chord = get(chordName);\n  const note = tonic || chord.tonic;\n  const transpose = tonicIntervalsTransposer(chord.intervals, note);\n  return (degree: number) =>\n    degree ? transpose(degree > 0 ? degree - 1 : degree) : \"\";\n}\n\n/**\n * Sames as `degree` but with 0-based index\n */\nexport function steps(chordName: ChordNameOrTokens, tonic?: string) {\n  const chord = get(chordName);\n  const note = tonic || chord.tonic;\n  return tonicIntervalsTransposer(chord.intervals, note);\n}\n\n/** @deprecated */\nexport default {\n  getChord,\n  get,\n  detect,\n  chordScales,\n  extended,\n  reduced,\n  tokenize,\n  transpose,\n  degrees,\n  steps,\n  notes,\n  chord,\n};\n","import { tokenize } from \"@tonaljs/chord\";\nimport { distance, transpose } from \"@tonaljs/pitch-distance\";\nimport { interval } from \"@tonaljs/pitch-interval\";\nimport { NoteLiteral } from \"@tonaljs/pitch-note\";\nimport { get as romanNumeral } from \"@tonaljs/roman-numeral\";\n\n/**\n * Given a tonic and a chord list expressed with roman numeral notation\n * returns the progression expressed with leadsheet chords symbols notation\n * @example\n * fromRomanNumerals(\"C\", [\"I\", \"IIm7\", \"V7\"]);\n * // => [\"C\", \"Dm7\", \"G7\"]\n */\nexport function fromRomanNumerals(\n  tonic: NoteLiteral,\n  chords: string[],\n): string[] {\n  const romanNumerals = chords.map(romanNumeral);\n  return romanNumerals.map(\n    (rn) => transpose(tonic, interval(rn)) + rn.chordType,\n  );\n}\n\n/**\n * Given a tonic and a chord list with leadsheet symbols notation,\n * return the chord list with roman numeral notation\n * @example\n * toRomanNumerals(\"C\", [\"CMaj7\", \"Dm7\", \"G7\"]);\n * // => [\"IMaj7\", \"IIm7\", \"V7\"]\n */\nexport function toRomanNumerals(\n  tonic: NoteLiteral,\n  chords: string[],\n): string[] {\n  return chords.map((chord) => {\n    const [note, chordType] = tokenize(chord);\n    const intervalName = distance(tonic, note);\n    const roman = romanNumeral(interval(intervalName));\n    return roman.name + chordType;\n  });\n}\n\n/** @deprecated */\nexport default { fromRomanNumerals, toRomanNumerals };\n","import { compact, range } from \"@tonaljs/collection\";\nimport { midiToNoteName, toMidi, ToNoteNameOptions } from \"@tonaljs/midi\";\n\n/**\n * Create a numeric range. You supply a list of notes or numbers and it will\n * be connected to create complex ranges.\n *\n * @param {Array} notes - the list of notes or midi numbers used\n * @return {Array} an array of numbers or empty array if not valid parameters\n *\n * @example\n * numeric([\"C5\", \"C4\"]) // => [ 72, 71, 70, 69, 68, 67, 66, 65, 64, 63, 62, 61, 60 ]\n * // it works midi notes\n * numeric([10, 5]) // => [ 10, 9, 8, 7, 6, 5 ]\n * // complex range\n * numeric([\"C4\", \"E4\", \"Bb3\"]) // => [60, 61, 62, 63, 64, 63, 62, 61, 60, 59, 58]\n */\nexport function numeric(notes: (string | number)[]): number[] {\n  const midi: number[] = compact(\n    notes.map((note) => (typeof note === \"number\" ? note : toMidi(note))),\n  );\n  if (!notes.length || midi.length !== notes.length) {\n    // there is no valid notes\n    return [];\n  }\n\n  return midi.reduce(\n    (result, note) => {\n      const last: number = result[result.length - 1];\n      return result.concat(range(last, note).slice(1));\n    },\n    [midi[0]],\n  );\n}\n\n/**\n * Create a range of chromatic notes. The altered notes will use flats.\n *\n * @function\n * @param {Array} notes - the list of notes or midi note numbers to create a range from\n * @param {Object} options - The same as `midiToNoteName` (`{ sharps: boolean, pitchClass: boolean }`)\n * @return {Array} an array of note names\n *\n * @example\n * Range.chromatic([\"C2, \"E2\", \"D2\"]) // => [\"C2\", \"Db2\", \"D2\", \"Eb2\", \"E2\", \"Eb2\", \"D2\"]\n * // with sharps\n * Range.chromatic([\"C2\", \"C3\"], { sharps: true }) // => [ \"C2\", \"C#2\", \"D2\", \"D#2\", \"E2\", \"F2\", \"F#2\", \"G2\", \"G#2\", \"A2\", \"A#2\", \"B2\", \"C3\" ]\n */\nexport function chromatic(\n  notes: (string | number)[],\n  options?: ToNoteNameOptions,\n): string[] {\n  return numeric(notes).map((midi) => midiToNoteName(midi, options));\n}\n\n/** @deprecated */\nexport default { numeric, chromatic };\n","/**\n * @private\n * Chord List\n * Source: https://en.wikibooks.org/wiki/Music_Theory/Complete_List_of_Chord_Patterns\n * Format: [\"intervals\", \"full name\", \"abrv1 abrv2\"]\n */\nconst CHORDS: string[][] = [\n  // ==Major==\n  [\"1P 3M 5P\", \"major\", \"M ^  maj\"],\n  [\"1P 3M 5P 7M\", \"major seventh\", \"maj7  ma7 M7 Maj7 ^7\"],\n  [\"1P 3M 5P 7M 9M\", \"major ninth\", \"maj9 9 ^9\"],\n  [\"1P 3M 5P 7M 9M 13M\", \"major thirteenth\", \"maj13 Maj13 ^13\"],\n  [\"1P 3M 5P 6M\", \"sixth\", \"6 add6 add13 M6\"],\n  [\"1P 3M 5P 6M 9M\", \"sixth added ninth\", \"6add9 6/9 69 M69\"],\n  [\"1P 3M 6m 7M\", \"major seventh flat sixth\", \"M7b6 ^7b6\"],\n  [\n    \"1P 3M 5P 7M 11A\",\n    \"major seventh sharp eleventh\",\n    \"maj#4 #4 #11 M7#11 ^7#11 maj7#11\",\n  ],\n  // ==Minor==\n  // '''Normal'''\n  [\"1P 3m 5P\", \"minor\", \"m min -\"],\n  [\"1P 3m 5P 7m\", \"minor seventh\", \"m7 min7 mi7 -7\"],\n  [\n    \"1P 3m 5P 7M\",\n    \"minor/major seventh\",\n    \"m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7\",\n  ],\n  [\"1P 3m 5P 6M\", \"minor sixth\", \"m6 -6\"],\n  [\"1P 3m 5P 7m 9M\", \"minor ninth\", \"m9 -9\"],\n  [\"1P 3m 5P 7M 9M\", \"minor/major ninth\", \"mM9 mMaj9 -^9\"],\n  [\"1P 3m 5P 7m 9M 11P\", \"minor eleventh\", \"m11 -11\"],\n  [\"1P 3m 5P 7m 9M 13M\", \"minor thirteenth\", \"m13 -13\"],\n  // '''Diminished'''\n  [\"1P 3m 5d\", \"diminished\", \"dim  o\"],\n  [\"1P 3m 5d 7d\", \"diminished seventh\", \"dim7 7 o7\"],\n  [\"1P 3m 5d 7m\", \"half-diminished\", \"m7b5  -7b5 h7 h\"],\n  // ==Dominant/Seventh==\n  // '''Normal'''\n  [\"1P 3M 5P 7m\", \"dominant seventh\", \"7 dom\"],\n  [\"1P 3M 5P 7m 9M\", \"dominant ninth\", \"9\"],\n  [\"1P 3M 5P 7m 9M 13M\", \"dominant thirteenth\", \"13\"],\n  [\"1P 3M 5P 7m 11A\", \"lydian dominant seventh\", \"7#11 7#4\"],\n  // '''Altered'''\n  [\"1P 3M 5P 7m 9m\", \"dominant flat ninth\", \"7b9\"],\n  [\"1P 3M 5P 7m 9A\", \"dominant sharp ninth\", \"7#9\"],\n  [\"1P 3M 7m 9m\", \"altered\", \"alt7\"],\n  // '''Suspended'''\n  [\"1P 4P 5P\", \"suspended fourth\", \"sus4 sus\"],\n  [\"1P 2M 5P\", \"suspended second\", \"sus2\"],\n  [\"1P 4P 5P 7m\", \"suspended fourth seventh\", \"7sus4 7sus\"],\n  [\"1P 5P 7m 9M 11P\", \"eleventh\", \"11\"],\n  [\n    \"1P 4P 5P 7m 9m\",\n    \"suspended fourth flat ninth\",\n    \"b9sus phryg 7b9sus 7b9sus4\",\n  ],\n  // ==Other==\n  [\"1P 5P\", \"fifth\", \"5\"],\n  [\"1P 3M 5A\", \"augmented\", \"aug + +5 ^#5\"],\n  [\"1P 3m 5A\", \"minor augmented\", \"m#5 -#5 m+\"],\n  [\"1P 3M 5A 7M\", \"augmented seventh\", \"maj7#5 maj7+5 +maj7 ^7#5\"],\n  [\n    \"1P 3M 5P 7M 9M 11A\",\n    \"major sharp eleventh (lydian)\",\n    \"maj9#11 9#11 ^9#11\",\n  ],\n  // ==Legacy==\n  [\"1P 2M 4P 5P\", \"\", \"sus24 sus4add9\"],\n  [\"1P 3M 5A 7M 9M\", \"\", \"maj9#5 Maj9#5\"],\n  [\"1P 3M 5A 7m\", \"\", \"7#5 +7 7+ 7aug aug7\"],\n  [\"1P 3M 5A 7m 9A\", \"\", \"7#5#9 7#9#5 7alt\"],\n  [\"1P 3M 5A 7m 9M\", \"\", \"9#5 9+\"],\n  [\"1P 3M 5A 7m 9M 11A\", \"\", \"9#5#11\"],\n  [\"1P 3M 5A 7m 9m\", \"\", \"7#5b9 7b9#5\"],\n  [\"1P 3M 5A 7m 9m 11A\", \"\", \"7#5b9#11\"],\n  [\"1P 3M 5A 9A\", \"\", \"+add#9\"],\n  [\"1P 3M 5A 9M\", \"\", \"M#5add9 +add9\"],\n  [\"1P 3M 5P 6M 11A\", \"\", \"M6#11 M6b5 6#11 6b5\"],\n  [\"1P 3M 5P 6M 7M 9M\", \"\", \"M7add13\"],\n  [\"1P 3M 5P 6M 9M 11A\", \"\", \"69#11\"],\n  [\"1P 3m 5P 6M 9M\", \"\", \"m69 -69\"],\n  [\"1P 3M 5P 6m 7m\", \"\", \"7b6\"],\n  [\"1P 3M 5P 7M 9A 11A\", \"\", \"maj7#9#11\"],\n  [\"1P 3M 5P 7M 9M 11A 13M\", \"\", \"M13#11 maj13#11 M13+4 M13#4\"],\n  [\"1P 3M 5P 7M 9m\", \"\", \"M7b9\"],\n  [\"1P 3M 5P 7m 11A 13m\", \"\", \"7#11b13 7b5b13\"],\n  [\"1P 3M 5P 7m 13M\", \"\", \"7add6 67 7add13\"],\n  [\"1P 3M 5P 7m 9A 11A\", \"\", \"7#9#11 7b5#9 7#9b5\"],\n  [\"1P 3M 5P 7m 9A 11A 13M\", \"\", \"13#9#11\"],\n  [\"1P 3M 5P 7m 9A 11A 13m\", \"\", \"7#9#11b13\"],\n  [\"1P 3M 5P 7m 9A 13M\", \"\", \"13#9\"],\n  [\"1P 3M 5P 7m 9A 13m\", \"\", \"7#9b13\"],\n  [\"1P 3M 5P 7m 9M 11A\", \"\", \"9#11 9+4 9#4\"],\n  [\"1P 3M 5P 7m 9M 11A 13M\", \"\", \"13#11 13+4 13#4\"],\n  [\"1P 3M 5P 7m 9M 11A 13m\", \"\", \"9#11b13 9b5b13\"],\n  [\"1P 3M 5P 7m 9m 11A\", \"\", \"7b9#11 7b5b9 7b9b5\"],\n  [\"1P 3M 5P 7m 9m 11A 13M\", \"\", \"13b9#11\"],\n  [\"1P 3M 5P 7m 9m 11A 13m\", \"\", \"7b9b13#11 7b9#11b13 7b5b9b13\"],\n  [\"1P 3M 5P 7m 9m 13M\", \"\", \"13b9\"],\n  [\"1P 3M 5P 7m 9m 13m\", \"\", \"7b9b13\"],\n  [\"1P 3M 5P 7m 9m 9A\", \"\", \"7b9#9\"],\n  [\"1P 3M 5P 9M\", \"\", \"Madd9 2 add9 add2\"],\n  [\"1P 3M 5P 9m\", \"\", \"Maddb9\"],\n  [\"1P 3M 5d\", \"\", \"Mb5\"],\n  [\"1P 3M 5d 6M 7m 9M\", \"\", \"13b5\"],\n  [\"1P 3M 5d 7M\", \"\", \"M7b5\"],\n  [\"1P 3M 5d 7M 9M\", \"\", \"M9b5\"],\n  [\"1P 3M 5d 7m\", \"\", \"7b5\"],\n  [\"1P 3M 5d 7m 9M\", \"\", \"9b5\"],\n  [\"1P 3M 7m\", \"\", \"7no5\"],\n  [\"1P 3M 7m 13m\", \"\", \"7b13\"],\n  [\"1P 3M 7m 9M\", \"\", \"9no5\"],\n  [\"1P 3M 7m 9M 13M\", \"\", \"13no5\"],\n  [\"1P 3M 7m 9M 13m\", \"\", \"9b13\"],\n  [\"1P 3m 4P 5P\", \"\", \"madd4\"],\n  [\"1P 3m 5P 6m 7M\", \"\", \"mMaj7b6\"],\n  [\"1P 3m 5P 6m 7M 9M\", \"\", \"mMaj9b6\"],\n  [\"1P 3m 5P 7m 11P\", \"\", \"m7add11 m7add4\"],\n  [\"1P 3m 5P 9M\", \"\", \"madd9\"],\n  [\"1P 3m 5d 6M 7M\", \"\", \"o7M7\"],\n  [\"1P 3m 5d 7M\", \"\", \"oM7\"],\n  [\"1P 3m 6m 7M\", \"\", \"mb6M7\"],\n  [\"1P 3m 6m 7m\", \"\", \"m7#5\"],\n  [\"1P 3m 6m 7m 9M\", \"\", \"m9#5\"],\n  [\"1P 3m 5A 7m 9M 11P\", \"\", \"m11A\"],\n  [\"1P 3m 6m 9m\", \"\", \"mb6b9\"],\n  [\"1P 2M 3m 5d 7m\", \"\", \"m9b5\"],\n  [\"1P 4P 5A 7M\", \"\", \"M7#5sus4\"],\n  [\"1P 4P 5A 7M 9M\", \"\", \"M9#5sus4\"],\n  [\"1P 4P 5A 7m\", \"\", \"7#5sus4\"],\n  [\"1P 4P 5P 7M\", \"\", \"M7sus4\"],\n  [\"1P 4P 5P 7M 9M\", \"\", \"M9sus4\"],\n  [\"1P 4P 5P 7m 9M\", \"\", \"9sus4 9sus\"],\n  [\"1P 4P 5P 7m 9M 13M\", \"\", \"13sus4 13sus\"],\n  [\"1P 4P 5P 7m 9m 13m\", \"\", \"7sus4b9b13 7b9b13sus4\"],\n  [\"1P 4P 7m 10m\", \"\", \"4 quartal\"],\n  [\"1P 5P 7m 9m 11P\", \"\", \"11b9\"],\n];\n\nexport default CHORDS;\n","import {\n  EmptyPcset,\n  get as pcset,\n  Pcset,\n  PcsetChroma,\n  PcsetNum,\n} from \"@tonaljs/pcset\";\nimport data from \"./data\";\n\nexport type ChordQuality =\n  | \"Major\"\n  | \"Minor\"\n  | \"Augmented\"\n  | \"Diminished\"\n  | \"Unknown\";\n\nexport interface ChordType extends Pcset {\n  name: string;\n  quality: ChordQuality;\n  aliases: string[];\n}\nconst NoChordType: ChordType = {\n  ...EmptyPcset,\n  name: \"\",\n  quality: \"Unknown\",\n  intervals: [],\n  aliases: [],\n};\n\ntype ChordTypeName = string | PcsetChroma | PcsetNum;\n\nlet dictionary: ChordType[] = [];\nlet index: Record<ChordTypeName, ChordType> = {};\n\n/**\n * Given a chord name or chroma, return the chord properties\n * @param {string} source - chord name or pitch class set chroma\n * @example\n * import { get } from 'tonaljs/chord-type'\n * get('major') // => { name: 'major', ... }\n */\nexport function get(type: ChordTypeName): ChordType {\n  return index[type] || NoChordType;\n}\n\n/** @deprecated */\nexport const chordType = get;\n\n/**\n * Get all chord (long) names\n */\nexport function names() {\n  return dictionary.map((chord) => chord.name).filter((x) => x);\n}\n\n/**\n * Get all chord symbols\n */\nexport function symbols() {\n  return dictionary.map((chord) => chord.aliases[0]).filter((x) => x);\n}\n\n/**\n * Keys used to reference chord types\n */\nexport function keys() {\n  return Object.keys(index);\n}\n\n/**\n * Return a list of all chord types\n */\nexport function all(): ChordType[] {\n  return dictionary.slice();\n}\n\n/** @deprecated */\nexport const entries = all;\n\n/**\n * Clear the dictionary\n */\nexport function removeAll() {\n  dictionary = [];\n  index = {};\n}\n\n/**\n * Add a chord to the dictionary.\n * @param intervals\n * @param aliases\n * @param [fullName]\n */\nexport function add(intervals: string[], aliases: string[], fullName?: string) {\n  const quality = getQuality(intervals);\n  const chord = {\n    ...pcset(intervals),\n    name: fullName || \"\",\n    quality,\n    intervals,\n    aliases,\n  };\n  dictionary.push(chord);\n  if (chord.name) {\n    index[chord.name] = chord;\n  }\n  index[chord.setNum] = chord;\n  index[chord.chroma] = chord;\n  chord.aliases.forEach((alias) => addAlias(chord, alias));\n}\n\nexport function addAlias(chord: ChordType, alias: string) {\n  index[alias] = chord;\n}\n\nfunction getQuality(intervals: string[]): ChordQuality {\n  const has = (interval: string) => intervals.indexOf(interval) !== -1;\n  return has(\"5A\")\n    ? \"Augmented\"\n    : has(\"3M\")\n      ? \"Major\"\n      : has(\"5d\")\n        ? \"Diminished\"\n        : has(\"3m\")\n          ? \"Minor\"\n          : \"Unknown\";\n}\n\ndata.forEach(([ivls, fullName, names]: string[]) =>\n  add(ivls.split(\" \"), names.split(\" \"), fullName),\n);\ndictionary.sort((a, b) => a.setNum - b.setNum);\n\n/** @deprecated */\nexport default {\n  names,\n  symbols,\n  get,\n  all,\n  add,\n  removeAll,\n  keys,\n  // deprecated\n  entries,\n  chordType,\n};\n","/**\n * References:\n * - https://www.researchgate.net/publication/327567188_An_Algorithm_for_Spelling_the_Pitches_of_Any_Musical_Scale\n * @module scale\n */\nimport { all as chordTypes } from \"@tonaljs/chord-type\";\nimport { range as nums, rotate } from \"@tonaljs/collection\";\nimport { enharmonic, fromMidi, sortedUniqNames } from \"@tonaljs/note\";\nimport {\n  chroma,\n  isChroma,\n  isSubsetOf,\n  isSupersetOf,\n  modes,\n} from \"@tonaljs/pcset\";\nimport { tonicIntervalsTransposer, transpose } from \"@tonaljs/pitch-distance\";\nimport { note, NoteName } from \"@tonaljs/pitch-note\";\nimport {\n  all,\n  get as getScaleType,\n  ScaleType,\n  names as scaleTypeNames,\n  all as scaleTypes,\n} from \"@tonaljs/scale-type\";\n\ntype ScaleName = string;\ntype ScaleNameTokens = [string, string]; // [TONIC, SCALE TYPE]\n\nexport interface Scale extends ScaleType {\n  tonic: string | null;\n  type: string;\n  notes: NoteName[];\n}\n\nconst NoScale: Scale = {\n  empty: true,\n  name: \"\",\n  type: \"\",\n  tonic: null,\n  setNum: NaN,\n  chroma: \"\",\n  normalized: \"\",\n  aliases: [],\n  notes: [],\n  intervals: [],\n};\n\n/**\n * Given a string with a scale name and (optionally) a tonic, split\n * that components.\n *\n * It returns an array with the form [ name, tonic ] where tonic can be a\n * note name or null and name can be any arbitrary string\n * (this function doesn't check if that scale name exists)\n *\n * @function\n * @param {string} name - the scale name\n * @return {Array} an array [tonic, name]\n * @example\n * tokenize(\"C mixolydian\") // => [\"C\", \"mixolydian\"]\n * tokenize(\"anything is valid\") // => [\"\", \"anything is valid\"]\n * tokenize() // => [\"\", \"\"]\n */\nexport function tokenize(name: ScaleName): ScaleNameTokens {\n  if (typeof name !== \"string\") {\n    return [\"\", \"\"];\n  }\n  const i = name.indexOf(\" \");\n  const tonic = note(name.substring(0, i));\n  if (tonic.empty) {\n    const n = note(name);\n    return n.empty ? [\"\", name.toLowerCase()] : [n.name, \"\"];\n  }\n\n  const type = name.substring(tonic.name.length + 1).toLowerCase();\n  return [tonic.name, type.length ? type : \"\"];\n}\n\n/**\n * Get all scale names\n * @function\n */\nexport const names = scaleTypeNames;\n\n/**\n * Get a Scale from a scale name.\n */\nexport function get(src: ScaleName | ScaleNameTokens): Scale {\n  const tokens = Array.isArray(src) ? src : tokenize(src);\n  const tonic = note(tokens[0]).name;\n  const st = getScaleType(tokens[1]);\n  if (st.empty) {\n    return NoScale;\n  }\n\n  const type = st.name;\n  const notes: string[] = tonic\n    ? st.intervals.map((i) => transpose(tonic, i))\n    : [];\n\n  const name = tonic ? tonic + \" \" + type : type;\n\n  return { ...st, name, type, tonic, notes };\n}\n\n/**\n * @deprecated\n * @use Scale.get\n */\nexport const scale = get;\n\nexport function detect(\n  notes: string[],\n  options: { tonic?: string; match?: \"exact\" | \"fit\" } = {},\n): string[] {\n  const notesChroma = chroma(notes);\n  const tonic = note(options.tonic ?? notes[0] ?? \"\");\n  const tonicChroma = tonic.chroma;\n  if (tonicChroma === undefined) {\n    return [];\n  }\n\n  const pitchClasses = notesChroma.split(\"\");\n  pitchClasses[tonicChroma] = \"1\";\n  const scaleChroma = rotate(tonicChroma, pitchClasses).join(\"\");\n  const match = all().find((scaleType) => scaleType.chroma === scaleChroma);\n\n  const results: string[] = [];\n  if (match) {\n    results.push(tonic.name + \" \" + match.name);\n  }\n  if (options.match === \"exact\") {\n    return results;\n  }\n\n  extended(scaleChroma).forEach((scaleName) => {\n    results.push(tonic.name + \" \" + scaleName);\n  });\n\n  return results;\n}\n\n/**\n * Get all chords that fits a given scale\n *\n * @function\n * @param {string} name - the scale name\n * @return {Array<string>} - the chord names\n *\n * @example\n * scaleChords(\"pentatonic\") // => [\"5\", \"64\", \"M\", \"M6\", \"Madd9\", \"Msus2\"]\n */\nexport function scaleChords(name: string): string[] {\n  const s = get(name);\n  const inScale = isSubsetOf(s.chroma);\n  return chordTypes()\n    .filter((chord) => inScale(chord.chroma))\n    .map((chord) => chord.aliases[0]);\n}\n/**\n * Get all scales names that are a superset of the given one\n * (has the same notes and at least one more)\n *\n * @function\n * @param {string} name\n * @return {Array} a list of scale names\n * @example\n * extended(\"major\") // => [\"bebop\", \"bebop dominant\", \"bebop major\", \"chromatic\", \"ichikosucho\"]\n */\nexport function extended(name: string): string[] {\n  const chroma = isChroma(name) ? name : get(name).chroma;\n  const isSuperset = isSupersetOf(chroma);\n  return scaleTypes()\n    .filter((scale) => isSuperset(scale.chroma))\n    .map((scale) => scale.name);\n}\n\n/**\n * Find all scales names that are a subset of the given one\n * (has less notes but all from the given scale)\n *\n * @function\n * @param {string} name\n * @return {Array} a list of scale names\n *\n * @example\n * reduced(\"major\") // => [\"ionian pentatonic\", \"major pentatonic\", \"ritusen\"]\n */\nexport function reduced(name: string): string[] {\n  const isSubset = isSubsetOf(get(name).chroma);\n  return scaleTypes()\n    .filter((scale) => isSubset(scale.chroma))\n    .map((scale) => scale.name);\n}\n\n/**\n * Given an array of notes, return the scale: a pitch class set starting from\n * the first note of the array\n *\n * @function\n * @param {string[]} notes\n * @return {string[]} pitch classes with same tonic\n * @example\n * scaleNotes(['C4', 'c3', 'C5', 'C4', 'c4']) // => [\"C\"]\n * scaleNotes(['D4', 'c#5', 'A5', 'F#6']) // => [\"D\", \"F#\", \"A\", \"C#\"]\n */\nexport function scaleNotes(notes: NoteName[]) {\n  const pcset: string[] = notes.map((n) => note(n).pc).filter((x) => x);\n  const tonic = pcset[0];\n  const scale = sortedUniqNames(pcset);\n  return rotate(scale.indexOf(tonic), scale);\n}\n\ntype ScaleMode = [string, string];\n/**\n * Find mode names of a scale\n *\n * @function\n * @param {string} name - scale name\n * @example\n * modeNames(\"C pentatonic\") // => [\n *   [\"C\", \"major pentatonic\"],\n *   [\"D\", \"egyptian\"],\n *   [\"E\", \"malkos raga\"],\n *   [\"G\", \"ritusen\"],\n *   [\"A\", \"minor pentatonic\"]\n * ]\n */\nexport function modeNames(name: string): ScaleMode[] {\n  const s = get(name);\n  if (s.empty) {\n    return [];\n  }\n\n  const tonics = s.tonic ? s.notes : s.intervals;\n  return modes(s.chroma)\n    .map((chroma: string, i: number): ScaleMode => {\n      const modeName = get(chroma).name;\n      return modeName ? [tonics[i], modeName] : [\"\", \"\"];\n    })\n    .filter((x) => x[0]);\n}\n\nfunction getNoteNameOf(scale: string | string[]) {\n  const names = Array.isArray(scale) ? scaleNotes(scale) : get(scale).notes;\n  const chromas = names.map((name) => note(name).chroma);\n\n  return (noteOrMidi: string | number): string | undefined => {\n    const currNote =\n      typeof noteOrMidi === \"number\"\n        ? note(fromMidi(noteOrMidi))\n        : note(noteOrMidi);\n    const height = currNote.height;\n\n    if (height === undefined) return undefined;\n    const chroma = height % 12;\n    const position = chromas.indexOf(chroma);\n    if (position === -1) return undefined;\n    return enharmonic(currNote.name, names[position]);\n  };\n}\n\nexport function rangeOf(scale: string | string[]) {\n  const getName = getNoteNameOf(scale);\n  return (fromNote: string, toNote: string) => {\n    const from = note(fromNote).height;\n    const to = note(toNote).height;\n    if (from === undefined || to === undefined) return [];\n\n    return nums(from, to)\n      .map(getName)\n      .filter((x) => x);\n  };\n}\n\n/**\n * Returns a function to get a note name from the scale degree.\n *\n * @example\n * [1, 2, 3].map(Scale.degrees(\"C major\")) => [\"C\", \"D\", \"E\"]\n * [1, 2, 3].map(Scale.degrees(\"C4 major\")) => [\"C4\", \"D4\", \"E4\"]\n */\nexport function degrees(scaleName: string | ScaleNameTokens) {\n  const { intervals, tonic } = get(scaleName);\n  const transpose = tonicIntervalsTransposer(intervals, tonic);\n  return (degree: number) =>\n    degree ? transpose(degree > 0 ? degree - 1 : degree) : \"\";\n}\n\n/**\n * Sames as `degree` but with 0-based index\n */\nexport function steps(scaleName: string | ScaleNameTokens) {\n  const { intervals, tonic } = get(scaleName);\n  return tonicIntervalsTransposer(intervals, tonic);\n}\n\n/** @deprecated */\nexport default {\n  degrees,\n  detect,\n  extended,\n  get,\n  modeNames,\n  names,\n  rangeOf,\n  reduced,\n  scaleChords,\n  scaleNotes,\n  steps,\n  tokenize,\n\n  // deprecated\n  scale,\n};\n","// TYPES: PARSING\nexport type TimeSignatureLiteral = string | [number, number] | [string, string];\ntype ParsedTimeSignature = [number | number[], number];\n\n// TYPES: PROPERTIES\nexport type ValidTimeSignature = {\n  readonly empty: false;\n  readonly name: string;\n  readonly upper: number | number[];\n  readonly lower: number;\n  readonly type: \"simple\" | \"compound\" | \"irregular\" | \"irrational\";\n  readonly additive: number[];\n};\n\nexport type InvalidTimeSignature = {\n  readonly empty: true;\n  readonly name: \"\";\n  readonly upper: undefined;\n  readonly lower: undefined;\n  readonly type: undefined;\n  readonly additive: [];\n};\n\nexport type TimeSignature = ValidTimeSignature | InvalidTimeSignature;\n\n// CONSTANTS\nconst NONE: InvalidTimeSignature = {\n  empty: true,\n  name: \"\",\n  upper: undefined,\n  lower: undefined,\n  type: undefined,\n  additive: [],\n};\n\nconst NAMES = [\"4/4\", \"3/4\", \"2/4\", \"2/2\", \"12/8\", \"9/8\", \"6/8\", \"3/8\"];\n\n// PUBLIC API\n\nexport function names() {\n  return NAMES.slice();\n}\n\nconst REGEX = /^(\\d*\\d(?:\\+\\d)*)\\/(\\d+)$/;\nconst CACHE = new Map<TimeSignatureLiteral, TimeSignature>();\n\nexport function get(literal: TimeSignatureLiteral): TimeSignature {\n  const stringifiedLiteral = JSON.stringify(literal);\n  const cached = CACHE.get(stringifiedLiteral);\n  if (cached) {\n    return cached;\n  }\n\n  const ts = build(parse(literal));\n  CACHE.set(stringifiedLiteral, ts);\n  return ts;\n}\n\nexport function parse(literal: TimeSignatureLiteral): ParsedTimeSignature {\n  if (typeof literal === \"string\") {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const [_, up, low] = REGEX.exec(literal) || [];\n    return parse([up, low]);\n  }\n\n  const [up, down] = literal;\n  const denominator = +down;\n  if (typeof up === \"number\") {\n    return [up, denominator];\n  }\n\n  const list = up.split(\"+\").map((n) => +n);\n  return list.length === 1 ? [list[0], denominator] : [list, denominator];\n}\n\n/** @deprecated */\nexport default { names, parse, get };\n\n// PRIVATE\n\nconst isPowerOfTwo = (x: number) => (Math.log(x) / Math.log(2)) % 1 === 0;\n\nfunction build([up, down]: ParsedTimeSignature): TimeSignature {\n  const upper = Array.isArray(up) ? up.reduce((a, b) => a + b, 0) : up;\n  const lower = down;\n  if (upper === 0 || lower === 0) {\n    return NONE;\n  }\n\n  const name = Array.isArray(up) ? `${up.join(\"+\")}/${down}` : `${up}/${down}`;\n  const additive = Array.isArray(up) ? up : [];\n  const type =\n    lower === 4 || lower === 2\n      ? \"simple\"\n      : lower === 8 && upper % 3 === 0\n        ? \"compound\"\n        : isPowerOfTwo(lower)\n          ? \"irregular\"\n          : \"irrational\";\n\n  return {\n    empty: false,\n    name,\n    type,\n    upper,\n    lower,\n    additive,\n  };\n}\n","import AbcNotation from \"@tonaljs/abc-notation\";\nimport * as Array from \"@tonaljs/array\";\nimport Chord from \"@tonaljs/chord\";\nimport ChordType from \"@tonaljs/chord-type\";\nimport Collection from \"@tonaljs/collection\";\nimport * as Core from \"@tonaljs/core\";\nimport DurationValue from \"@tonaljs/duration-value\";\nimport Interval from \"@tonaljs/interval\";\nimport Key from \"@tonaljs/key\";\nimport Midi from \"@tonaljs/midi\";\nimport Mode from \"@tonaljs/mode\";\nimport Note from \"@tonaljs/note\";\nimport Pcset from \"@tonaljs/pcset\";\nimport Progression from \"@tonaljs/progression\";\nimport Range from \"@tonaljs/range\";\nimport RomanNumeral from \"@tonaljs/roman-numeral\";\nimport Scale from \"@tonaljs/scale\";\nimport ScaleType from \"@tonaljs/scale-type\";\nimport TimeSignature from \"@tonaljs/time-signature\";\n\nexport * from \"@tonaljs/core\";\n\n// deprecated (backwards compatibility)\nconst Tonal = Core;\nconst PcSet = Pcset;\nconst ChordDictionary = ChordType;\nconst ScaleDictionary = ScaleType;\n\nexport {\n  AbcNotation,\n  Array,\n  Chord,\n  ChordType,\n  Collection,\n  Core,\n  DurationValue,\n  Note,\n  Interval,\n  Key,\n  Midi,\n  Mode,\n  Pcset,\n  Progression,\n  Range,\n  RomanNumeral,\n  Scale,\n  ScaleType,\n  TimeSignature,\n  // backwards API compatibility (3.0)\n  Tonal,\n  PcSet,\n  ChordDictionary,\n  ScaleDictionary,\n};\n","import { getBestVoicing } from './getBestVoicing';\nimport { VoicingDictionary, VoicingOptions } from './types';\nimport { voicingsInRange } from './voicingsInRange';\n\nexport const lefthand: VoicingDictionary = {\n  m7: ['3m 5P 7m 9M', '7m 9M 10m 12P'],\n  '7': ['3M 6M 7m 9M', '7m 9M 10M 13M'],\n  '^7': ['3M 5P 7M 9M', '7M 9M 10M 12P'],\n  '69': ['3M 5P 6A 9M'],\n  m7b5: ['3m 5d 7m 8P', '7m 8P 10m 12d'],\n  '7b9': ['3M 6m 7m 9m', '7m 9m 10M 13m'], // b9 / b13\n  '7b13': ['3M 6m 7m 9m', '7m 9m 10M 13m'], // b9 / b13\n  o7: ['1P 3m 5d 6M', '5d 6M 8P 10m'],\n  '7#11': ['7m 9M 11A 13A'],\n  '7#9': ['3M 7m 9A'],\n  mM7: ['3m 5P 7M 9M', '7M 9M 10m 12P'],\n  m6: ['3m 5P 6M 9M', '6M 9M 10m 12P'],\n};\nexport const guidetones: VoicingDictionary = {\n  m7: ['3m 7m', '7m 10m'],\n  m9: ['3m 7m', '7m 10m'],\n  '7': ['3M 7m', '7m 10M'],\n  '^7': ['3M 7M', '7M 10M'],\n  '^9': ['3M 7M', '7M 10M'],\n  '69': ['3M 6M'],\n  '6': ['3M 6M', '6M 10M'],\n  m7b5: ['3m 7m', '7m 10m'],\n  '7b9': ['3M 7m', '7m 10M'], // b9 / b13\n  '7b13': ['3M 7m', '7m 10M'], // b9 / b13\n  o7: ['3m 6M', '6M 10m'],\n  '7#11': ['3M 7m', '7m 10M'],\n  '7#9': ['3M 7m', '7m 10M'],\n  mM7: ['3m 7M', '7M 10m'],\n  m6: ['3m 6M', '6M 10m'],\n};\nexport const triads: VoicingDictionary = {\n  M: ['1P 3M 5P', '3M 5P 8P', '5P 8P 10M'],\n  m: ['1P 3m 5P', '3m 5P 8P', '5P 8P 10m'],\n  o: ['1P 3m 5d', '3m 5d 8P', '5d 8P 10m'],\n  aug: ['1P 3m 5A', '3m 5A 8P', '5A 8P 10m'],\n};\n\nexport declare interface DictionaryVoicingProps extends Omit<VoicingOptions, 'finder'> {\n  dictionary: VoicingDictionary;\n}\n\nexport const dictionaryVoicingFinder = (dictionary) => (chordSymbol, range) =>\n  voicingsInRange(chordSymbol, dictionary, range);\n\nexport const dictionaryVoicing = (props: DictionaryVoicingProps) => {\n  const { dictionary, range, ...rest } = props;\n  return getBestVoicing({\n    ...rest,\n    range,\n    finder: dictionaryVoicingFinder(dictionary),\n  });\n};\n"],"names":["exports","chord","match","slice","tonal_1","require","dictionaryVoicing_1","tokenizeChord_1","dictionary","range","lefthand","_a","tokenizeChord","tonic","symbol","voicings","map","intervals","split","notesInRange","Range","chromatic","reduce","voiced","voicing","relativeIntervals","interval","Interval","substract","bottomPitchClass","Note","transpose","notes","filter","note","chroma","midi","length","enharmonic","start","concat","X","Y","Z","m1","b","j","m","S","P","Number","isNaN","y","semitones","I","_","e1","M","arguments","undefined","t","e","Math","floor","k","o1","n","w","tokenize","d","o","s","get","r","i","l","$","forEach","abs","n1","c","J","below","duck","above","root","d1","_ref","_n","offset","mode","anchor","octaves","P1","indexOf","toLowerCase","M1","a","u","D","U","E","q","ceil","G","F","K","Q","z","N","t1","O","f","pc","Error","oct","sign","A1","trans","N1","p","withHap","_e$value$note","value","withValue","_objectSpread","T","V","String","fromSemitones","simplify","scaleTranspose","x1","scaleTrans","C1","strans","V1","context","scale","$1","Array","isArray","flat","join","fmap","B","test","v","substring","replaceAll","empty","add","r1","s1","message","outerJoin","setContext","g","add9","h","sus","h7","o7","h9","dictionaryVoicing","i1","minTopNoteDiff","c1","H","A","m7","m7b5","mM7","m6","triads","aug","guidetones","m9","legacy","L","b1","D1","g1","Object","assign","W","x","E1","p1","picker","lastVoicing","R","k1","v1","_objectWithoutProperties","_excluded","set","_unused","C","j1","keys","includes","replace","I1","voicingOptions","finder","minTopNoteDiff_1","getBestVoicing_1","getBestVoicing","dictionaryVoicingFinder","diff","best","current","FIFTHS","STEPS_TO_OCTS","fifths","FIFTHS_TO_STEPS","fillStr","NoInterval","freeze","name","num","NaN","type","step","alt","dir","simple","coord","REGEX","RegExp","cache","src","str","tokens","exec","tokenizeInterval","TYPES","qToAlt","SIZES","pitch2","coordinates","parse","props","calcNum","altToQ","pitchName","isNamedPitch","coordToInterval","forceDescending","unaltered","pitch","NoNote","letter","acc","height","freq","Map","stepToLetter","charAt","altToAcc","accToAlt","stringSrc","JSON","stringify","cached","noteName","tokenizeNote","octStr","charCodeAt","SEMI","mod","pow","toUpperCase","coordToNote","noteCoord","intervalName","asNote","intervalCoord","asInterval","tonicIntervalsTransposer","len","normalized","index","distance","fromNote","toNote","from","to","fcoord","tcoord","character","times","abcToScientificNotation","scientificToAbcNotation","abc_notation_default","note2","tr","dist","ascR","descR","rotate","arr","compact","sortedNoteNames","sort","sortedUniqNoteNames","shuffle","rnd","random","permutations","perm","pos","newPerm","splice","collection_default","EmptyPcset","setNum","setNumToChroma","num2","toString","padStart","chromaToNumber","chroma2","parseInt","isChroma","binary","listToChroma","isPcset","normalizedNum","chromaRotations","intervals2","push","IVLS","chromaToIntervals","chromaToPcset","modes","normalize","isSubsetOf","notes2","isSupersetOf","isNoteIncludedIn","pcset_default","chromas","isEqual","s2","isIncluded","ivl","pcset","data_default","quality","aliases","all","fullName","has","getQuality","alias","addAlias","ivls","names2","detect","source","options","found","weight","tonicChroma","pcToName","record","namedSet","allModes","modeWithPerfectFifth","assumePerfectFifth","chromaNumber","hasNonPerfectFifth","withPerfectFifth","chordTypes","chordType","hasAnyThird","hasPerfectFifth","hasAnySeventh","hasAnyThirdAndPerfectFifthAndAnySeventh","chordName","baseNote","findMatches","BITMASK","testChromaNumber","bitmask","Boolean","_ref2","isPitch","deprecate","original","alternative","fn","console","warn","_len","args","_key","apply","this","isNamed","NoChordType","entries","chord_type_default","names","symbols","removeAll","NoScaleType","scaleType","scale_type_default","NoChord","rootDegree","getChord","chord2","typeName","optionalTonic","optionalRoot","getChordType","rootInterval","newNum","shift","transposeNote","chord_default","chordScales","isChordIncluded","scaleTypes","extended","isSuperset","reduced","isSubset","degrees","transpose2","degree","steps","VALUES","denominator","shorthand","dots","fraction","NoDuration","base","find","dur","fraction2","numerator","calcDots","value2","duration_value_default","duration","shorthands","IN","IQ","combinator","interval_default","name2","semitones2","invert","addTo","other","transposeFifths","nFifths","nOcts","coordA","coordB","isMidi","arg","toMidi","L2","log","L440","freqToMidi","round","SHARPS","FLATS","midiToNoteName","Infinity","sharps","pitchClass","pcsetFromMidi","pcset2","val","pcsetSteps","index_default","midiToFreq","tuning","pcsetNearest","ch","pcsetDegrees","NAMES","toName","onlyNotes","array","fromMidi","midi2","_tr","transposeBy","transposeFrom","ascending","sortedNames","comparator","sortedUniqNames","destName","dest","srcChroma","destChroma","destOctOffset","destOct","accidentals","octave","descending","_dist","fromMidiSharps","fromFreq","freq2","fromFreqSharps","trBy","trFrom","transposeOctaves","trFifths","NoRomanNumeral","roman","upperRoman","major","fromPitch","romanNumeral","ROMANS","NAMES_MINOR","roman_numeral_default","Empty","NoKey","alteration","keySignature","NoKeyScale","grades","chords","chordsHarmonicFunction","secondaryDominants","secondaryDominantSupertonics","substituteDominantsMinorRelative","substituteDominants","substituteDominantSupertonics","secondaryDominantsMinorRelative","NoMajorKey","minorRelative","NoMinorKey","relativeMajor","natural","harmonic","melodic","mapScaleToType","list","sep","keyScale","harmonicFunctions","gr","supertonics","domRoot","dominants","targetTriads","minorRoot","endsWith","distInFifths","MajorScale","NaturalScale","HarmonicScale","MelodicScale","majorKey","keyScale2","minorKey","tnc","majorTonicFromKeySignature","sig","MODES","NoMode","modeNum","triad","seventh","mode2","getType","chords2","modeName","triads2","tonics","destination","mode_default","relativeTonic","seventhChords","tokenizeBass","progression_default","fromRomanNumerals","rn","toRomanNumerals","numeric","result","last","NoScale","st","getScaleType","scale2","scaleNotes","scaleName","_options$tonic","notesChroma","pitchClasses","scaleChroma","results","modeNames","scaleTypeNames","rangeOf","getName","noteOrMidi","currNote","position","getNoteNameOf","nums","scaleChords","inScale","NONE","upper","lower","additive","CACHE","literal","up2","low","up","down","time_signature_default","stringifiedLiteral","ts","isPowerOfTwo","build","Tonal","Core","PcSet","Pcset","ChordDictionary","ChordType","ScaleDictionary","ScaleType","voicingsInRange_1","chordSymbol","voicingsInRange","rest","__rest","__assign"],"sourceRoot":""}